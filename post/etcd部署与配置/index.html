<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>etcd部署与配置 | Forz Blog</title>
<meta name="keywords" content="" />
<meta name="description" content="集群配置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66">
<meta name="author" content="">
<link rel="canonical" href="/post/etcd%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="etcd部署与配置" />
<meta property="og:description" content="集群配置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/etcd%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-06-17T14:09:04&#43;00:00" />
<meta property="article:modified_time" content="2019-06-17T14:09:04&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="etcd部署与配置"/>
<meta name="twitter:description" content="集群配置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "etcd部署与配置",
      "item": "/post/etcd%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "etcd部署与配置",
  "name": "etcd部署与配置",
  "description": "集群配置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66",
  "keywords": [
    
  ],
  "articleBody": "集群配置 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156  # name 节点名称 # data-dir 指定节点的数据存储目录 # listen-peer-urls 监听URL，用于与其他节点通讯 # listen-client-urls 对外提供服务的地址：比如 http://ip:2379,http://127.0.0.1:2379 ，客户端会连接到这里和 etcd 交互 # initial-advertise-peer-urls 该节点member(同伴)监听地址，这个值会告诉集群中其他节点 # initial-cluster 集群中所有节点的信息，格式为 node1=http://ip1:2380,node2=http://ip2:2380,… 。注意：这里的 node1 是节点的 --name 指定的名字；后面的 ip1:2380 是 --initial-advertise-peer-urls 指定的值 # initial-cluster-state 新建集群的时候，这个值为 new ；假如已经存在的集群，这个值为 existing # initial-cluster-token 创建集群的 token，这个值每个集群保持唯一。这样的话，如果你要重新创建集群，即使配置和之前一样，也会再次生成新的集群和节点 uuid；否则会导致多个集群之间的冲突，造成未知的错误 # advertise-client-urls 对外公告的该节点客户端监听地址，这个值会告诉集群中其他节点 # This is the configuration file for the etcd server. # Human-readable name for this member. name: 'etcd-0-231' # Path to the data directory. data-dir: /data/etcd/ # Path to the dedicated wal directory. wal-dir: # Number of committed transactions to trigger a snapshot to disk. snapshot-count: 10000 # Time (in milliseconds) of a heartbeat interval. heartbeat-interval: 100 # Time (in milliseconds) for an election to timeout. election-timeout: 1000 # Raise alarms when backend size exceeds the given quota. 0 means use the # default quota. quota-backend-bytes: 0 # List of comma separated URLs to listen on for peer traffic. listen-peer-urls: http://1.1.1.1:12380  # List of comma separated URLs to listen on for client traffic. listen-client-urls: http://1.1.1.1:12379,http://127.0.0.1:12379  # Maximum number of snapshot files to retain (0 is unlimited). max-snapshots: 5 # Maximum number of wal files to retain (0 is unlimited). max-wals: 5 # Comma-separated white list of origins for CORS (cross-origin resource sharing). cors: # List of this member's peer URLs to advertise to the rest of the cluster. # The URLs needed to be a comma-separated list. initial-advertise-peer-urls: http://1.1.1.1:12380  # List of this member's client URLs to advertise to the public. # The URLs needed to be a comma-separated list. advertise-client-urls: http://1.1.1.1:12379  # Discovery URL used to bootstrap the cluster. discovery: # Valid values include 'exit', 'proxy' discovery-fallback: 'proxy' # HTTP proxy to use for traffic to discovery service. discovery-proxy: # DNS domain used to bootstrap initial cluster. discovery-srv: # Initial cluster configuration for bootstrapping. initial-cluster: etcd-2-2=http://2.2.2.2:12380,etcd-3-3=http://3.3.3.3:12380,etcd-1-1=http://1.1.1.1:12380  # Initial cluster token for the etcd cluster during bootstrap. initial-cluster-token: 'etcd-cluster' # Initial cluster state ('new' or 'existing'). initial-cluster-state: 'new' # Reject reconfiguration requests that would cause quorum loss. strict-reconfig-check: false # Accept etcd V2 client requests enable-v2: true # Enable runtime profiling data via HTTP server enable-pprof: true # Valid values include 'on', 'readonly', 'off' proxy: 'off' # Time (in milliseconds) an endpoint will be held in a failed state. proxy-failure-wait: 5000 # Time (in milliseconds) of the endpoints refresh interval. proxy-refresh-interval: 30000 # Time (in milliseconds) for a dial to timeout. proxy-dial-timeout: 1000 # Time (in milliseconds) for a write to timeout. proxy-write-timeout: 5000 # Time (in milliseconds) for a read to timeout. proxy-read-timeout: 0 client-transport-security: # DEPRECATED: Path to the client server TLS CA file. ca-file: # Path to the client server TLS cert file. cert-file: # Path to the client server TLS key file. key-file: # Enable client cert authentication. client-cert-auth: false # Path to the client server TLS trusted CA cert file. trusted-ca-file: # Client TLS using generated certificates auto-tls: false peer-transport-security: # DEPRECATED: Path to the peer server TLS CA file. ca-file: # Path to the peer server TLS cert file. cert-file: # Path to the peer server TLS key file. key-file: # Enable peer client cert authentication. peer-client-cert-auth: false # Path to the peer server TLS trusted CA cert file. trusted-ca-file: # Peer TLS using generated certificates. auto-tls: false # Enable debug-level logging for etcd. debug: false # Specify a particular log level for each etcd package (eg: 'etcdmain=CRITICAL,etcdserver=DEBUG'. log-package-levels: # Specify 'stdout' or 'stderr' to skip journald logging even when running under systemd. log-output: default # Force to create a new one member cluster. force-new-cluster: false   启动 1  ./etcd --config-file etcd.conf   ",
  "wordCount" : "1039",
  "inLanguage": "zh-cn",
  "datePublished": "2019-06-17T14:09:04Z",
  "dateModified": "2019-06-17T14:09:04Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/etcd%E9%83%A8%E7%BD%B2%E4%B8%8E%E9%85%8D%E7%BD%AE/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      etcd部署与配置
    </h1>
    <div class="post-meta">June 17, 2019
</div>
  </header> 
  <div class="post-content"><h1 id="集群配置">集群配置<a hidden class="anchor" aria-hidden="true" href="#集群配置">#</a></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="err">#</span> <span class="nx">name</span>      <span class="nx">节点名称</span>
<span class="err">#</span> <span class="nx">data</span><span class="o">-</span><span class="nx">dir</span>      <span class="nx">指定节点的数据存储目录</span>
<span class="err">#</span> <span class="nx">listen</span><span class="o">-</span><span class="nx">peer</span><span class="o">-</span><span class="nx">urls</span>      <span class="nx">监听URL</span><span class="err">，</span><span class="nx">用于与其他节点通讯</span>
<span class="err">#</span> <span class="nx">listen</span><span class="o">-</span><span class="nx">client</span><span class="o">-</span><span class="nx">urls</span>      <span class="nx">对外提供服务的地址</span><span class="err">：</span><span class="nx">比如</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//ip:2379,http://127.0.0.1:2379 ，客户端会连接到这里和 etcd 交互
</span><span class="c1"></span><span class="err">#</span> <span class="nx">initial</span><span class="o">-</span><span class="nx">advertise</span><span class="o">-</span><span class="nx">peer</span><span class="o">-</span><span class="nx">urls</span>      <span class="nx">该节点member</span><span class="p">(</span><span class="nx">同伴</span><span class="p">)</span><span class="nx">监听地址</span><span class="err">，</span><span class="nx">这个值会告诉集群中其他节点</span>
<span class="err">#</span> <span class="nx">initial</span><span class="o">-</span><span class="nx">cluster</span>      <span class="nx">集群中所有节点的信息</span><span class="err">，</span><span class="nx">格式为</span> <span class="nx">node1</span><span class="p">=</span><span class="nx">http</span><span class="p">:</span><span class="c1">//ip1:2380,node2=http://ip2:2380,… 。注意：这里的 node1 是节点的 --name 指定的名字；后面的 ip1:2380 是 --initial-advertise-peer-urls 指定的值
</span><span class="c1"></span><span class="err">#</span> <span class="nx">initial</span><span class="o">-</span><span class="nx">cluster</span><span class="o">-</span><span class="nx">state</span>      <span class="nx">新建集群的时候</span><span class="err">，</span><span class="nx">这个值为</span> <span class="nx">new</span> <span class="err">；</span><span class="nx">假如已经存在的集群</span><span class="err">，</span><span class="nx">这个值为</span> <span class="nx">existing</span>
<span class="err">#</span> <span class="nx">initial</span><span class="o">-</span><span class="nx">cluster</span><span class="o">-</span><span class="nx">token</span>      <span class="nx">创建集群的</span> <span class="nx">token</span><span class="err">，</span><span class="nx">这个值每个集群保持唯一</span><span class="err">。</span><span class="nx">这样的话</span><span class="err">，</span><span class="nx">如果你要重新创建集群</span><span class="err">，</span><span class="nx">即使配置和之前一样</span><span class="err">，</span><span class="nx">也会再次生成新的集群和节点</span> <span class="nx">uuid</span><span class="err">；</span><span class="nx">否则会导致多个集群之间的冲突</span><span class="err">，</span><span class="nx">造成未知的错误</span>
<span class="err">#</span> <span class="nx">advertise</span><span class="o">-</span><span class="nx">client</span><span class="o">-</span><span class="nx">urls</span>      <span class="nx">对外公告的该节点客户端监听地址</span><span class="err">，</span><span class="nx">这个值会告诉集群中其他节点</span>


<span class="err">#</span> <span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">configuration</span> <span class="nx">file</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">etcd</span> <span class="nx">server</span><span class="p">.</span>

<span class="err">#</span> <span class="nx">Human</span><span class="o">-</span><span class="nx">readable</span> <span class="nx">name</span> <span class="k">for</span> <span class="nx">this</span> <span class="nx">member</span><span class="p">.</span>
<span class="nx">name</span><span class="p">:</span> <span class="err">&#39;</span><span class="nx">etcd</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">231</span><span class="err">&#39;</span>

<span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">directory</span><span class="p">.</span>
<span class="nx">data</span><span class="o">-</span><span class="nx">dir</span><span class="p">:</span> <span class="o">/</span><span class="nx">data</span><span class="o">/</span><span class="nx">etcd</span><span class="o">/</span>

<span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">dedicated</span> <span class="nx">wal</span> <span class="nx">directory</span><span class="p">.</span>
<span class="nx">wal</span><span class="o">-</span><span class="nx">dir</span><span class="p">:</span>

<span class="err">#</span> <span class="nx">Number</span> <span class="nx">of</span> <span class="nx">committed</span> <span class="nx">transactions</span> <span class="nx">to</span> <span class="nx">trigger</span> <span class="nx">a</span> <span class="nx">snapshot</span> <span class="nx">to</span> <span class="nx">disk</span><span class="p">.</span>
<span class="nx">snapshot</span><span class="o">-</span><span class="nx">count</span><span class="p">:</span> <span class="mi">10000</span>

<span class="err">#</span> <span class="nf">Time</span> <span class="p">(</span><span class="nx">in</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="nx">of</span> <span class="nx">a</span> <span class="nx">heartbeat</span> <span class="nx">interval</span><span class="p">.</span>
<span class="nx">heartbeat</span><span class="o">-</span><span class="nx">interval</span><span class="p">:</span> <span class="mi">100</span>

<span class="err">#</span> <span class="nf">Time</span> <span class="p">(</span><span class="nx">in</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="k">for</span> <span class="nx">an</span> <span class="nx">election</span> <span class="nx">to</span> <span class="nx">timeout</span><span class="p">.</span>
<span class="nx">election</span><span class="o">-</span><span class="nx">timeout</span><span class="p">:</span> <span class="mi">1000</span>

<span class="err">#</span> <span class="nx">Raise</span> <span class="nx">alarms</span> <span class="nx">when</span> <span class="nx">backend</span> <span class="nx">size</span> <span class="nx">exceeds</span> <span class="nx">the</span> <span class="nx">given</span> <span class="nx">quota</span><span class="p">.</span> <span class="mi">0</span> <span class="nx">means</span> <span class="nx">use</span> <span class="nx">the</span>
<span class="err">#</span> <span class="k">default</span> <span class="nx">quota</span><span class="p">.</span>
<span class="nx">quota</span><span class="o">-</span><span class="nx">backend</span><span class="o">-</span><span class="nx">bytes</span><span class="p">:</span> <span class="mi">0</span>

<span class="err">#</span> <span class="nx">List</span> <span class="nx">of</span> <span class="nx">comma</span> <span class="nx">separated</span> <span class="nx">URLs</span> <span class="nx">to</span> <span class="nx">listen</span> <span class="nx">on</span> <span class="k">for</span> <span class="nx">peer</span> <span class="nx">traffic</span><span class="p">.</span>
<span class="nx">listen</span><span class="o">-</span><span class="nx">peer</span><span class="o">-</span><span class="nx">urls</span><span class="p">:</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//1.1.1.1:12380
</span><span class="c1"></span>
<span class="err">#</span> <span class="nx">List</span> <span class="nx">of</span> <span class="nx">comma</span> <span class="nx">separated</span> <span class="nx">URLs</span> <span class="nx">to</span> <span class="nx">listen</span> <span class="nx">on</span> <span class="k">for</span> <span class="nx">client</span> <span class="nx">traffic</span><span class="p">.</span>
<span class="nx">listen</span><span class="o">-</span><span class="nx">client</span><span class="o">-</span><span class="nx">urls</span><span class="p">:</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//1.1.1.1:12379,http://127.0.0.1:12379
</span><span class="c1"></span>
<span class="err">#</span> <span class="nx">Maximum</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">snapshot</span> <span class="nx">files</span> <span class="nx">to</span> <span class="nf">retain</span> <span class="p">(</span><span class="mi">0</span> <span class="nx">is</span> <span class="nx">unlimited</span><span class="p">).</span>
<span class="nx">max</span><span class="o">-</span><span class="nx">snapshots</span><span class="p">:</span> <span class="mi">5</span>

<span class="err">#</span> <span class="nx">Maximum</span> <span class="nx">number</span> <span class="nx">of</span> <span class="nx">wal</span> <span class="nx">files</span> <span class="nx">to</span> <span class="nf">retain</span> <span class="p">(</span><span class="mi">0</span> <span class="nx">is</span> <span class="nx">unlimited</span><span class="p">).</span>
<span class="nx">max</span><span class="o">-</span><span class="nx">wals</span><span class="p">:</span> <span class="mi">5</span>

<span class="err">#</span> <span class="nx">Comma</span><span class="o">-</span><span class="nx">separated</span> <span class="nx">white</span> <span class="nx">list</span> <span class="nx">of</span> <span class="nx">origins</span> <span class="k">for</span> <span class="nf">CORS</span> <span class="p">(</span><span class="nx">cross</span><span class="o">-</span><span class="nx">origin</span> <span class="nx">resource</span> <span class="nx">sharing</span><span class="p">).</span>
<span class="nx">cors</span><span class="p">:</span>

<span class="err">#</span> <span class="nx">List</span> <span class="nx">of</span> <span class="nx">this</span> <span class="nx">member</span><span class="err">&#39;</span><span class="nx">s</span> <span class="nx">peer</span> <span class="nx">URLs</span> <span class="nx">to</span> <span class="nx">advertise</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">rest</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">cluster</span><span class="p">.</span>
<span class="err">#</span> <span class="nx">The</span> <span class="nx">URLs</span> <span class="nx">needed</span> <span class="nx">to</span> <span class="nx">be</span> <span class="nx">a</span> <span class="nx">comma</span><span class="o">-</span><span class="nx">separated</span> <span class="nx">list</span><span class="p">.</span>
<span class="nx">initial</span><span class="o">-</span><span class="nx">advertise</span><span class="o">-</span><span class="nx">peer</span><span class="o">-</span><span class="nx">urls</span><span class="p">:</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//1.1.1.1:12380
</span><span class="c1"></span>
<span class="err">#</span> <span class="nx">List</span> <span class="nx">of</span> <span class="nx">this</span> <span class="nx">member</span><span class="err">&#39;</span><span class="nx">s</span> <span class="nx">client</span> <span class="nx">URLs</span> <span class="nx">to</span> <span class="nx">advertise</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">public</span><span class="p">.</span>
<span class="err">#</span> <span class="nx">The</span> <span class="nx">URLs</span> <span class="nx">needed</span> <span class="nx">to</span> <span class="nx">be</span> <span class="nx">a</span> <span class="nx">comma</span><span class="o">-</span><span class="nx">separated</span> <span class="nx">list</span><span class="p">.</span>
<span class="nx">advertise</span><span class="o">-</span><span class="nx">client</span><span class="o">-</span><span class="nx">urls</span><span class="p">:</span> <span class="nx">http</span><span class="p">:</span><span class="c1">//1.1.1.1:12379
</span><span class="c1"></span>
<span class="err">#</span> <span class="nx">Discovery</span> <span class="nx">URL</span> <span class="nx">used</span> <span class="nx">to</span> <span class="nx">bootstrap</span> <span class="nx">the</span> <span class="nx">cluster</span><span class="p">.</span>
<span class="nx">discovery</span><span class="p">:</span>

<span class="err">#</span> <span class="nx">Valid</span> <span class="nx">values</span> <span class="nx">include</span> <span class="err">&#39;</span><span class="nx">exit</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="nx">proxy</span><span class="err">&#39;</span>
<span class="nx">discovery</span><span class="o">-</span><span class="nx">fallback</span><span class="p">:</span> <span class="err">&#39;</span><span class="nx">proxy</span><span class="err">&#39;</span>

<span class="err">#</span> <span class="nx">HTTP</span> <span class="nx">proxy</span> <span class="nx">to</span> <span class="nx">use</span> <span class="k">for</span> <span class="nx">traffic</span> <span class="nx">to</span> <span class="nx">discovery</span> <span class="nx">service</span><span class="p">.</span>
<span class="nx">discovery</span><span class="o">-</span><span class="nx">proxy</span><span class="p">:</span>

<span class="err">#</span> <span class="nx">DNS</span> <span class="nx">domain</span> <span class="nx">used</span> <span class="nx">to</span> <span class="nx">bootstrap</span> <span class="nx">initial</span> <span class="nx">cluster</span><span class="p">.</span>
<span class="nx">discovery</span><span class="o">-</span><span class="nx">srv</span><span class="p">:</span>

<span class="err">#</span> <span class="nx">Initial</span> <span class="nx">cluster</span> <span class="nx">configuration</span> <span class="k">for</span> <span class="nx">bootstrapping</span><span class="p">.</span>
<span class="nx">initial</span><span class="o">-</span><span class="nx">cluster</span><span class="p">:</span> <span class="nx">etcd</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">=</span><span class="nx">http</span><span class="p">:</span><span class="c1">//2.2.2.2:12380,etcd-3-3=http://3.3.3.3:12380,etcd-1-1=http://1.1.1.1:12380
</span><span class="c1"></span>
<span class="err">#</span> <span class="nx">Initial</span> <span class="nx">cluster</span> <span class="nx">token</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">etcd</span> <span class="nx">cluster</span> <span class="nx">during</span> <span class="nx">bootstrap</span><span class="p">.</span>
<span class="nx">initial</span><span class="o">-</span><span class="nx">cluster</span><span class="o">-</span><span class="nx">token</span><span class="p">:</span> <span class="err">&#39;</span><span class="nx">etcd</span><span class="o">-</span><span class="nx">cluster</span><span class="err">&#39;</span>

<span class="err">#</span> <span class="nx">Initial</span> <span class="nx">cluster</span> <span class="nf">state</span> <span class="p">(</span><span class="err">&#39;</span><span class="nx">new</span><span class="err">&#39;</span> <span class="nx">or</span> <span class="err">&#39;</span><span class="nx">existing</span><span class="err">&#39;</span><span class="p">).</span>
<span class="nx">initial</span><span class="o">-</span><span class="nx">cluster</span><span class="o">-</span><span class="nx">state</span><span class="p">:</span> <span class="err">&#39;</span><span class="nx">new</span><span class="err">&#39;</span>

<span class="err">#</span> <span class="nx">Reject</span> <span class="nx">reconfiguration</span> <span class="nx">requests</span> <span class="nx">that</span> <span class="nx">would</span> <span class="nx">cause</span> <span class="nx">quorum</span> <span class="nx">loss</span><span class="p">.</span>
<span class="nx">strict</span><span class="o">-</span><span class="nx">reconfig</span><span class="o">-</span><span class="nx">check</span><span class="p">:</span> <span class="kc">false</span>

<span class="err">#</span> <span class="nx">Accept</span> <span class="nx">etcd</span> <span class="nx">V2</span> <span class="nx">client</span> <span class="nx">requests</span>
<span class="nx">enable</span><span class="o">-</span><span class="nx">v2</span><span class="p">:</span> <span class="kc">true</span>

<span class="err">#</span> <span class="nx">Enable</span> <span class="nx">runtime</span> <span class="nx">profiling</span> <span class="nx">data</span> <span class="nx">via</span> <span class="nx">HTTP</span> <span class="nx">server</span>
<span class="nx">enable</span><span class="o">-</span><span class="nx">pprof</span><span class="p">:</span> <span class="kc">true</span>

<span class="err">#</span> <span class="nx">Valid</span> <span class="nx">values</span> <span class="nx">include</span> <span class="err">&#39;</span><span class="nx">on</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="nx">readonly</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="nx">off</span><span class="err">&#39;</span>
<span class="nx">proxy</span><span class="p">:</span> <span class="err">&#39;</span><span class="nx">off</span><span class="err">&#39;</span>

<span class="err">#</span> <span class="nf">Time</span> <span class="p">(</span><span class="nx">in</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="nx">an</span> <span class="nx">endpoint</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">held</span> <span class="nx">in</span> <span class="nx">a</span> <span class="nx">failed</span> <span class="nx">state</span><span class="p">.</span>
<span class="nx">proxy</span><span class="o">-</span><span class="nx">failure</span><span class="o">-</span><span class="nx">wait</span><span class="p">:</span> <span class="mi">5000</span>

<span class="err">#</span> <span class="nf">Time</span> <span class="p">(</span><span class="nx">in</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">endpoints</span> <span class="nx">refresh</span> <span class="nx">interval</span><span class="p">.</span>
<span class="nx">proxy</span><span class="o">-</span><span class="nx">refresh</span><span class="o">-</span><span class="nx">interval</span><span class="p">:</span> <span class="mi">30000</span>

<span class="err">#</span> <span class="nf">Time</span> <span class="p">(</span><span class="nx">in</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="k">for</span> <span class="nx">a</span> <span class="nx">dial</span> <span class="nx">to</span> <span class="nx">timeout</span><span class="p">.</span>
<span class="nx">proxy</span><span class="o">-</span><span class="nx">dial</span><span class="o">-</span><span class="nx">timeout</span><span class="p">:</span> <span class="mi">1000</span>

<span class="err">#</span> <span class="nf">Time</span> <span class="p">(</span><span class="nx">in</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="k">for</span> <span class="nx">a</span> <span class="nx">write</span> <span class="nx">to</span> <span class="nx">timeout</span><span class="p">.</span>
<span class="nx">proxy</span><span class="o">-</span><span class="nx">write</span><span class="o">-</span><span class="nx">timeout</span><span class="p">:</span> <span class="mi">5000</span>

<span class="err">#</span> <span class="nf">Time</span> <span class="p">(</span><span class="nx">in</span> <span class="nx">milliseconds</span><span class="p">)</span> <span class="k">for</span> <span class="nx">a</span> <span class="nx">read</span> <span class="nx">to</span> <span class="nx">timeout</span><span class="p">.</span>
<span class="nx">proxy</span><span class="o">-</span><span class="nx">read</span><span class="o">-</span><span class="nx">timeout</span><span class="p">:</span> <span class="mi">0</span>

<span class="nx">client</span><span class="o">-</span><span class="nx">transport</span><span class="o">-</span><span class="nx">security</span><span class="p">:</span>
  <span class="err">#</span> <span class="nx">DEPRECATED</span><span class="p">:</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">client</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">CA</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">ca</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">client</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">cert</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">cert</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">client</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">key</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">key</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Enable</span> <span class="nx">client</span> <span class="nx">cert</span> <span class="nx">authentication</span><span class="p">.</span>
  <span class="nx">client</span><span class="o">-</span><span class="nx">cert</span><span class="o">-</span><span class="nx">auth</span><span class="p">:</span> <span class="kc">false</span>

  <span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">client</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">trusted</span> <span class="nx">CA</span> <span class="nx">cert</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">trusted</span><span class="o">-</span><span class="nx">ca</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Client</span> <span class="nx">TLS</span> <span class="nx">using</span> <span class="nx">generated</span> <span class="nx">certificates</span>
  <span class="nx">auto</span><span class="o">-</span><span class="nx">tls</span><span class="p">:</span> <span class="kc">false</span>

<span class="nx">peer</span><span class="o">-</span><span class="nx">transport</span><span class="o">-</span><span class="nx">security</span><span class="p">:</span>
  <span class="err">#</span> <span class="nx">DEPRECATED</span><span class="p">:</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">peer</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">CA</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">ca</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">peer</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">cert</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">cert</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">peer</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">key</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">key</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Enable</span> <span class="nx">peer</span> <span class="nx">client</span> <span class="nx">cert</span> <span class="nx">authentication</span><span class="p">.</span>
  <span class="nx">peer</span><span class="o">-</span><span class="nx">client</span><span class="o">-</span><span class="nx">cert</span><span class="o">-</span><span class="nx">auth</span><span class="p">:</span> <span class="kc">false</span>

  <span class="err">#</span> <span class="nx">Path</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">peer</span> <span class="nx">server</span> <span class="nx">TLS</span> <span class="nx">trusted</span> <span class="nx">CA</span> <span class="nx">cert</span> <span class="nx">file</span><span class="p">.</span>
  <span class="nx">trusted</span><span class="o">-</span><span class="nx">ca</span><span class="o">-</span><span class="nx">file</span><span class="p">:</span>

  <span class="err">#</span> <span class="nx">Peer</span> <span class="nx">TLS</span> <span class="nx">using</span> <span class="nx">generated</span> <span class="nx">certificates</span><span class="p">.</span>
  <span class="nx">auto</span><span class="o">-</span><span class="nx">tls</span><span class="p">:</span> <span class="kc">false</span>

<span class="err">#</span> <span class="nx">Enable</span> <span class="nx">debug</span><span class="o">-</span><span class="nx">level</span> <span class="nx">logging</span> <span class="k">for</span> <span class="nx">etcd</span><span class="p">.</span>
<span class="nx">debug</span><span class="p">:</span> <span class="kc">false</span>

<span class="err">#</span> <span class="nx">Specify</span> <span class="nx">a</span> <span class="nx">particular</span> <span class="nx">log</span> <span class="nx">level</span> <span class="k">for</span> <span class="nx">each</span> <span class="nx">etcd</span> <span class="kn">package</span> <span class="p">(</span><span class="nx">eg</span><span class="p">:</span> <span class="err">&#39;</span><span class="nx">etcdmain</span><span class="p">=</span><span class="nx">CRITICAL</span><span class="p">,</span><span class="nx">etcdserver</span><span class="p">=</span><span class="nx">DEBUG</span><span class="err">&#39;</span><span class="p">.</span>
<span class="nx">log</span><span class="o">-</span><span class="kn">package</span><span class="o">-</span><span class="nx">levels</span><span class="p">:</span>

<span class="err">#</span> <span class="nx">Specify</span> <span class="err">&#39;</span><span class="nx">stdout</span><span class="err">&#39;</span> <span class="nx">or</span> <span class="err">&#39;</span><span class="nx">stderr</span><span class="err">&#39;</span> <span class="nx">to</span> <span class="nx">skip</span> <span class="nx">journald</span> <span class="nx">logging</span> <span class="nx">even</span> <span class="nx">when</span> <span class="nx">running</span> <span class="nx">under</span> <span class="nx">systemd</span><span class="p">.</span>
<span class="nx">log</span><span class="o">-</span><span class="nx">output</span><span class="p">:</span> <span class="k">default</span>

<span class="err">#</span> <span class="nx">Force</span> <span class="nx">to</span> <span class="nx">create</span> <span class="nx">a</span> <span class="nx">new</span> <span class="nx">one</span> <span class="nx">member</span> <span class="nx">cluster</span><span class="p">.</span>
<span class="nx">force</span><span class="o">-</span><span class="nx">new</span><span class="o">-</span><span class="nx">cluster</span><span class="p">:</span> <span class="kc">false</span>

</code></pre></td></tr></table>
</div>
</div><h1 id="启动">启动<a hidden class="anchor" aria-hidden="true" href="#启动">#</a></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">./etcd --config-file etcd.conf
</code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
