<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>随时找到数据流的中位数 | Forz Blog</title>
<meta name="keywords" content="eap" />
<meta name="description" content="LeetCode 295. Find Median from Data Stream Median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value. So the median is the mean of the two middle value. Examples: [2,3,4] , the median is 3 [2,3], the median is (2 &#43; 3) / 2 = 2.5 Design a data structure that supports the following two operations: void">
<meta name="author" content="">
<link rel="canonical" href="/post/%E9%9A%8F%E6%97%B6%E6%89%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="随时找到数据流的中位数" />
<meta property="og:description" content="LeetCode 295. Find Median from Data Stream Median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value. So the median is the mean of the two middle value. Examples: [2,3,4] , the median is 3 [2,3], the median is (2 &#43; 3) / 2 = 2.5 Design a data structure that supports the following two operations: void" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/%E9%9A%8F%E6%97%B6%E6%89%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2017-06-24T16:12:04&#43;00:00" />
<meta property="article:modified_time" content="2017-06-24T16:12:04&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="随时找到数据流的中位数"/>
<meta name="twitter:description" content="LeetCode 295. Find Median from Data Stream Median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value. So the median is the mean of the two middle value. Examples: [2,3,4] , the median is 3 [2,3], the median is (2 &#43; 3) / 2 = 2.5 Design a data structure that supports the following two operations: void"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "随时找到数据流的中位数",
      "item": "/post/%E9%9A%8F%E6%97%B6%E6%89%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "随时找到数据流的中位数",
  "name": "随时找到数据流的中位数",
  "description": "LeetCode 295. Find Median from Data Stream Median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value. So the median is the mean of the two middle value. Examples: [2,3,4] , the median is 3 [2,3], the median is (2 + 3) / 2 = 2.5 Design a data structure that supports the following two operations: void",
  "keywords": [
    "eap"
  ],
  "articleBody": "LeetCode 295. Find Median from Data Stream Median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value. So the median is the mean of the two middle value.\nExamples:\n[2,3,4] , the median is 3\n[2,3], the median is (2 + 3) / 2 = 2.5\nDesign a data structure that supports the following two operations:\nvoid addNum(int num) - Add a integer number from the data stream to the data structure.\ndouble findMedian() - Return the median of all elements so far. For example:\naddNum(1) addNum(2) findMedian() - 1.5 addNum(3) findMedian() - 2  解析：\n中位数就是所有数值排序之后中间两个数的平均值（偶数）或中间一个数的值（奇数）。\n如果数据在容器中已经排序，整个容器被中位数分隔成了两部分。位于容器左边部分的数据比右边的数据小。\np1指向的是左边的最大数据，p2 指向的是右边部分最小的数。 那么中位数可以由p1和p2指向的数得到。\n如果能够保证数据容器左边的数据都小于右边的数据，这样即使左右两边内部的数据没有排序，也可以根据左边最大的数和右边最小的数得到中位数。\n最大推可以快速的从一个数据容器中找出最大数，最小堆可以快速的从一个数据容器中找出最小的数。 用一个最大堆实现左边的数据容器，用最小堆实现右边的数据容器。\n首先，要保证数据平均分配到两个堆中。还要保证最大堆中的数据都要小于最小堆中的数据。方法是：所有元素先暂时插入最大堆，再从最大堆拿出最大值放到最小堆，保证最大堆的所有元素比最小堆小，如果两个堆的数目不平衡，将小顶堆的最小值转移回大顶堆，保证最大堆的元素个数永远大于等于最小堆\n每个新元素先暂时放入大顶堆的过程不是真正的addNum，只是为了保证每次放入小顶堆的元素都是当前元素最大值。\n如果容器中数据的个数是奇数，那么p1和p2指向同一个数据。即最大堆的堆顶元素\n如果容器中数据的个数是偶数，那么中位数就是（p2+p1）*0.5。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  class MedianFinder { public: /** initialize your data structure here. */ priority_queueint lo; // 大顶堆（左面）  priority_queueint, vectorint, greaterint hi; // 小顶堆（右面）  MedianFinder() { } void addNum(int num) { lo.push(num); // 暂时放入大顶堆  hi.push(lo.top()); // 将大顶堆的最大值放到最小堆中  lo.pop() //最大堆弹出元素，保证最大堆元素个数不变  if (lo.size()  hi.size()) { //隔1次addNum执行1次，保证小顶堆的元素比大顶堆小  lo.push(hi.top()); hi.pop(); } } double findMedian() { return lo.size()  hi.size() ? (double) lo.top() : (lo.top() + hi.top()) * 0.5; } }; /** * Your MedianFinder object will be instantiated and called as such: * MedianFinder obj = new MedianFinder(); * obj.addNum(num); * double param_2 = obj.findMedian(); */   ",
  "wordCount" : "843",
  "inLanguage": "zh-cn",
  "datePublished": "2017-06-24T16:12:04Z",
  "dateModified": "2017-06-24T16:12:04Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/%E9%9A%8F%E6%97%B6%E6%89%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      随时找到数据流的中位数
    </h1>
    <div class="post-meta">June 24, 2017
</div>
  </header> 
  <div class="post-content"><h1 id="leetcode-295-find-median-from-data-stream">LeetCode 295. Find Median from Data Stream<a hidden class="anchor" aria-hidden="true" href="#leetcode-295-find-median-from-data-stream">#</a></h1>
<p>Median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value. So the median is the mean of the two middle value.</p>
<p>Examples:</p>
<p>[2,3,4] , the median is 3</p>
<p>[2,3], the median is (2 + 3) / 2 = 2.5</p>
<p>Design a data structure that supports the following two operations:</p>
<p>void addNum(int num) - Add a integer number from the data stream to the data structure.</p>
<p>double findMedian() - Return the median of all elements so far.
For example:</p>
<pre><code>addNum(1)
addNum(2)
findMedian() -&gt; 1.5
addNum(3) 
findMedian() -&gt; 2
</code></pre>
<p>解析：</p>
<p>中位数就是所有数值排序之后中间两个数的平均值（偶数）或中间一个数的值（奇数）。</p>
<p>如果数据在容器中已经排序，整个容器被中位数分隔成了两部分。位于容器左边部分的数据比右边的数据小。</p>
<p>p1指向的是左边的最大数据，p2 指向的是右边部分最小的数。 那么中位数可以由p1和p2指向的数得到。</p>
<p>如果能够保证数据容器左边的数据都小于右边的数据，这样即使左右两边内部的数据没有排序，也可以根据左边最大的数和右边最小的数得到中位数。</p>
<p>最大推可以快速的从一个数据容器中找出最大数，最小堆可以快速的从一个数据容器中找出最小的数。
用一个最大堆实现左边的数据容器，用最小堆实现右边的数据容器。</p>
<p>首先，要保证数据平均分配到两个堆中。还要保证最大堆中的数据都要小于最小堆中的数据。方法是：所有元素先暂时插入最大堆，再从最大堆拿出最大值放到最小堆，保证最大堆的所有元素比最小堆小，如果两个堆的数目不平衡，将小顶堆的最小值转移回大顶堆，保证最大堆的元素个数永远大于等于最小堆</p>
<p>每个新元素先暂时放入大顶堆的过程不是真正的addNum，只是为了保证每次放入小顶堆的元素都是当前元素最大值。</p>
<p>如果容器中数据的个数是奇数，那么p1和p2指向同一个数据。即最大堆的堆顶元素</p>
<p>如果容器中数据的个数是偶数，那么中位数就是（p2+p1）*0.5。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="n">class</span> <span class="n">MedianFinder</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
    <span class="cm">/** initialize your data structure here. */</span>
    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">lo</span><span class="p">;</span>                              <span class="c1">// 大顶堆（左面）
</span><span class="c1"></span>    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">hi</span><span class="p">;</span>   <span class="c1">// 小顶堆（右面）
</span><span class="c1"></span>    <span class="n">MedianFinder</span><span class="p">()</span> <span class="p">{</span>    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">addNum</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">lo</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>               <span class="c1">// 暂时放入大顶堆
</span><span class="c1"></span>        <span class="n">hi</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">lo</span><span class="p">.</span><span class="n">top</span><span class="p">());</span>          <span class="c1">// 将大顶堆的最大值放到最小堆中
</span><span class="c1"></span>        <span class="n">lo</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>                    <span class="c1">//最大堆弹出元素，保证最大堆元素个数不变
</span><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">lo</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">hi</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">//隔1次addNum执行1次，保证小顶堆的元素比大顶堆小
</span><span class="c1"></span>            <span class="n">lo</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">hi</span><span class="p">.</span><span class="n">top</span><span class="p">());</span>
            <span class="n">hi</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="n">findMedian</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lo</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">hi</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">?</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">lo</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">:</span> <span class="p">(</span><span class="n">lo</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="n">hi</span><span class="p">.</span><span class="n">top</span><span class="p">())</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="cm">/**
</span><span class="cm"> * Your MedianFinder object will be instantiated and called as such:
</span><span class="cm"> * MedianFinder obj = new MedianFinder();
</span><span class="cm"> * obj.addNum(num);
</span><span class="cm"> * double param_2 = obj.findMedian();
</span><span class="cm"> */</span>
</code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/eap/">eap</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
