<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>scanf()和sscanf()详解 | Forz Blog</title>
<meta name="keywords" content="" />
<meta name="description" content="函数原型 int sscanf( string str, string fmt, mixed var1, mixed var2 ... ); int scanf( const char *format [,argument]... ); 返回值 一般使用scanf函数时都是为某个变量赋值，不考虑它的返回值。但是任何函数都是需要返回的">
<meta name="author" content="">
<link rel="canonical" href="/post/scanf%E5%92%8Csscanf%E8%AF%A6%E8%A7%A3/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="scanf()和sscanf()详解" />
<meta property="og:description" content="函数原型 int sscanf( string str, string fmt, mixed var1, mixed var2 ... ); int scanf( const char *format [,argument]... ); 返回值 一般使用scanf函数时都是为某个变量赋值，不考虑它的返回值。但是任何函数都是需要返回的" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/scanf%E5%92%8Csscanf%E8%AF%A6%E8%A7%A3/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2017-07-23T17:08:51&#43;00:00" />
<meta property="article:modified_time" content="2017-07-23T17:08:51&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="scanf()和sscanf()详解"/>
<meta name="twitter:description" content="函数原型 int sscanf( string str, string fmt, mixed var1, mixed var2 ... ); int scanf( const char *format [,argument]... ); 返回值 一般使用scanf函数时都是为某个变量赋值，不考虑它的返回值。但是任何函数都是需要返回的"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "scanf()和sscanf()详解",
      "item": "/post/scanf%E5%92%8Csscanf%E8%AF%A6%E8%A7%A3/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "scanf()和sscanf()详解",
  "name": "scanf()和sscanf()详解",
  "description": "函数原型 int sscanf( string str, string fmt, mixed var1, mixed var2 ... ); int scanf( const char *format [,argument]... ); 返回值 一般使用scanf函数时都是为某个变量赋值，不考虑它的返回值。但是任何函数都是需要返回的",
  "keywords": [
    
  ],
  "articleBody": "函数原型 int sscanf( string str, string fmt, mixed var1, mixed var2 ... ); int scanf( const char *format [,argument]... );  返回值 一般使用scanf函数时都是为某个变量赋值，不考虑它的返回值。但是任何函数都是需要返回的（即使返回类型用void，也可以认为只是调用了return语句，只是并没有返回什么东西而已），同样的scanf函数也是有返回的，它的返回值是成功读取变量的个数。如果有一个输入与变量格式不匹配，那么返回值为0。如：\nscanf(\"%d %d\", \u0026num1, \u0026num2);  如果输入两个中间有空格隔开的数字（如2 3），那么它的返回值是2。如果输入一个浮点数一个整数，则返回值是1。如果输入一个字符一个整数，则返回值是0。\n在输入数据时，遇以下情况时认为该数据结束:\n 遇空格，或按“回车”或“跳格”（Tab）键； 按指定的宽度结束，如“％3d”，只取3列； 遇非法输入。  format格式解析 format可以是一个或多个\n {%[\\*] [width] [{h | l | I64 | L}]type | ' ' | '\\t' | '\\n' | 非%符号}，  注：{a|b|c}表示a,b,c中选一，[d],表示可以有d也可以没有d。\n  * 亦可用于格式中, (即 %*d 和 %*s) 加了星号 (*) 表示跳过此数据不读入. (也就是不把此数据读入参数中)\n1 2 3 4 5  const char sourceStr[] = \"hello, world\"; char buf[10] = {0}; sscanf(sourceStr, \"%*s%s\", buf); //%*s表示第一个匹配到的%s被过滤掉，即hello被过滤了 cout  buf endl; 结果为:world   ``\n  {a|b|c}表示a,b,c中选一，[d],表示可以有d也可以没有d。\n  width表示读取宽度。\n用法如下:\n1 2 3 4 5  const char sourceStr[] = \"hello, world\"; char buf[10] = {0}; sscanf(sourceStr, \"%5s\", buf); //%5s，只取5个字符 cout  buf endl; 结果为:hello   ``\n  {h | l | I64 | L}:参数的size,通常h表示单字节size，I表示2字节 size,L表示4字节size(double例外),l64表示8字节size。\n  type :这就很多了，就是%s,%d之类。\n  格式匹配 scanf函数的与后面的是必须严格匹配的。注意，是严格匹配，可以说不能有丝毫差别，但对于连续多个空格可以等同于一个空格。\n格式匹配使用贪婪算法，即匹配尽可能多的匹配字符。\n1 2 3 4 5 6  char str[10],int x; scanf(\"%s:%d\",str,\u0026amp;x); printf(%s %d,str,x); //输入 kryptosx:001 //你预计输出 kryptosx 001 //但事实上输出 kryptosx:001 4252772   这是因为%s在匹配时直接把”kryptosx:001“全匹配掉了，应为贪心要求尽可能的匹配。4252772是x未初始化的值，因为x并没有匹配到输入。\ntype类型 %c 一个单一的字符 %d 一个十进制整数 %i 一个整数 %e, %f, %g 一个浮点数 %o 一个八进制数 %s 一个字符串 %x 一个十六进制数 %p 一个指针 %n 一个等于读取字符数量的整数 %u 一个无符号整数 %[] 一个字符集 %% 一个精度符\n对于scanf函数的%c格式转换符，可以接受任何的非空白字符或空白字符（包括空格、回车、Tab甚至是F2这样的字符）。\n集合操作 [ ]是个集合的标志，%[ ]特指读入此集合所限定的那些字符，比如%[A-Z]是输入大写字母，一旦遇到不在此集合的字符便停止。如果集合的第一个字符是“^”，这说明读取不在\"^“后面集合的字符，既遇到”^“后面集合的字符便停止（这就是scanf函数里的正则表达式应用）。注意：此时读取的字符串是可以含有空格的。\n%[a-z] 表示匹配a到z中任意字符，贪婪性(尽可能多的匹配)\n%[aB'] 匹配a、B、‘中一员，贪婪性\n%[^a] 匹配非a的任意字符，贪婪性\n这和正则表达式很相似，而且仍然支持过滤，即可以有%*[a-z].如：\n1 2 3 4  const char* s = \"iios/12DDWDFF@122\"; char buf[20]; sscanf( s, \"%*[^/]/%[^@]\", buf ); printf( \"%s\\n\", buf );   先将 “iios/“过滤掉，再将非’@‘的一串内容送到buf中，cool.得到结果。\n怎样从sip:tom@172.18.1.133中取出tom?\n1 2 3  char * url=\"\"; char uri[10]={0}; sscanf(url,\"%*[^:]:%[^@]\",uri);   示例 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58  #include int main() { char buf[512] = {0}; //1. 常见用法。  sscanf(\"123456 asdf\", \"%s\", buf); printf(\"%s/n\", buf); printf(\"123456 Expect! %%s/n/n\"); //结果为：123456 //2. 取指定长度的字符串。如在下例中，取最大长度为4字节的字符串。  sscanf(\"123456 \", \"%4s\", buf); printf(\"%s/n\", buf); printf(\"1234 Expect! %%4s/n/n\"); //结果为：1234 //3. 取到指定字符为止的字符串。如在下例中，取遇到空格为止字符串。  sscanf(\"123456 abcdedf\", \"%[^ ]\", buf); printf(\"%s/n\", buf); printf(\"123456 Expect! %%[^ ]/n/n\"); //结果为：123456 //4. 取仅包含指定字符集的字符串。如在下例中，取仅包含1到9和小写字母的字符串。  sscanf(\"123456abcdedfBCDEFxyz\", \"%[1-9a-z]\", buf); printf(\"%s/n\", buf); printf(\"123456abcdedf Expect! %%[1-9a-z]/n/n\"); //结果为：123456abcdedf //5. 取到指定字符集为止的字符串。如在下例中，取遇到大写字母为止的字符串。  sscanf(\"123456 abcdedfBCDEFxyz\", \"%[^A-Z]\", buf); printf(\"%s/n\", buf); printf(\"123456 abcdedf Expect! %%[^A-Z]/n/n\"); //结果为：123456 abcdedf //6、给定一个字符串iios/12DDWDFF@122，获取 / 和 @ 之间的字符串，先将 \"iios/\"过滤掉，再将非'@'的一串内容送到buf中  sscanf(\"iios/12DDWDFF@122\", \"%*[^/]/%[^@]\", buf); printf(\"%s/n\", buf); printf(\"12DDWDFF Expect! %%*[^/]/%%[^@]/n/n\"); //结果为：12DDWDFF //7、给定一个字符串““hello, world”，仅保留world。（注意：“，”之后有一空格）  sscanf(\"hello, world\", \"%*s%s\", buf); printf(\"%s/n\", buf); printf(\"world Expect! %%*s%%s/n/n\"); //结果为：world //8、参数size的控制  unsigned char m[6] = {0}; int n = 0; // sscanf 返回输入了几个参数  n = sscanf(\"010203040506\", \"%hhx%hhx%hhx%hhx%hhx%hhx\", \u0026m[0], \u0026m[1], \u0026m[2], \u0026m[3], \u0026m[4], \u0026m[5]); printf(\"hhx: %d :%02x%02x%02x%02x%02x%02x/n\",n, m[0], m[1],m[2],m[3], m[4], m[5]); // 结果 n 为 1， 因为 hhx 把所有字符串作为一个数字，后面的都没有输入  n = sscanf(\"010203040506\", \"%2hhx%2hhx%2hhx%2hhx%2hhx%2hhx\", \u0026m[0], \u0026m[1], \u0026m[2], \u0026m[3], \u0026m[4], \u0026m[5]); printf(\"2hhx: %d :%02x%02x%02x%02x%02x%02x/n\",n, m[0], m[1],m[2],m[3], m[4], m[5]); // 结果 n 为 6， 加了2，之后限制每次hhx只匹配2个字符，所以每个都被输入  n = sscanf(\"010203040506\", \"%02x%02x%02x%02x%02x%02x\", \u0026m[0], \u0026m[1], \u0026m[2], \u0026m[3], \u0026m[4], \u0026m[5]); printf(\" 02x: %d :%02x%02x%02x%02x%02x%02x/n\",n, m[0], m[1],m[2],m[3], m[4], m[5]); // 0 是填充字符，2表示匹配2个字符，x表示一个十六进制数 // 注意：编译有warning，有时结果是正确的（跟具体的编译器、编译选项、编译环境有关），但x表示4个字节，大于被输入对象的大小 // 这会导致相邻的3个字节会被覆盖！！这会导致分配在相邻内存的变量被清0 //http://blog.csdn.net/rainharder/archive/2008/09/27/2989675.aspx里面有个覆盖的例子  return 0; }   ",
  "wordCount" : "2335",
  "inLanguage": "zh-cn",
  "datePublished": "2017-07-23T17:08:51Z",
  "dateModified": "2017-07-23T17:08:51Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/scanf%E5%92%8Csscanf%E8%AF%A6%E8%A7%A3/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      scanf()和sscanf()详解
    </h1>
    <div class="post-meta">July 23, 2017
</div>
  </header> 
  <div class="post-content"><h1 id="函数原型">函数原型<a hidden class="anchor" aria-hidden="true" href="#函数原型">#</a></h1>
<pre><code>int  sscanf( string str, string fmt, mixed var1, mixed var2 ... );
int  scanf( const char *format [,argument]... );
</code></pre>
<h1 id="返回值">返回值<a hidden class="anchor" aria-hidden="true" href="#返回值">#</a></h1>
<p>一般使用scanf函数时都是为某个变量赋值，不考虑它的返回值。但是任何函数都是需要返回的（即使返回类型用void，也可以认为只是调用了return语句，只是并没有返回什么东西而已），同样的scanf函数也是有返回的，它的返回值是成功读取变量的个数。如果有一个输入与变量格式不匹配，那么返回值为0。如：</p>
<pre><code>scanf(&quot;%d %d&quot;, &amp;num1, &amp;num2);  	
</code></pre>
<p>如果输入两个中间有空格隔开的数字（如2 3），那么它的返回值是2。如果输入一个浮点数一个整数，则返回值是1。如果输入一个字符一个整数，则返回值是0。</p>
<p>在输入数据时，遇以下情况时认为该数据结束:</p>
<ol>
<li>遇空格，或按“回车”或“跳格”（Tab）键；</li>
<li>按指定的宽度结束，如“％3d”，只取3列；</li>
<li>遇非法输入。</li>
</ol>
<h1 id="format格式解析">format格式解析<a hidden class="anchor" aria-hidden="true" href="#format格式解析">#</a></h1>
<p>format可以是一个或多个</p>
<pre><code>    {%[\*] [width] [{h | l | I64 | L}]type | ' ' | '\t' | '\n' | 非%符号}，
</code></pre>
<p>注：{a|b|c}表示a,b,c中选一，[d],表示可以有d也可以没有d。</p>
<ol>
<li>
<p>* 亦可用于格式中, (即 %*d 和 %*s) 加了星号 (*) 表示跳过此数据不读入. (也就是不把此数据读入参数中)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">const</span> <span class="kt">char</span> <span class="n">sourceStr</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;hello, world&#34;</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="n">sscanf</span><span class="p">(</span><span class="n">sourceStr</span><span class="p">,</span> <span class="s">&#34;%*s%s&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span> <span class="c1">//%*s表示第一个匹配到的%s被过滤掉，即hello被过滤了
</span><span class="c1"></span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">buf</span><span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="err">结果为</span><span class="o">:</span><span class="n">world</span>
</code></pre></td></tr></table>
</div>
</div><p>``</p>
</li>
<li>
<p>{a|b|c}表示a,b,c中选一，[d],表示可以有d也可以没有d。</p>
</li>
<li>
<p>width表示读取宽度。</p>
<p>用法如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">const</span> <span class="kt">char</span> <span class="n">sourceStr</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;hello, world&#34;</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="n">sscanf</span><span class="p">(</span><span class="n">sourceStr</span><span class="p">,</span> <span class="s">&#34;%5s&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span> <span class="c1">//%5s，只取5个字符
</span><span class="c1"></span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">buf</span><span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="err">结果为</span><span class="o">:</span><span class="n">hello</span>
</code></pre></td></tr></table>
</div>
</div><p>``</p>
</li>
<li>
<p>{h | l | I64 | L}:参数的size,通常h表示单字节size，I表示2字节 size,L表示4字节size(double例外),l64表示8字节size。</p>
</li>
<li>
<p>type :这就很多了，就是%s,%d之类。</p>
</li>
</ol>
<h1 id="格式匹配">格式匹配<a hidden class="anchor" aria-hidden="true" href="#格式匹配">#</a></h1>
<p>scanf函数的&lt;格式化字符串&gt;与后面的&lt;地址表&gt;是必须严格匹配的。注意，是严格匹配，可以说不能有丝毫差别，但对于连续多个空格可以等同于一个空格。</p>
<p>格式匹配使用贪婪算法，即匹配尽可能多的匹配字符。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s:%d&#34;</span><span class="p">,</span><span class="n">str</span><span class="p">,</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">x</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="o">%</span><span class="n">s</span> <span class="o">%</span><span class="n">d</span><span class="p">,</span><span class="n">str</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
<span class="c1">//输入 kryptosx:001
</span><span class="c1">//你预计输出 kryptosx 001
</span><span class="c1">//但事实上输出 kryptosx:001 4252772
</span></code></pre></td></tr></table>
</div>
</div><p>这是因为%s在匹配时直接把”kryptosx:001“全匹配掉了，应为贪心要求尽可能的匹配。4252772是x未初始化的值，因为x并没有匹配到输入。</p>
<h1 id="type类型">type类型<a hidden class="anchor" aria-hidden="true" href="#type类型">#</a></h1>
<p>%c  一个单一的字符  <br>
%d  一个十进制整数   <br>
%i  一个整数  <br>
%e, %f, %g 一个浮点数  <br>
%o  一个八进制数  <br>
%s  一个字符串  <br>
%x  一个十六进制数  <br>
%p  一个指针  <br>
%n  一个等于读取字符数量的整数  <br>
%u  一个无符号整数   <br>
%[]  一个字符集  <br>
%%  一个精度符</p>
<p>对于scanf函数的%c格式转换符，可以接受任何的非空白字符或空白字符（包括空格、回车、Tab甚至是F2这样的字符）。</p>
<h1 id="集合操作">集合操作<a hidden class="anchor" aria-hidden="true" href="#集合操作">#</a></h1>
<p>[ ]是个集合的标志，%[ ]特指读入此集合所限定的那些字符，比如%[A-Z]是输入大写字母，一旦遇到不在此集合的字符便停止。如果集合的第一个字符是“^”，这说明读取不在&quot;^&ldquo;后面集合的字符，既遇到&rdquo;^&ldquo;后面集合的字符便停止（这就是scanf函数里的正则表达式应用）。注意：此时读取的字符串是可以含有空格的。</p>
<p>%[a-z] 表示匹配a到z中任意字符，贪婪性(尽可能多的匹配)</p>
<p>%[aB'] 匹配a、B、&lsquo;中一员，贪婪性</p>
<p>%[^a] 匹配非a的任意字符，贪婪性</p>
<p>这和正则表达式很相似，而且仍然支持过滤，即可以有%*[a-z].如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&#34;iios/12DDWDFF@122&#34;</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
<span class="n">sscanf</span><span class="p">(</span> <span class="n">s</span><span class="p">,</span> <span class="s">&#34;%*[^/]/%[^@]&#34;</span><span class="p">,</span> <span class="n">buf</span> <span class="p">);</span>
<span class="n">printf</span><span class="p">(</span> <span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">buf</span> <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>先将 &ldquo;iios/&ldquo;过滤掉，再将非&rsquo;@&lsquo;的一串内容送到buf中，cool.得到结果。</p>
<p>怎样从<a href="sip:tom@172.18.1.133">sip:tom@172.18.1.133</a>中取出tom?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="kt">char</span> <span class="o">*</span> <span class="n">url</span><span class="o">=</span><span class="s">&#34;&lt;sip:tom@172.18.1.133&gt;&#34;</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">uri</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="n">sscanf</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="s">&#34;%*[^:]:%[^@]&#34;</span><span class="p">,</span><span class="n">uri</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="示例">示例<a hidden class="anchor" aria-hidden="true" href="#示例">#</a></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
 <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">512</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="c1">//1. 常见用法。
</span><span class="c1"></span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;123456 asdf&#34;</span><span class="p">,</span> <span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s/n&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;123456 Expect! %%s/n/n&#34;</span><span class="p">);</span>
<span class="c1">//结果为：123456
</span><span class="c1">//2. 取指定长度的字符串。如在下例中，取最大长度为4字节的字符串。
</span><span class="c1"></span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;123456 &#34;</span><span class="p">,</span> <span class="s">&#34;%4s&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s/n&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;1234 Expect! %%4s/n/n&#34;</span><span class="p">);</span>
<span class="c1">//结果为：1234
</span><span class="c1">//3. 取到指定字符为止的字符串。如在下例中，取遇到空格为止字符串。
</span><span class="c1"></span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;123456 abcdedf&#34;</span><span class="p">,</span> <span class="s">&#34;%[^ ]&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s/n&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;123456 Expect! %%[^ ]/n/n&#34;</span><span class="p">);</span>
<span class="c1">//结果为：123456
</span><span class="c1">//4.  取仅包含指定字符集的字符串。如在下例中，取仅包含1到9和小写字母的字符串。
</span><span class="c1"></span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;123456abcdedfBCDEFxyz&#34;</span><span class="p">,</span> <span class="s">&#34;%[1-9a-z]&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s/n&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;123456abcdedf Expect! %%[1-9a-z]/n/n&#34;</span><span class="p">);</span>
<span class="c1">//结果为：123456abcdedf
</span><span class="c1">//5.  取到指定字符集为止的字符串。如在下例中，取遇到大写字母为止的字符串。
</span><span class="c1"></span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;123456 abcdedfBCDEFxyz&#34;</span><span class="p">,</span> <span class="s">&#34;%[^A-Z]&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s/n&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;123456 abcdedf Expect! %%[^A-Z]/n/n&#34;</span><span class="p">);</span>
<span class="c1">//结果为：123456 abcdedf
</span><span class="c1">//6、给定一个字符串iios/12DDWDFF@122，获取 / 和 @ 之间的字符串，先将 &#34;iios/&#34;过滤掉，再将非&#39;@&#39;的一串内容送到buf中
</span><span class="c1"></span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;iios/12DDWDFF@122&#34;</span><span class="p">,</span> <span class="s">&#34;%*[^/]/%[^@]&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s/n&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;12DDWDFF Expect! %%*[^/]/%%[^@]/n/n&#34;</span><span class="p">);</span>
<span class="c1">//结果为：12DDWDFF
</span><span class="c1">//7、给定一个字符串““hello, world”，仅保留world。（注意：“，”之后有一空格）
</span><span class="c1"></span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;hello, world&#34;</span><span class="p">,</span>  <span class="s">&#34;%*s%s&#34;</span><span class="p">,</span>  <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s/n&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;world Expect! %%*s%%s/n/n&#34;</span><span class="p">);</span>
<span class="c1">//结果为：world 
</span><span class="c1">//8、参数size的控制
</span><span class="c1"></span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">m</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
 <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="c1">// sscanf 返回输入了几个参数
</span><span class="c1"></span> <span class="n">n</span> <span class="o">=</span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;010203040506&#34;</span><span class="p">,</span> <span class="s">&#34;%hhx%hhx%hhx%hhx%hhx%hhx&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;hhx: %d :%02x%02x%02x%02x%02x%02x/n&#34;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
<span class="c1">// 结果 n 为 1， 因为 hhx 把所有字符串作为一个数字，后面的都没有输入
</span><span class="c1"></span>        
 <span class="n">n</span> <span class="o">=</span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;010203040506&#34;</span><span class="p">,</span> <span class="s">&#34;%2hhx%2hhx%2hhx%2hhx%2hhx%2hhx&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34;2hhx: %d :%02x%02x%02x%02x%02x%02x/n&#34;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
<span class="c1">// 结果 n 为 6， 加了2，之后限制每次hhx只匹配2个字符，所以每个都被输入
</span><span class="c1"></span> <span class="n">n</span> <span class="o">=</span> <span class="n">sscanf</span><span class="p">(</span><span class="s">&#34;010203040506&#34;</span><span class="p">,</span> <span class="s">&#34;%02x%02x%02x%02x%02x%02x&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">&#34; 02x: %d :%02x%02x%02x%02x%02x%02x/n&#34;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
<span class="c1">// 0 是填充字符，2表示匹配2个字符，x表示一个十六进制数
</span><span class="c1">// 注意：编译有warning，有时结果是正确的（跟具体的编译器、编译选项、编译环境有关），但x表示4个字节，大于被输入对象的大小
</span><span class="c1">// 这会导致相邻的3个字节会被覆盖！！这会导致分配在相邻内存的变量被清0
</span><span class="c1">//http://blog.csdn.net/rainharder/archive/2008/09/27/2989675.aspx里面有个覆盖的例子
</span><span class="c1"></span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
