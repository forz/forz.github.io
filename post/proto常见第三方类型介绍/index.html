<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Proto常见第三方类型介绍 | Forz Blog</title>
<meta name="keywords" content="protobuf" />
<meta name="description" content="Any Any 包含任意序列化的消息以及描述序列化消息类型的URL。 JSON格式 Any值的JSON表示使用反序列化的嵌入式消息的常规表示，并带有一个@t">
<meta name="author" content="">
<link rel="canonical" href="/post/proto%E5%B8%B8%E8%A7%81%E7%AC%AC%E4%B8%89%E6%96%B9%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="Proto常见第三方类型介绍" />
<meta property="og:description" content="Any Any 包含任意序列化的消息以及描述序列化消息类型的URL。 JSON格式 Any值的JSON表示使用反序列化的嵌入式消息的常规表示，并带有一个@t" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/proto%E5%B8%B8%E8%A7%81%E7%AC%AC%E4%B8%89%E6%96%B9%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-04-17T14:17:14&#43;00:00" />
<meta property="article:modified_time" content="2021-04-17T14:17:14&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Proto常见第三方类型介绍"/>
<meta name="twitter:description" content="Any Any 包含任意序列化的消息以及描述序列化消息类型的URL。 JSON格式 Any值的JSON表示使用反序列化的嵌入式消息的常规表示，并带有一个@t"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Proto常见第三方类型介绍",
      "item": "/post/proto%E5%B8%B8%E8%A7%81%E7%AC%AC%E4%B8%89%E6%96%B9%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Proto常见第三方类型介绍",
  "name": "Proto常见第三方类型介绍",
  "description": "Any Any 包含任意序列化的消息以及描述序列化消息类型的URL。 JSON格式 Any值的JSON表示使用反序列化的嵌入式消息的常规表示，并带有一个@t",
  "keywords": [
    "protobuf"
  ],
  "articleBody": "Any Any 包含任意序列化的消息以及描述序列化消息类型的URL。\nJSON格式 Any值的JSON表示使用反序列化的嵌入式消息的常规表示，并带有一个@type包含URL类型的附加字段。例子：\n1 2 3 4 5 6 7 8 9 10 11  package google.profile;message Person { string first_name = 1; string last_name = 2;}{ \"@type\": \"type.googleapis.com/google.profile.Person\", \"firstName\": string, \"lastName\": string}  如果嵌入式消息类型是众所周知的并且具有自定义JSON表示形式，则将嵌入该表示形式，并添加一个字段value，该@type字段除包含该字段外还包含自定义JSON 。示例（针对message google.protobuf.Duration）：\n1 2 3 4  { \"@type\": \"type.googleapis.com/google.protobuf.Duration\", \"value\": \"1.212s\"}  APi Api是协议缓冲区服务的轻量级描述符。\nBoolValue bool的包装函式。\nbool的JSON表示形式BoolValue是true和false。\nBytesValue bytes的包装函式。\nBytesValue的JSON表示形式是JSON字符串。\nDoubleValue double的包装函式。\nDoubleValue的JSON表示形式是JSON Number。\nDuration Duration表示带符号的固定长度的时间跨度，表示为纳秒分辨率下的秒数和秒的分数。它独立于任何日历和概念，例如“天”或“月”。它与Timestamp有关，因为两个Timestamp值之间的差是Duration，可以将其相加或相减。范围约为+ -10,000年。\n示例1：使用伪代码从两个时间戳计算Duration。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  Timestamp start = ...; Timestamp end = ...; Duration duration = ...; duration.seconds = end.seconds - start.seconds; duration.nanos = end.nanos - start.nanos; if (duration.seconds  0 \u0026\u0026 duration.nanos  0) { duration.seconds += 1; duration.nanos -= 1000000000; } else if (duration.seconds  0 \u0026\u0026 duration.nanos  0) { duration.seconds -= 1; duration.nanos += 1000000000; }   示例2：使用伪代码从时间戳+Duration计算时间戳。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  Timestamp start = ...; Duration duration = ...; Timestamp end = ...; end.seconds = start.seconds + duration.seconds; end.nanos = start.nanos + duration.nanos; if (end.nanos  0) { end.seconds -= 1; end.nanos += 1000000000; } else if (end.nanos = 1000000000) { end.seconds += 1; end.nanos -= 1000000000; }   Empty 您可以重复使用的通用空消息，以避免在API中定义重复的空消息。一个典型的示例是将其用作API方法的请求或响应类型。例如：\n1 2 3  service Foo { rpc Bar(google.protobuf.Empty) returns (google.protobuf.Empty);}  Empty的JSON表示形式是空的JSON对象{}。\nEmun 枚举类型定义。\nEnumValue 枚举值定义。\nField 消息类型的单个字段。\nCardinality 字段是可选字段，必需字段还是重复字段。\nKind 基本字段类型。\nFieldMask FieldMask 代表一组符号字段路径，例如：\n1 2  paths: \"f.a\"paths: \"f.b.d\"  这里f表示在一些根消息的字段，a并且b在该消息中的字段中找到的f，并且d一个字段在消息中找到f.b。\n字段掩码用于指定应由get操作（projection）返回或由update操作修改的字段子集。字段掩码还具有自定义JSON编码（请参见下文）。\nField Masks in Projections 当FieldMask指定投影时，API将过滤响应消息（或子消息）以仅包含在掩码中指定的那些字段。例如，考虑以下“预屏蔽”响应消息：\n1 2 3 4 5 6 7 8 9  f { a : 22 b { d : 1 x : 2 } y : 13}z: 8  在上一个示例中应用了掩码之后，API响应将不包含字段x，y或z的特定值（它们的值将设置为默认值，并在原始文本输出中省略）：\n1 2 3 4 5 6  f { a : 22 b { d : 1 }}  除字段掩模的最后位置外，不允许重复字段。\n如果get操作中不存在FieldMask对象，则该操作将应用于所有字段（就像已指定所有字段的FieldMask一样）。\n请注意，字段掩码不一定适用于顶级响应消息。在进行REST获取操作的情况下，字段掩码直接应用于响应，但是在进行REST列表操作的情况下，掩码则应用于返回的资源列表中的每个消息。在REST自定义方法的情况下，可以使用其他定义。适用遮罩的位置将在API中明确记录及其声明。无论如何，对返回的一个或多个资源的影响是API必需的行为。\nField Masks in Update Operations 更新操作中的字段掩码指定要更新目标资源的哪些字段。要求API仅更改掩码中指定的字段的值，而其他字段保持不变。如果传入资源来描述更新的值，则API将忽略掩码未涵盖的所有字段的值。\n为了将字段的值重置为默认值，该字段必须位于掩码中，并在提供的资源中设置为默认值。因此，为了重置资源的所有字段，请提供资源的默认实例并在掩码中设置所有字段，或者不提供掩码，如下所述。\n如果更新时不存在字段掩码，则该操作将应用于所有字段（就像已指定所有字段的字段掩码一样）。请注意，在存在模式演化的情况下，这可能意味着客户端不知道并因此未填写到请求中的字段将重置为默认值。如果这是不希望的行为，则特定服务可能要求客户端始终指定字段掩码，否则将产生错误。\n与get操作一样，描述请求消息中更新值的资源位置取决于操作种类。在任何情况下，API都必须遵守字段掩码的作用。\nHTTP REST的注意事项 为了满足HTTP语义，必须将使用字段掩码的HTTP类型的更新操作设置为PATCH而不是PUT（PUT必须仅用于完全更新）。\n字段掩码的JSON编码 在JSON中，字段掩码编码为单个字符串，其中路径之间用逗号分隔。每个路径中的字段名称都与下层骆驼命名约定相互转换。\n例如，请考虑以下消息声明：\n1 2 3 4 5 6 7 8  message Profile { User user = 1; Photo photo = 2;}message User { string display_name = 1; string address = 2;}  在原始的掩码中，Profile可能看起来像这样：\n1 2 3 4  mask { paths: \"user.display_name\" paths: \"photo\" }   在JSON中，相同的掩码表示如下：\n1 2 3  { mask: \"user.displayName,photo\" }   FloatValue float的包装函式。\nFloatValue的JSON表示形式是JSON Number。\nInt32Value int32的包装函式。\nInt32Value的JSON表示形式是JSON Number。\nInt64Value int64的包装函式。\nInt64Value的JSON表示形式是JSON字符串。\nListValue ListValue 是围绕值的重复字段的包装。\nListValue的JSON表示形式是JSON数组。\nMethod 方法表示api的方法。\nMixin 声明要包含在此API中的API。包含的API必须从包含的API中重新声明所有方法，但是文档和选项的继承方式如下：\n  如果在注释和空格剥离之后，重新声明的方法的文档字符串为空，则它将从原始方法继承。\n  属于服务配置（http，可见性）的未在重新声明的方法中设置的每个注释都将被继承。\n  如果继承了http批注，则将按以下方式修改路径模式。root如果指定的话，任何版本前缀都将被包含API的版本以及路径所代替。\n  一个简单的mixin示例：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  package google.acl.v1;service AccessControl { // Get the underlying ACL object.  rpc GetAcl(GetAclRequest) returns (Acl) { option (google.api.http).get = \"/v1/{resource=**}:getAcl\"; }}package google.storage.v2;service Storage { // rpc GetAcl(GetAclRequest) returns (Acl);  // Get a data record.  rpc GetData(GetDataRequest) returns (Data) { option (google.api.http).get = \"/v2/{resource=**}\"; }}  mixin配置示例：\n1 2 3 4  apis:- name: google.storage.v2.Storage mixins: - name: google.acl.v1.AccessControl  mixin构造意味着AccessControl中的所有方法也都声明了相同的名称和请求/响应类型Storage。文档生成器或注释处理器Storage.GetAcl在继承文档和注释之后将看到有效的方法，如下所示：\n1 2 3 4 5 6 7  service Storage { // Get the underlying ACL object.  rpc GetAcl(GetAclRequest) returns (Acl) { option (google.api.http).get = \"/v2/{resource=**}:getAcl\"; } ...}  请注意，路径模式中的版本如何从更改v1为v2。\n如果root指定了mixin中的字段，则它应该是放置继承的HTTP路径的相对路径。例子：\n1 2 3 4 5  apis:* name: google.storage.v2.Storage mixins: * name: google.acl.v1.AccessControl root: acls  这意味着以下继承的HTTP批注：\n1 2 3 4 5 6 7  service Storage { // Get the underlying ACL object.  rpc GetAcl(GetAclRequest) returns (Acl) { option (google.api.http).get = \"/v2/acls/{resource=**}:getAcl\"; } ...}  NullValue NullValue是一个单例枚举，表示Value类型联合的空值。\n的JSON表示形式NullValue是JSON null。\nOption 协议缓冲区选项，可以附加到消息，字段，枚举等。\nSourceContext SourceContext 表示有关protobuf元素来源的信息，例如定义它的文件。\nStringValue string的包装函式。\nStringValue的JSON表示形式是JSON字符串。\nStruct Struct表示结构化的数据值，由映射到动态类型值的字段组成。在某些语言中，Struct本机表示可能会支持它。例如，在像JS这样的脚本语言中，结构表示为一个对象。该表示的详细信息与该语言的原始支持一起进行了描述。\nStruct的JSON表示形式是JSON对象。\nSyntax 定义协议缓冲区元素的语法。\nTimestamp 时间戳表示与任何时区或日历无关的时间点，以UTC纪元时间中的纳秒分辨率表示为秒和几分之一秒。它使用Proleptic Gregorian日历进行编码，该日历将Gregorian日历向后扩展到第一年。假设所有分钟都是60秒长，即leap抹了“leap秒”，那么就进行编码，因此不需要leap秒表进行解释。范围是0001-01-01T00：00：00Z至9999-12-31T23：59：59.999999999Z。通过限制该范围，我们确保可以在RFC 3339日期字符串之间来回转换。参见https://www.ietf.org/rfc/rfc3339.txt。\n示例1：从POSIX计算时间戳time()。\n1 2 3  Timestamp timestamp; timestamp.set_seconds(time(NULL)); timestamp.set_nanos(0);   示例2：从POSIX计算时间戳gettimeofday()。\n1 2 3 4 5 6  struct timeval tv; gettimeofday(\u0026tv, NULL); Timestamp timestamp; timestamp.set_seconds(tv.tv_sec); timestamp.set_nanos(tv.tv_usec * 1000);   示例3：从Win32计算时间戳GetSystemTimeAsFileTime()。\n1 2 3 4 5 6 7 8 9  FILETIME ft; GetSystemTimeAsFileTime(\u0026ft); UINT64 ticks = (((UINT64)ft.dwHighDateTime)  32) | ft.dwLowDateTime; // A Windows tick is 100 nanoseconds. Windows epoch 1601-01-01T00:00:00Z // is 11644473600 seconds before Unix epoch 1970-01-01T00:00:00Z. Timestamp timestamp; timestamp.set_seconds((INT64) ((ticks / 10000000) - 11644473600LL)); timestamp.set_nanos((INT32) ((ticks % 10000000) * 100));   示例4：从Java计算时间戳System.currentTimeMillis()。\n1 2 3 4  long millis = System.currentTimeMillis(); Timestamp timestamp = Timestamp.newBuilder().setSeconds(millis / 1000) .setNanos((int) ((millis % 1000) * 1000000)).build();   示例5：从Python中的当前时间计算时间戳。\n1 2 3 4  now = time.time() seconds = int(now) nanos = int((now - seconds) * 10**9) timestamp = Timestamp(seconds=seconds, nanos=nanos)   Type 协议缓冲区消息类型。\nUInt32Value uint32的包装函式。\nUInt32Value的JSON表示形式是JSON Number。\nUInt64Value uint64的包装函式。\nUInt64Value的JSON表示形式是JSON字符串。\nValue Value表示一个动态类型的值，该值可以为null，数字，字符串，布尔值，递归结构值或值列表。Value生产者应设置其中一个变量，如果不存在任何变量，则表明存在错误。\nValue的JSON表示形式是JSON值。\n",
  "wordCount" : "3814",
  "inLanguage": "zh-cn",
  "datePublished": "2021-04-17T14:17:14Z",
  "dateModified": "2021-04-17T14:17:14Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/proto%E5%B8%B8%E8%A7%81%E7%AC%AC%E4%B8%89%E6%96%B9%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Proto常见第三方类型介绍
    </h1>
    <div class="post-meta">April 17, 2021
</div>
  </header> 
  <div class="post-content"><h2 id="any">Any<a hidden class="anchor" aria-hidden="true" href="#any">#</a></h2>
<p>Any 包含任意序列化的消息以及描述序列化消息类型的URL。</p>
<p>JSON格式
Any值的JSON表示使用反序列化的嵌入式消息的常规表示，并带有一个@type包含URL类型的附加字段。例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="kn">package</span> <span class="nn">google</span><span class="o">.</span><span class="n">profile</span><span class="p">;</span><span class="err">
</span><span class="err"></span><span class="kd">message</span> <span class="nc">Person</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="kt">string</span> <span class="n">first_name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span><span class="err"></span>  <span class="kt">string</span> <span class="n">last_name</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="s">&#34;@type&#34;</span><span class="o">:</span> <span class="s">&#34;type.googleapis.com/google.profile.Person&#34;</span><span class="p">,</span><span class="err">
</span><span class="err"></span>  <span class="s">&#34;firstName&#34;</span><span class="o">:</span> <span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;,</span><span class="err">
</span><span class="err"></span>  <span class="s">&#34;lastName&#34;</span><span class="o">:</span> <span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>如果嵌入式消息类型是众所周知的并且具有自定义JSON表示形式，则将嵌入该表示形式，并添加一个字段value，该@type字段除包含该字段外还包含自定义JSON 。示例（针对message google.protobuf.Duration）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="s">&#34;@type&#34;</span><span class="o">:</span> <span class="s">&#34;type.googleapis.com/google.protobuf.Duration&#34;</span><span class="p">,</span><span class="err">
</span><span class="err"></span>  <span class="s">&#34;value&#34;</span><span class="o">:</span> <span class="s">&#34;1.212s&#34;</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417142704.png" alt=""  />
</p>
<h2 id="api">APi<a hidden class="anchor" aria-hidden="true" href="#api">#</a></h2>
<p>Api是协议缓冲区服务的轻量级描述符。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417143218.png" alt=""  />
</p>
<h2 id="boolvalue">BoolValue<a hidden class="anchor" aria-hidden="true" href="#boolvalue">#</a></h2>
<p>bool的包装函式。</p>
<p>bool的JSON表示形式BoolValue是true和false。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417143347.png" alt=""  />
</p>
<h2 id="bytesvalue">BytesValue<a hidden class="anchor" aria-hidden="true" href="#bytesvalue">#</a></h2>
<p>bytes的包装函式。</p>
<p>BytesValue的JSON表示形式是JSON字符串。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417143555.png" alt=""  />
</p>
<h2 id="doublevalue">DoubleValue<a hidden class="anchor" aria-hidden="true" href="#doublevalue">#</a></h2>
<p>double的包装函式。</p>
<p>DoubleValue的JSON表示形式是JSON Number。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417144151.png" alt=""  />
</p>
<h2 id="duration">Duration<a hidden class="anchor" aria-hidden="true" href="#duration">#</a></h2>
<p>Duration表示带符号的固定长度的时间跨度，表示为纳秒分辨率下的秒数和秒的分数。它独立于任何日历和概念，例如“天”或“月”。它与Timestamp有关，因为两个Timestamp值之间的差是Duration，可以将其相加或相减。范围约为+ -10,000年。</p>
<p>示例1：使用伪代码从两个时间戳计算Duration。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">Timestamp</span> <span class="n">start</span> <span class="o">=</span> <span class="kc">...</span><span class="p">;</span>
<span class="n">Timestamp</span> <span class="n">end</span> <span class="o">=</span> <span class="kc">...</span><span class="p">;</span>
<span class="n">Duration</span> <span class="n">duration</span> <span class="o">=</span> <span class="kc">...</span><span class="p">;</span>

<span class="n">duration.seconds</span> <span class="o">=</span> <span class="n">end.seconds</span> <span class="o">-</span> <span class="n">start.seconds</span><span class="p">;</span>
<span class="n">duration.nanos</span> <span class="o">=</span> <span class="n">end.nanos</span> <span class="o">-</span> <span class="n">start.nanos</span><span class="p">;</span>

<span class="nf">if </span><span class="p">(</span><span class="n">duration.seconds</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="n">duration.nanos</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">duration.seconds</span> <span class="o">+=</span> <span class="m">1</span><span class="p">;</span>
  <span class="n">duration.nanos</span> <span class="o">-=</span> <span class="m">1000000000</span><span class="p">;</span>
<span class="p">}</span> <span class="n">else</span> <span class="nf">if </span><span class="p">(</span><span class="n">duration.seconds</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="n">duration.nanos</span> <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">duration.seconds</span> <span class="o">-=</span> <span class="m">1</span><span class="p">;</span>
  <span class="n">duration.nanos</span> <span class="o">+=</span> <span class="m">1000000000</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>示例2：使用伪代码从时间戳+Duration计算时间戳。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">Timestamp</span> <span class="n">start</span> <span class="o">=</span> <span class="kc">...</span><span class="p">;</span>
<span class="n">Duration</span> <span class="n">duration</span> <span class="o">=</span> <span class="kc">...</span><span class="p">;</span>
<span class="n">Timestamp</span> <span class="n">end</span> <span class="o">=</span> <span class="kc">...</span><span class="p">;</span>

<span class="n">end.seconds</span> <span class="o">=</span> <span class="n">start.seconds</span> <span class="o">+</span> <span class="n">duration.seconds</span><span class="p">;</span>
<span class="n">end.nanos</span> <span class="o">=</span> <span class="n">start.nanos</span> <span class="o">+</span> <span class="n">duration.nanos</span><span class="p">;</span>

<span class="nf">if </span><span class="p">(</span><span class="n">end.nanos</span> <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">end.seconds</span> <span class="o">-=</span> <span class="m">1</span><span class="p">;</span>
  <span class="n">end.nanos</span> <span class="o">+=</span> <span class="m">1000000000</span><span class="p">;</span>
<span class="p">}</span> <span class="n">else</span> <span class="nf">if </span><span class="p">(</span><span class="n">end.nanos</span> <span class="o">&gt;=</span> <span class="m">1000000000</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">end.seconds</span> <span class="o">+=</span> <span class="m">1</span><span class="p">;</span>
  <span class="n">end.nanos</span> <span class="o">-=</span> <span class="m">1000000000</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417144312.png" alt=""  />
</p>
<h2 id="empty">Empty<a hidden class="anchor" aria-hidden="true" href="#empty">#</a></h2>
<p>您可以重复使用的通用空消息，以避免在API中定义重复的空消息。一个典型的示例是将其用作API方法的请求或响应类型。例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="kd">service</span> <span class="n">Foo</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="k">rpc</span> <span class="n">Bar</span><span class="p">(</span><span class="n">google.protobuf.Empty</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">google.protobuf.Empty</span><span class="p">);</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>Empty的JSON表示形式是空的JSON对象{}。</p>
<h2 id="emun">Emun<a hidden class="anchor" aria-hidden="true" href="#emun">#</a></h2>
<p>枚举类型定义。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417144802.png" alt=""  />
</p>
<h2 id="enumvalue">EnumValue<a hidden class="anchor" aria-hidden="true" href="#enumvalue">#</a></h2>
<p>枚举值定义。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417144834.png" alt=""  />
</p>
<h2 id="field">Field<a hidden class="anchor" aria-hidden="true" href="#field">#</a></h2>
<p>消息类型的单个字段。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417145211.png" alt=""  />
</p>
<h2 id="cardinality">Cardinality<a hidden class="anchor" aria-hidden="true" href="#cardinality">#</a></h2>
<p>字段是可选字段，必需字段还是重复字段。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417153714.png" alt=""  />
</p>
<h2 id="kind">Kind<a hidden class="anchor" aria-hidden="true" href="#kind">#</a></h2>
<p>基本字段类型。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417153807.png" alt=""  />
</p>
<h2 id="fieldmask">FieldMask<a hidden class="anchor" aria-hidden="true" href="#fieldmask">#</a></h2>
<p>FieldMask 代表一组符号字段路径，例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="n">paths</span><span class="o">:</span> <span class="s">&#34;f.a&#34;</span><span class="err">
</span><span class="err"></span><span class="n">paths</span><span class="o">:</span> <span class="s">&#34;f.b.d&#34;</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>这里f表示在一些根消息的字段，a并且b在该消息中的字段中找到的f，并且d一个字段在消息中找到f.b。</p>
<p>字段掩码用于指定应由get操作（projection）返回或由update操作修改的字段子集。字段掩码还具有自定义JSON编码（请参见下文）。</p>
<h3 id="field-masks-in-projections">Field Masks in Projections<a hidden class="anchor" aria-hidden="true" href="#field-masks-in-projections">#</a></h3>
<p>当FieldMask指定投影时，API将过滤响应消息（或子消息）以仅包含在掩码中指定的那些字段。例如，考虑以下“预屏蔽”响应消息：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="n">f</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="n">a</span> <span class="o">:</span> <span class="mi">22</span><span class="err">
</span><span class="err"></span>  <span class="n">b</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>    <span class="n">d</span> <span class="o">:</span> <span class="mi">1</span><span class="err">
</span><span class="err"></span>    <span class="n">x</span> <span class="o">:</span> <span class="mi">2</span><span class="err">
</span><span class="err"></span>  <span class="p">}</span><span class="err">
</span><span class="err"></span>  <span class="n">y</span> <span class="o">:</span> <span class="mi">13</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span><span class="err"></span><span class="n">z</span><span class="o">:</span> <span class="mi">8</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>在上一个示例中应用了掩码之后，API响应将不包含字段x，y或z的特定值（它们的值将设置为默认值，并在原始文本输出中省略）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="n">f</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="n">a</span> <span class="o">:</span> <span class="mi">22</span><span class="err">
</span><span class="err"></span>  <span class="n">b</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>    <span class="n">d</span> <span class="o">:</span> <span class="mi">1</span><span class="err">
</span><span class="err"></span>  <span class="p">}</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>除字段掩模的最后位置外，不允许重复字段。</p>
<p>如果get操作中不存在FieldMask对象，则该操作将应用于所有字段（就像已指定所有字段的FieldMask一样）。</p>
<p>请注意，字段掩码不一定适用于顶级响应消息。在进行REST获取操作的情况下，字段掩码直接应用于响应，但是在进行REST列表操作的情况下，掩码则应用于返回的资源列表中的每个消息。在REST自定义方法的情况下，可以使用其他定义。适用遮罩的位置将在API中明确记录及其声明。无论如何，对返回的一个或多个资源的影响是API必需的行为。</p>
<h3 id="field-masks-in-update-operations">Field Masks in Update Operations<a hidden class="anchor" aria-hidden="true" href="#field-masks-in-update-operations">#</a></h3>
<p>更新操作中的字段掩码指定要更新目标资源的哪些字段。要求API仅更改掩码中指定的字段的值，而其他字段保持不变。如果传入资源来描述更新的值，则API将忽略掩码未涵盖的所有字段的值。</p>
<p>为了将字段的值重置为默认值，该字段必须位于掩码中，并在提供的资源中设置为默认值。因此，为了重置资源的所有字段，请提供资源的默认实例并在掩码中设置所有字段，或者不提供掩码，如下所述。</p>
<p>如果更新时不存在字段掩码，则该操作将应用于所有字段（就像已指定所有字段的字段掩码一样）。请注意，在存在模式演化的情况下，这可能意味着客户端不知道并因此未填写到请求中的字段将重置为默认值。如果这是不希望的行为，则特定服务可能要求客户端始终指定字段掩码，否则将产生错误。</p>
<p>与get操作一样，描述请求消息中更新值的资源位置取决于操作种类。在任何情况下，API都必须遵守字段掩码的作用。</p>
<h3 id="http-rest的注意事项">HTTP REST的注意事项<a hidden class="anchor" aria-hidden="true" href="#http-rest的注意事项">#</a></h3>
<p>为了满足HTTP语义，必须将使用字段掩码的HTTP类型的更新操作设置为PATCH而不是PUT（PUT必须仅用于完全更新）。</p>
<h3 id="字段掩码的json编码">字段掩码的JSON编码<a hidden class="anchor" aria-hidden="true" href="#字段掩码的json编码">#</a></h3>
<p>在JSON中，字段掩码编码为单个字符串，其中路径之间用逗号分隔。每个路径中的字段名称都与下层骆驼命名约定相互转换。</p>
<p>例如，请考虑以下消息声明：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="kd">message</span> <span class="nc">Profile</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span><span class="err"></span>  <span class="n">Photo</span> <span class="n">photo</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span><span class="err"></span><span class="kd">message</span> <span class="nc">User</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="kt">string</span> <span class="n">display_name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="err">
</span><span class="err"></span>  <span class="kt">string</span> <span class="n">address</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>在原始的掩码中，Profile可能看起来像这样：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">mask</span> <span class="p">{</span>
  <span class="err">paths:</span> <span class="nt">&#34;user.display_name&#34;</span>
  <span class="err">paths</span><span class="p">:</span> <span class="s2">&#34;photo&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>在JSON中，相同的掩码表示如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="err">mask:</span> <span class="nt">&#34;user.displayName,photo&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417155729.png" alt=""  />
</p>
<h2 id="floatvalue">FloatValue<a hidden class="anchor" aria-hidden="true" href="#floatvalue">#</a></h2>
<p>float的包装函式。</p>
<p>FloatValue的JSON表示形式是JSON Number。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417160014.png" alt=""  />
</p>
<h2 id="int32value">Int32Value<a hidden class="anchor" aria-hidden="true" href="#int32value">#</a></h2>
<p>int32的包装函式。</p>
<p>Int32Value的JSON表示形式是JSON Number。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417160032.png" alt=""  />
</p>
<h2 id="int64value">Int64Value<a hidden class="anchor" aria-hidden="true" href="#int64value">#</a></h2>
<p>int64的包装函式。</p>
<p>Int64Value的JSON表示形式是JSON字符串。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417160107.png" alt=""  />
</p>
<h2 id="listvalue">ListValue<a hidden class="anchor" aria-hidden="true" href="#listvalue">#</a></h2>
<p>ListValue 是围绕值的重复字段的包装。</p>
<p>ListValue的JSON表示形式是JSON数组。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417160258.png" alt=""  />
</p>
<h2 id="method">Method<a hidden class="anchor" aria-hidden="true" href="#method">#</a></h2>
<p>方法表示api的方法。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417160325.png" alt=""  />
</p>
<h2 id="mixin">Mixin<a hidden class="anchor" aria-hidden="true" href="#mixin">#</a></h2>
<p>声明要包含在此API中的API。包含的API必须从包含的API中重新声明所有方法，但是文档和选项的继承方式如下：</p>
<ul>
<li>
<p>如果在注释和空格剥离之后，重新声明的方法的文档字符串为空，则它将从原始方法继承。</p>
</li>
<li>
<p>属于服务配置（http，可见性）的未在重新声明的方法中设置的每个注释都将被继承。</p>
</li>
<li>
<p>如果继承了http批注，则将按以下方式修改路径模式。root如果指定的话，任何版本前缀都将被包含API的版本以及路径所代替。</p>
</li>
</ul>
<p>一个简单的mixin示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="kn">package</span> <span class="nn">google</span><span class="o">.</span><span class="n">acl.v1</span><span class="p">;</span><span class="err">
</span><span class="err"></span><span class="kd">service</span> <span class="n">AccessControl</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="c1">// Get the underlying ACL object.
</span><span class="c1"></span>  <span class="k">rpc</span> <span class="n">GetAcl</span><span class="p">(</span><span class="n">GetAclRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">Acl</span><span class="p">)</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>    <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="s">&#34;/v1/{resource=**}:getAcl&#34;</span><span class="p">;</span><span class="err">
</span><span class="err"></span>  <span class="p">}</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="kn">package</span> <span class="nn">google</span><span class="o">.</span><span class="n">storage.v2</span><span class="p">;</span><span class="err">
</span><span class="err"></span><span class="kd">service</span> <span class="n">Storage</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="c1">//       rpc GetAcl(GetAclRequest) returns (Acl);
</span><span class="c1"></span><span class="err">
</span><span class="err"></span>  <span class="c1">// Get a data record.
</span><span class="c1"></span>  <span class="k">rpc</span> <span class="n">GetData</span><span class="p">(</span><span class="n">GetDataRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">Data</span><span class="p">)</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>    <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="s">&#34;/v2/{resource=**}&#34;</span><span class="p">;</span><span class="err">
</span><span class="err"></span>  <span class="p">}</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>mixin配置示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="n">apis</span><span class="o">:</span><span class="err">
</span><span class="err"></span><span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">google.storage.v2.Storage</span><span class="err">
</span><span class="err"></span>  <span class="n">mixins</span><span class="o">:</span><span class="err">
</span><span class="err"></span>  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">google.acl.v1.AccessControl</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>mixin构造意味着AccessControl中的所有方法也都声明了相同的名称和请求/响应类型Storage。文档生成器或注释处理器Storage.GetAcl在继承文档和注释之后将看到有效的方法，如下所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="kd">service</span> <span class="n">Storage</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="c1">// Get the underlying ACL object.
</span><span class="c1"></span>  <span class="k">rpc</span> <span class="n">GetAcl</span><span class="p">(</span><span class="n">GetAclRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">Acl</span><span class="p">)</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>    <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="s">&#34;/v2/{resource=**}:getAcl&#34;</span><span class="p">;</span><span class="err">
</span><span class="err"></span>  <span class="p">}</span><span class="err">
</span><span class="err"></span>  <span class="o">...</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>请注意，路径模式中的版本如何从更改v1为v2。</p>
<p>如果root指定了mixin中的字段，则它应该是放置继承的HTTP路径的相对路径。例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="n">apis</span><span class="o">:</span><span class="err">
</span><span class="err">*</span> <span class="n">name</span><span class="o">:</span> <span class="n">google.storage.v2.Storage</span><span class="err">
</span><span class="err"></span>  <span class="n">mixins</span><span class="o">:</span><span class="err">
</span><span class="err"></span>  <span class="err">*</span> <span class="n">name</span><span class="o">:</span> <span class="n">google.acl.v1.AccessControl</span><span class="err">
</span><span class="err"></span>    <span class="n">root</span><span class="o">:</span> <span class="n">acls</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>这意味着以下继承的HTTP批注：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-protobuf" data-lang="protobuf"><span class="kd">service</span> <span class="n">Storage</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>  <span class="c1">// Get the underlying ACL object.
</span><span class="c1"></span>  <span class="k">rpc</span> <span class="n">GetAcl</span><span class="p">(</span><span class="n">GetAclRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">Acl</span><span class="p">)</span> <span class="p">{</span><span class="err">
</span><span class="err"></span>    <span class="k">option</span> <span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="s">&#34;/v2/acls/{resource=**}:getAcl&#34;</span><span class="p">;</span><span class="err">
</span><span class="err"></span>  <span class="p">}</span><span class="err">
</span><span class="err"></span>  <span class="o">...</span><span class="err">
</span><span class="err"></span><span class="p">}</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417162627.png" alt=""  />
</p>
<h2 id="nullvalue">NullValue<a hidden class="anchor" aria-hidden="true" href="#nullvalue">#</a></h2>
<p>NullValue是一个单例枚举，表示Value类型联合的空值。</p>
<p>的JSON表示形式NullValue是JSON null。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417162713.png" alt=""  />
</p>
<h2 id="option">Option<a hidden class="anchor" aria-hidden="true" href="#option">#</a></h2>
<p>协议缓冲区选项，可以附加到消息，字段，枚举等。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417163054.png" alt=""  />
</p>
<h2 id="sourcecontext">SourceContext<a hidden class="anchor" aria-hidden="true" href="#sourcecontext">#</a></h2>
<p>SourceContext 表示有关protobuf元素来源的信息，例如定义它的文件。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417165753.png" alt=""  />
</p>
<h2 id="stringvalue">StringValue<a hidden class="anchor" aria-hidden="true" href="#stringvalue">#</a></h2>
<p>string的包装函式。</p>
<p>StringValue的JSON表示形式是JSON字符串。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417165837.png" alt=""  />
</p>
<h2 id="struct">Struct<a hidden class="anchor" aria-hidden="true" href="#struct">#</a></h2>
<p>Struct表示结构化的数据值，由映射到动态类型值的字段组成。在某些语言中，Struct本机表示可能会支持它。例如，在像JS这样的脚本语言中，结构表示为一个对象。该表示的详细信息与该语言的原始支持一起进行了描述。</p>
<p>Struct的JSON表示形式是JSON对象。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417165926.png" alt=""  />
</p>
<h2 id="syntax">Syntax<a hidden class="anchor" aria-hidden="true" href="#syntax">#</a></h2>
<p>定义协议缓冲区元素的语法。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417170020.png" alt=""  />
</p>
<h2 id="timestamp">Timestamp<a hidden class="anchor" aria-hidden="true" href="#timestamp">#</a></h2>
<p>时间戳表示与任何时区或日历无关的时间点，以UTC纪元时间中的纳秒分辨率表示为秒和几分之一秒。它使用Proleptic Gregorian日历进行编码，该日历将Gregorian日历向后扩展到第一年。假设所有分钟都是60秒长，即leap抹了“leap秒”，那么就进行编码，因此不需要leap秒表进行解释。范围是0001-01-01T00：00：00Z至9999-12-31T23：59：59.999999999Z。通过限制该范围，我们确保可以在RFC 3339日期字符串之间来回转换。参见<a href="https://www.ietf.org/rfc/rfc3339.txt">https://www.ietf.org/rfc/rfc3339.txt</a>。</p>
<p>示例1：从POSIX计算时间戳time()。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">Timestamp</span> <span class="n">timestamp</span><span class="p">;</span>
<span class="nf">timestamp.set_seconds</span><span class="p">(</span><span class="nf">time</span><span class="p">(</span><span class="kc">NULL</span><span class="p">));</span>
<span class="nf">timestamp.set_nanos</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>示例2：从POSIX计算时间戳gettimeofday()。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">struct</span> <span class="n">timeval</span> <span class="n">tv</span><span class="p">;</span>
<span class="nf">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">,</span> <span class="kc">NULL</span><span class="p">);</span>

<span class="n">Timestamp</span> <span class="n">timestamp</span><span class="p">;</span>
<span class="nf">timestamp.set_seconds</span><span class="p">(</span><span class="n">tv.tv_sec</span><span class="p">);</span>
<span class="nf">timestamp.set_nanos</span><span class="p">(</span><span class="n">tv.tv_usec</span> <span class="o">*</span> <span class="m">1000</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>示例3：从Win32计算时间戳GetSystemTimeAsFileTime()。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">FILETIME</span> <span class="n">ft</span><span class="p">;</span>
<span class="nf">GetSystemTimeAsFileTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ft</span><span class="p">);</span>
<span class="n">UINT64</span> <span class="n">ticks</span> <span class="o">=</span> <span class="p">(((</span><span class="n">UINT64</span><span class="p">)</span><span class="n">ft.dwHighDateTime</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="m">32</span><span class="p">)</span> <span class="o">|</span> <span class="n">ft.dwLowDateTime</span><span class="p">;</span>

<span class="o">//</span> <span class="n">A</span> <span class="n">Windows</span> <span class="n">tick</span> <span class="n">is</span> <span class="m">100</span> <span class="n">nanoseconds.</span> <span class="n">Windows</span> <span class="n">epoch</span> <span class="m">1601-01-01</span><span class="n">T00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="n">Z</span>
<span class="o">//</span> <span class="n">is</span> <span class="m">11644473600</span> <span class="n">seconds</span> <span class="n">before</span> <span class="n">Unix</span> <span class="n">epoch</span> <span class="m">1970-01-01</span><span class="n">T00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="n">Z.</span>
<span class="n">Timestamp</span> <span class="n">timestamp</span><span class="p">;</span>
<span class="nf">timestamp.set_seconds</span><span class="p">((</span><span class="n">INT64</span><span class="p">)</span> <span class="p">((</span><span class="n">ticks</span> <span class="o">/</span> <span class="m">10000000</span><span class="p">)</span> <span class="o">-</span> <span class="m">11644473600L</span><span class="n">L</span><span class="p">));</span>
<span class="nf">timestamp.set_nanos</span><span class="p">((</span><span class="n">INT32</span><span class="p">)</span> <span class="p">((</span><span class="n">ticks</span> % <span class="m">10000000</span><span class="p">)</span> <span class="o">*</span> <span class="m">100</span><span class="p">));</span>
</code></pre></td></tr></table>
</div>
</div><p>示例4：从Java计算时间戳System.currentTimeMillis()。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">long</span> <span class="n">millis</span> <span class="o">=</span> <span class="nf">System.currentTimeMillis</span><span class="p">();</span>

<span class="n">Timestamp</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="nf">Timestamp.newBuilder</span><span class="p">()</span><span class="nf">.setSeconds</span><span class="p">(</span><span class="n">millis</span> <span class="o">/</span> <span class="m">1000</span><span class="p">)</span>
    <span class="nf">.setNanos</span><span class="p">((</span><span class="n">int</span><span class="p">)</span> <span class="p">((</span><span class="n">millis</span> % <span class="m">1000</span><span class="p">)</span> <span class="o">*</span> <span class="m">1000000</span><span class="p">))</span><span class="nf">.build</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><p>示例5：从Python中的当前时间计算时间戳。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">now</span> <span class="o">=</span> <span class="nf">time.time</span><span class="p">()</span>
<span class="n">seconds</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
<span class="n">nanos</span> <span class="o">=</span> <span class="nf">int</span><span class="p">((</span><span class="n">now</span> <span class="o">-</span> <span class="n">seconds</span><span class="p">)</span> <span class="o">*</span> <span class="m">10</span><span class="o">**</span><span class="m">9</span><span class="p">)</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="nf">Timestamp</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">seconds</span><span class="p">,</span> <span class="n">nanos</span><span class="o">=</span><span class="n">nanos</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417170332.png" alt=""  />
</p>
<h2 id="type">Type<a hidden class="anchor" aria-hidden="true" href="#type">#</a></h2>
<p>协议缓冲区消息类型。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417170413.png" alt=""  />
</p>
<h2 id="uint32value">UInt32Value<a hidden class="anchor" aria-hidden="true" href="#uint32value">#</a></h2>
<p>uint32的包装函式。</p>
<p>UInt32Value的JSON表示形式是JSON Number。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417170613.png" alt=""  />
</p>
<h2 id="uint64value">UInt64Value<a hidden class="anchor" aria-hidden="true" href="#uint64value">#</a></h2>
<p>uint64的包装函式。</p>
<p>UInt64Value的JSON表示形式是JSON字符串。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417170640.png" alt=""  />
</p>
<h2 id="value">Value<a hidden class="anchor" aria-hidden="true" href="#value">#</a></h2>
<p>Value表示一个动态类型的值，该值可以为null，数字，字符串，布尔值，递归结构值或值列表。Value生产者应设置其中一个变量，如果不存在任何变量，则表明存在错误。</p>
<p>Value的JSON表示形式是JSON值。</p>
<p><img loading="lazy" src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/20210417170721.png" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/protobuf/">protobuf</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
