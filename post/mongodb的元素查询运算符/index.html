<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MongoDB的元素查询运算符 | Forz Blog</title>
<meta name="keywords" content="MongoDB" />
<meta name="description" content="$exists 语法：{ field: { $exists: &lt;boolean&gt; } } 如果&lt;boolean&gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果&">
<meta name="author" content="">
<link rel="canonical" href="/post/mongodb%E7%9A%84%E5%85%83%E7%B4%A0%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="MongoDB的元素查询运算符" />
<meta property="og:description" content="$exists 语法：{ field: { $exists: &lt;boolean&gt; } } 如果&lt;boolean&gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果&" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/mongodb%E7%9A%84%E5%85%83%E7%B4%A0%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-05-13T15:44:52&#43;00:00" />
<meta property="article:modified_time" content="2020-05-13T15:44:52&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MongoDB的元素查询运算符"/>
<meta name="twitter:description" content="$exists 语法：{ field: { $exists: &lt;boolean&gt; } } 如果&lt;boolean&gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果&"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "MongoDB的元素查询运算符",
      "item": "/post/mongodb%E7%9A%84%E5%85%83%E7%B4%A0%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MongoDB的元素查询运算符",
  "name": "MongoDB的元素查询运算符",
  "description": "$exists 语法：{ field: { $exists: \u0026lt;boolean\u0026gt; } } 如果\u0026lt;boolean\u0026gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果\u0026",
  "keywords": [
    "MongoDB"
  ],
  "articleBody": "$exists 语法：{ field: { $exists:  } }\n如果为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果为false，则查询仅返回不包含该字段的文档。\nMongoDB的$exists并没有对应的SQL操作 exists。\n例子 存在且不等于 考虑以下示例：\n1  db.inventory.find( { qty: { $exists: true, $nin: [ 5, 15 ] } } )   该查询将选择inventory集合中该qty字段存在且其值不等于5或15的所有文档。\n空值 以下示例使用以records以下文档命名的集合：\n1 2 3 4 5 6 7 8 9 10  { a: 5, b: 5, c: null } { a: 3, b: null, c: 8 } { a: null, b: 3, c: 9 } { a: 1, b: 2, c: 3 } { a: 2, c: 5 } { a: 3, b: 2 } { a: 4 } { b: 2, c: 4 } { b: 2 } { c: 6 }   $exists: true 以下查询指定查询：a: { $exists: true }\n1  db.records.find( { a: { $exists: true } } )   结果由包含字段a的文档组成，包括其字段a包含空值的文档：\n1 2 3 4 5 6 7  { a: 5, b: 5, c: null } { a: 3, b: null, c: 8 } { a: null, b: 3, c: 9 } { a: 1, b: 2, c: 3 } { a: 2, c: 5 } { a: 3, b: 2 } { a: 4 }   $exists: false 以下查询指定查询：b: { $exists: false }\n1  db.records.find( { b: { $exists: false } } )   结果由不包含该字段的那些文档组成 b：\n1 2 3  { a: 2, c: 5 } { a: 4 } { c: 6 }   $type $type选择文档，其中字段的值是指定BSON类型的实例。在处理数据类型不可预测的高度非结构化数据时，按数据类型查询很有用。\n$type单个表达BSON类型的语法如下：\n在版本3.2中更改。\n1  { field: { $type:  type } }   您可以为BSON类型指定数字或别名\n该$type表达式还可以接受BSON类型的数组，并具有以下语法：\n1  { field: { $type: [  type1 ,  type2, ... ] } }   上面的查询将匹配field值是任何列出的类型的文档。数组中指定的类型可以是数字或字符串别名。\n有关示例，请参见按多种数据类型查询。\n可用类型描述BSON类型及其对应的数字和字符串别名。\n特性 $type返回字段的BSON类型与传递给$type的BSON类型匹配的文档。\n数组 对于其中field是数组的文档，$ type返回的文档中至少有一个array元素与传递给$ type的类型匹配。\n查询数组BSON类型 在MongoDB 3.6和更高版本中，查询$type：“array”会返回文档，其中字段本身是数组。在MongoDB 3.6之前，$type：“array”返回文档，其中该字段是一个包含至少一个type类型元素的数组。\n1 2  { \"data\" : [ \"values\", [ \"values\" ] ] } { \"data\" : [ \"values\" ] }   在MongoDB 3.6和更高版本中，find( {\"data\" : { $type : \"array\" } } )查询将返回两个文档。在MongoDB 3.6之前，查询仅返回第一个文档。\n可用类型 从MongoDB 3.2开始，$type除了接受与BSON类型相对应的数字外，还接受BSON类型的字符串别名。以前的版本仅接受与BSON类型相对应的数字。\n   Type Number Alias Notes     Double 1 “double”    String 2 “string”    Object 3 “object”    Array 4 “array”    Binary data 5 “binData”    Undefined 6 “undefined” Deprecated.   ObjectId 7 “objectId”    Boolean 8 “bool”    Date 9 “date”    Null 10 “null”    Regular Expression 11 “regex”    DBPointer 12 “dbPointer” Deprecated.   JavaScript 13 “javascript”    Symbol 14 “symbol” Deprecated.   JavaScript (with scope) 15 “javascriptWithScope”    32-bit integer 16 “int”    Timestamp 17 “timestamp”    64-bit integer 18 “long”    Decimal128 19 “decimal” New in version 3.4.   Min key -1 “minKey”    Max key 127 “maxKey”     $type支持number别名，它将与以下BSON类型匹配：\n double 32-bit integer 64-bit integer decimal  MinKey和MaxKey MinKey和 MaxKey 用于比较操作，主要用于内部使用。对于所有可能的BSON元素值，MinKey将始终为最小值，而MaxKey始终为最大值。\n使用$type查询minKey或maxKey 只会返回与特殊MinKey或MaxKey值匹配的字段。\n假设该data集合有两个文档，MinKey并且具有和MaxKey：\n1 2  { \"_id\" : 1, x : { \"$minKey\" : 1 } } { \"_id\" : 2, y : { \"$maxKey\" : 1 } }   以下查询将返回带有以下内容的文档：_id: 1\n1  db.data.find( { x: { $type: \"minKey\" } } )   以下查询将返回带有以下内容的文档：_id: 2\n1  db.data.find( { y: { $type: \"maxKey\" } } )   例子 按数据类型查询 在addressBook包含地址和邮编，在那里 zipCode有string，int，double，和long 值：\n1 2 3 4 5 6 7 8 9  db.addressBook.insertMany( [ { \"_id\" : 1, address : \"2030 Martian Way\", zipCode : \"90698345\" }, { \"_id\" : 2, address: \"156 Lunar Place\", zipCode : 43339374 }, { \"_id\" : 3, address : \"2324 Pluto Place\", zipCode: NumberLong(3921412) }, { \"_id\" : 4, address : \"55 Saturn Ring\" , zipCode : NumberInt(88602117) }, { \"_id\" : 5, address : \"104 Venus Drive\", zipCode : [\"834847278\", \"1893289032\"]} ] )   以下查询返回的所有文件，其中zipCode是 BSON类型string 或为含有指定的类型的元素的数组：\n1 2  db.addressBook.find( { \"zipCode\" : { $type : 2 } } ); db.addressBook.find( { \"zipCode\" : { $type : \"string\" } } );   这些查询返回：\n1 2  { \"_id\" : 1, \"address\" : \"2030 Martian Way\", \"zipCode\" : \"90698345\" } { \"_id\" : 5, address : \"104 Venus Drive\", zipCOde : [\"834847278\", \"1893289032\"]}   以下查询返回的所有文件，其中zipCode是 BSON类型double 或为含有指定的类型的元素的数组：\n1 2  db.addressBook.find( { \"zipCode\" : { $type : 1 } } ) db.addressBook.find( { \"zipCode\" : { $type : \"double\" } } )   这些查询返回：\n1  { \"_id\" : 2, \"address\" : \"156 Lunar Place\", \"zip\" : 43339374 }   以下查询使用的number别名返回文档，其中 zipCode是BSON类型double，int或long 或者是包含指定类型的元素的数组：\n1  db.addressBook.find( { \"zipCode\" : { $type : \"number\" } } )   这些查询返回：\n1 2 3  { \"_id\" : 2, address : \"156 Lunar Place\", zipCode : 43339374 } { \"_id\" : 3, address : \"2324 Pluto Place\", zipCode: NumberLong(3921412) } { \"_id\" : 4, address : \"55 Saturn Ring\" , zipCode : 88602117 }   通过多数据类型查询 该grades集合包含名称和平均数，其中 classAverage有string，int和double值：\n1 2 3 4 5 6 7 8  db.grades.insertMany( [ { \"_id\" : 1, name : \"Alice King\" , classAverage : 87.333333333333333 }, { \"_id\" : 2, name : \"Bob Jenkins\", classAverage : \"83.52\" }, { \"_id\" : 3, name : \"Cathy Hart\", classAverage: \"94.06\" }, { \"_id\" : 4, name : \"Drew Williams\" , classAverage : 93 } ] )   以下查询返回的所有文件，其中classAverage是 BSON类型string或double 或为含有指定类型的元素的数组。第一个查询使用数字别名，而第二个查询使用字符串别名。\n1 2  db.grades.find( { \"classAverage\" : { $type : [ 2 , 1 ] } } ); db.grades.find( { \"classAverage\" : { $type : [ \"string\" , \"double\" ] } } );   这些查询返回以下文档：\n1 2 3  { \"_id\" : 1, name : \"Alice King\" , classAverage : 87.333333333333333 } { \"_id\" : 2, name : \"Bob Jenkins\", classAverage : \"83.52\" } { \"_id\" : 3, name : \"Cathy Hart\", classAverage: \"94.06\" }   通过MinKey和MaxKey进行查询 该restaurants集合使用minKey代表不及格：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  { \"_id\": 1, \"address\": { \"building\": \"230\", \"coord\": [ -73.996089, 40.675018 ], \"street\": \"Huntington St\", \"zipcode\": \"11231\" }, \"borough\": \"Brooklyn\", \"cuisine\": \"Bakery\", \"grades\": [ { \"date\": new Date(1393804800000), \"grade\": \"C\", \"score\": 15 }, { \"date\": new Date(1378857600000), \"grade\": \"C\", \"score\": 16 }, { \"date\": new Date(1358985600000), \"grade\": MinKey(), \"score\": 30 }, { \"date\": new Date(1322006400000), \"grade\": \"C\", \"score\": 15 } ], \"name\": \"Dirty Dan's Donuts\", \"restaurant_id\": \"30075445\" }   而maxKey对于任何级别是最高的及格分数：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  { \"_id\": 2, \"address\": { \"building\": \"1166\", \"coord\": [ -73.955184, 40.738589 ], \"street\": \"Manhattan Ave\", \"zipcode\": \"11222\" }, \"borough\": \"Brooklyn\", \"cuisine\": \"Bakery\", \"grades\": [ { \"date\": new Date(1393804800000), \"grade\": MaxKey(), \"score\": 2 }, { \"date\": new Date(1378857600000), \"grade\": \"B\", \"score\": 6 }, { \"date\": new Date(1358985600000), \"grade\": MaxKey(), \"score\": 3 }, { \"date\": new Date(1322006400000), \"grade\": \"B\", \"score\": 5 } ], \"name\": \"Dainty Daisey's Donuts\", \"restaurant_id\": \"30075449\" }   以下查询返回其grades.grade字段包含minKey 或为包含指定类型的元素的数组的任何restaurant：\n1 2 3  db.restaurants.find( { \"grades.grade\" : { $type : \"minKey\" } } )   这返回\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  { \"_id\" : 1, \"address\" : { \"building\" : \"230\", \"coord\" : [ -73.996089, 40.675018 ], \"street\" : \"Huntington St\", \"zipcode\" : \"11231\" }, \"borough\" : \"Brooklyn\", \"cuisine\" : \"Bakery\", \"grades\" : [ { \"date\" : ISODate(\"2014-03-03T00:00:00Z\"), \"grade\" : \"C\", \"score\" : 15 }, { \"date\" : ISODate(\"2013-09-11T00:00:00Z\"), \"grade\" : \"C\", \"score\" : 16 }, { \"date\" : ISODate(\"2013-01-24T00:00:00Z\"), \"grade\" : { \"$minKey\" : 1 }, \"score\" : 30 }, { \"date\" : ISODate(\"2011-11-23T00:00:00Z\"), \"grade\" : \"C\", \"score\" : 15 } ], \"name\" : \"Dirty Dan's Donuts\", \"restaurant_id\" : \"30075445\" }   以下查询返回其grades.grade字段包含maxKey 或为包含指定类型的元素的数组的任何餐厅：\n1 2 3  db.restaurants.find( { \"grades.grade\" : { $type : \"maxKey\" } } )   这返回\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  { \"_id\" : 2, \"address\" : { \"building\" : \"1166\", \"coord\" : [ -73.955184, 40.738589 ], \"street\" : \"Manhattan Ave\", \"zipcode\" : \"11222\" }, \"borough\" : \"Brooklyn\", \"cuisine\" : \"Bakery\", \"grades\" : [ { \"date\" : ISODate(\"2014-03-03T00:00:00Z\"), \"grade\" : { \"$maxKey\" : 1 }, \"score\" : 2 }, { \"date\" : ISODate(\"2013-09-11T00:00:00Z\"), \"grade\" : \"B\", \"score\" : 6 }, { \"date\" : ISODate(\"2013-01-24T00:00:00Z\"), \"grade\" : { \"$maxKey\" : 1 }, \"score\" : 3 }, { \"date\" : ISODate(\"2011-11-23T00:00:00Z\"), \"grade\" : \"B\", \"score\" : 5 } ], \"name\" : \"Dainty Daisey's Donuts\", \"restaurant_id\" : \"30075449\" }   由数组类型查询 集合SensorReading包含以下文档：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  { \"_id\": 1, \"readings\": [ 25, 23, [ \"Warn: High Temp!\", 55 ], [ \"ERROR: SYSTEM SHUTDOWN!\", 66 ] ] }, { \"_id\": 2, \"readings\": [ 25, 25, 24, 23 ] }, { \"_id\": 3, \"readings\": [ 22, 24, [] ] }, { \"_id\": 4, \"readings\": [] }, { \"_id\": 5, \"readings\": 24 }   以下查询返回readings字段为空或非空数组的任何文档。\n1  db.SensorReading.find( { \"readings\" : { $type: \"array\" } } )   上面的查询返回以下文档：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  { \"_id\": 1, \"readings\": [ 25, 23, [ \"Warn: High Temp!\", 55 ], [ \"ERROR: SYSTEM SHUTDOWN!\", 66 ] ] }, { \"_id\": 2, \"readings\": [ 25, 25, 24, 23 ] }, { \"_id\": 3, \"readings\": [ 22, 24, [] ] }, { \"_id\": 4, \"readings\": [] }   在_id：1，_id：2，_id：3和_id：4的文档中，readings字段是一个数组。\n",
  "wordCount" : "3316",
  "inLanguage": "zh-cn",
  "datePublished": "2020-05-13T15:44:52Z",
  "dateModified": "2020-05-13T15:44:52Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/mongodb%E7%9A%84%E5%85%83%E7%B4%A0%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      MongoDB的元素查询运算符
    </h1>
    <div class="post-meta">May 13, 2020
</div>
  </header> 
  <div class="post-content"><h1 id="exists">$exists<a hidden class="anchor" aria-hidden="true" href="#exists">#</a></h1>
<p>语法：<code>{ field: { $exists: &lt;boolean&gt; } }</code></p>
<p>如果<code>&lt;boolean&gt;</code>为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果<code>&lt;boolean&gt;</code>为false，则查询仅返回不包含该字段的文档。</p>
<p>MongoDB的$exists并没有对应的SQL操作 exists。</p>
<h2 id="例子">例子<a hidden class="anchor" aria-hidden="true" href="#例子">#</a></h2>
<h3 id="存在且不等于">存在且不等于<a hidden class="anchor" aria-hidden="true" href="#存在且不等于">#</a></h3>
<p>考虑以下示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.inventory.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">qty</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">exists</span><span class="o">:</span> <span class="n">true</span><span class="p">,</span> <span class="o">$</span><span class="n">nin</span><span class="o">:</span> <span class="n">[</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span> <span class="n">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>该查询将选择inventory集合中该qty字段存在且其值不等于5或15的所有文档。</p>
<h3 id="空值">空值<a hidden class="anchor" aria-hidden="true" href="#空值">#</a></h3>
<p>以下示例使用以records以下文档命名的集合：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">a:</span> <span class="err">5,</span> <span class="err">b:</span> <span class="err">5,</span> <span class="err">c:</span> <span class="err">null</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">null,</span> <span class="err">c:</span> <span class="err">8</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">null,</span> <span class="err">b:</span> <span class="err">3,</span> <span class="err">c:</span> <span class="err">9</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">1,</span> <span class="err">b:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">3</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">5</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">2</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">4</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">b:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">4</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">b:</span> <span class="err">2</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">c:</span> <span class="err">6</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="exists-true">$exists: true<a hidden class="anchor" aria-hidden="true" href="#exists-true">#</a></h3>
<p>以下查询指定查询：<code>a: { $exists: true }</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.records.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">a</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">exists</span><span class="o">:</span> <span class="n">true</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>结果由包含字段a的文档组成，包括其字段a包含空值的文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">a:</span> <span class="err">5,</span> <span class="err">b:</span> <span class="err">5,</span> <span class="err">c:</span> <span class="err">null</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">null,</span> <span class="err">c:</span> <span class="err">8</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">null,</span> <span class="err">b:</span> <span class="err">3,</span> <span class="err">c:</span> <span class="err">9</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">1,</span> <span class="err">b:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">3</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">5</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">2</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">4</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="exists-false">$exists: false<a hidden class="anchor" aria-hidden="true" href="#exists-false">#</a></h3>
<p>以下查询指定查询：b: { $exists: false }</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.records.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">b</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">exists</span><span class="o">:</span> <span class="n">false</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>结果由不包含该字段的那些文档组成 b：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">a:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">5</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">4</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">c:</span> <span class="err">6</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="type">$type<a hidden class="anchor" aria-hidden="true" href="#type">#</a></h1>
<p>$type选择文档，其中字段的值是指定BSON类型的实例。在处理数据类型不可预测的高度非结构化数据时，按数据类型查询很有用。</p>
<p>$type单个表达BSON类型的语法如下：</p>
<p>在版本3.2中更改。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">field:</span> <span class="err">{</span> <span class="err">$type:</span> <span class="err">&lt;BSON</span> <span class="err">type&gt;</span> <span class="p">}</span> <span class="err">}</span>
</code></pre></td></tr></table>
</div>
</div><p>您可以为BSON类型指定数字或别名</p>
<p>该$type表达式还可以接受BSON类型的数组，并具有以下语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">field:</span> <span class="err">{</span> <span class="err">$type:</span> <span class="err">[</span> <span class="err">&lt;BSON</span> <span class="err">type1&gt;</span> <span class="err">,</span> <span class="err">&lt;BSON</span> <span class="err">type2&gt;,</span> <span class="err">...</span> <span class="err">]</span> <span class="p">}</span> <span class="err">}</span>
</code></pre></td></tr></table>
</div>
</div><p>上面的查询将匹配field值是任何列出的类型的文档。数组中指定的类型可以是数字或字符串别名。</p>
<p>有关示例，请参见按多种数据类型查询。</p>
<p>可用类型描述BSON类型及其对应的数字和字符串别名。</p>
<h2 id="特性">特性<a hidden class="anchor" aria-hidden="true" href="#特性">#</a></h2>
<p>$type返回字段的BSON类型与传递给$type的BSON类型匹配的文档。</p>
<h3 id="数组">数组<a hidden class="anchor" aria-hidden="true" href="#数组">#</a></h3>
<p>对于其中field是数组的文档，$ type返回的文档中至少有一个array元素与传递给$ type的类型匹配。</p>
<h4 id="查询数组bson类型">查询数组BSON类型<a hidden class="anchor" aria-hidden="true" href="#查询数组bson类型">#</a></h4>
<p>在MongoDB 3.6和更高版本中，查询$type：“array”会返回文档，其中字段本身是数组。在MongoDB 3.6之前，$type：“array”返回文档，其中该字段是一个包含至少一个type类型元素的数组。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;data&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;values&#34;</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&#34;values&#34;</span> <span class="p">]</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;data&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;values&#34;</span> <span class="p">]</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>在MongoDB 3.6和更高版本中，<code>find( {&quot;data&quot; : { $type : &quot;array&quot; } } )</code>查询将返回两个文档。在MongoDB 3.6之前，查询仅返回第一个文档。</p>
<h3 id="可用类型">可用类型<a hidden class="anchor" aria-hidden="true" href="#可用类型">#</a></h3>
<p>从MongoDB 3.2开始，$type除了接受与BSON类型相对应的数字外，还接受BSON类型的字符串别名。以前的版本仅接受与BSON类型相对应的数字。</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Number</th>
<th>Alias</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Double</td>
<td>1</td>
<td>“double”</td>
<td></td>
</tr>
<tr>
<td>String</td>
<td>2</td>
<td>“string”</td>
<td></td>
</tr>
<tr>
<td>Object</td>
<td>3</td>
<td>“object”</td>
<td></td>
</tr>
<tr>
<td>Array</td>
<td>4</td>
<td>“array”</td>
<td></td>
</tr>
<tr>
<td>Binary data</td>
<td>5</td>
<td>“binData”</td>
<td></td>
</tr>
<tr>
<td>Undefined</td>
<td>6</td>
<td>“undefined”</td>
<td>Deprecated.</td>
</tr>
<tr>
<td>ObjectId</td>
<td>7</td>
<td>“objectId”</td>
<td></td>
</tr>
<tr>
<td>Boolean</td>
<td>8</td>
<td>“bool”</td>
<td></td>
</tr>
<tr>
<td>Date</td>
<td>9</td>
<td>“date”</td>
<td></td>
</tr>
<tr>
<td>Null</td>
<td>10</td>
<td>“null”</td>
<td></td>
</tr>
<tr>
<td>Regular Expression</td>
<td>11</td>
<td>“regex”</td>
<td></td>
</tr>
<tr>
<td>DBPointer</td>
<td>12</td>
<td>“dbPointer”</td>
<td>Deprecated.</td>
</tr>
<tr>
<td>JavaScript</td>
<td>13</td>
<td>“javascript”</td>
<td></td>
</tr>
<tr>
<td>Symbol</td>
<td>14</td>
<td>“symbol”</td>
<td>Deprecated.</td>
</tr>
<tr>
<td>JavaScript (with scope)</td>
<td>15</td>
<td>“javascriptWithScope”</td>
<td></td>
</tr>
<tr>
<td>32-bit integer</td>
<td>16</td>
<td>“int”</td>
<td></td>
</tr>
<tr>
<td>Timestamp</td>
<td>17</td>
<td>“timestamp”</td>
<td></td>
</tr>
<tr>
<td>64-bit integer</td>
<td>18</td>
<td>“long”</td>
<td></td>
</tr>
<tr>
<td>Decimal128</td>
<td>19</td>
<td>“decimal”</td>
<td>New in version 3.4.</td>
</tr>
<tr>
<td>Min key</td>
<td>-1</td>
<td>“minKey”</td>
<td></td>
</tr>
<tr>
<td>Max key</td>
<td>127</td>
<td>“maxKey”</td>
<td></td>
</tr>
</tbody>
</table>
<p>$type支持number别名，它将与以下BSON类型匹配：</p>
<ul>
<li>double</li>
<li>32-bit integer</li>
<li>64-bit integer</li>
<li>decimal</li>
</ul>
<h3 id="minkey和maxkey">MinKey和MaxKey<a hidden class="anchor" aria-hidden="true" href="#minkey和maxkey">#</a></h3>
<p>MinKey和 MaxKey 用于比较操作，主要用于内部使用。对于所有可能的BSON元素值，MinKey将始终为最小值，而MaxKey始终为最大值。</p>
<p>使用$type查询minKey或maxKey 只会返回与特殊MinKey或MaxKey值匹配的字段。</p>
<p>假设该data集合有两个文档，MinKey并且具有和MaxKey：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="err">x</span> <span class="err">:</span> <span class="err">{</span> <span class="nt">&#34;$minKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="err">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="err">y</span> <span class="err">:</span> <span class="err">{</span> <span class="nt">&#34;$maxKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="err">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询将返回带有以下内容的文档：_id: 1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.data.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span><span class="o">:</span> <span class="s">&#34;minKey&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询将返回带有以下内容的文档：_id: 2</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.data.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">y</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span><span class="o">:</span> <span class="s">&#34;maxKey&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="例子-1">例子<a hidden class="anchor" aria-hidden="true" href="#例子-1">#</a></h3>
<h4 id="按数据类型查询">按数据类型查询<a hidden class="anchor" aria-hidden="true" href="#按数据类型查询">#</a></h4>
<p>在addressBook包含地址和邮编，在那里 zipCode有string，int，double，和long 值：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.addressBook.insertMany</span><span class="p">(</span>
   <span class="n">[</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">1</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;2030 Martian Way&#34;</span><span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="s">&#34;90698345&#34;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">2</span><span class="p">,</span> <span class="n">address</span><span class="o">:</span> <span class="s">&#34;156 Lunar Place&#34;</span><span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="m">43339374</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">3</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;2324 Pluto Place&#34;</span><span class="p">,</span> <span class="n">zipCode</span><span class="o">:</span> <span class="nf">NumberLong</span><span class="p">(</span><span class="m">3921412</span><span class="p">)</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">4</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;55 Saturn Ring&#34;</span> <span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="nf">NumberInt</span><span class="p">(</span><span class="m">88602117</span><span class="p">)</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">5</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;104 Venus Drive&#34;</span><span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="n">[</span><span class="s">&#34;834847278&#34;</span><span class="p">,</span> <span class="s">&#34;1893289032&#34;</span><span class="n">]</span><span class="p">}</span>
   <span class="n">]</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回的所有文件，其中zipCode是 BSON类型string 或为含有指定的类型的元素的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="m">2</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
<span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="s">&#34;string&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="s2">&#34;2030 Martian Way&#34;</span><span class="p">,</span> <span class="nt">&#34;zipCode&#34;</span> <span class="p">:</span> <span class="s2">&#34;90698345&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;104 Venus Drive&#34;</span><span class="p">,</span> <span class="err">zipCOde</span> <span class="err">:</span> <span class="err">[</span><span class="nt">&#34;834847278&#34;</span><span class="p">,</span> <span class="nt">&#34;1893289032&#34;</span><span class="err">]</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回的所有文件，其中zipCode是 BSON类型double 或为含有指定的类型的元素的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="m">1</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
<span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="s">&#34;double&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="s2">&#34;156 Lunar Place&#34;</span><span class="p">,</span> <span class="nt">&#34;zip&#34;</span> <span class="p">:</span> <span class="mi">43339374</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询使用的number别名返回文档，其中 zipCode是BSON类型double，int或long 或者是包含指定类型的元素的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">db.addressBook.find( { &#34;zipCode&#34; : { $type : &#34;number&#34; } } )
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;156 Lunar Place&#34;</span><span class="p">,</span> <span class="err">zipCode</span> <span class="err">:</span> <span class="err">43339374</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;2324 Pluto Place&#34;</span><span class="p">,</span> <span class="err">zipCode:</span> <span class="err">NumberLong(3921412)</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;55 Saturn Ring&#34;</span> <span class="p">,</span> <span class="err">zipCode</span> <span class="err">:</span> <span class="err">88602117</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="通过多数据类型查询">通过多数据类型查询<a hidden class="anchor" aria-hidden="true" href="#通过多数据类型查询">#</a></h4>
<p>该grades集合包含名称和平均数，其中 classAverage有string，int和double值：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.grades.insertMany</span><span class="p">(</span>
   <span class="n">[</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">1</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Alice King&#34;</span> <span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="m">87.333333333333333</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">2</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Bob Jenkins&#34;</span><span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="s">&#34;83.52&#34;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">3</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Cathy Hart&#34;</span><span class="p">,</span> <span class="n">classAverage</span><span class="o">:</span> <span class="s">&#34;94.06&#34;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">4</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Drew Williams&#34;</span> <span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="m">93</span> <span class="p">}</span>
   <span class="n">]</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回的所有文件，其中classAverage是 BSON类型string或double 或为含有指定类型的元素的数组。第一个查询使用数字别名，而第二个查询使用字符串别名。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.grades.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;classAverage&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="n">[</span> <span class="m">2</span> <span class="p">,</span> <span class="m">1</span> <span class="n">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
<span class="nf">db.grades.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;classAverage&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="n">[</span> <span class="s">&#34;string&#34;</span> <span class="p">,</span> <span class="s">&#34;double&#34;</span> <span class="n">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回以下文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">1</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Alice King&#34;</span> <span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="m">87.333333333333333</span> <span class="p">}</span>
<span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">2</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Bob Jenkins&#34;</span><span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="s">&#34;83.52&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">3</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Cathy Hart&#34;</span><span class="p">,</span> <span class="n">classAverage</span><span class="o">:</span> <span class="s">&#34;94.06&#34;</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="通过minkey和maxkey进行查询">通过MinKey和MaxKey进行查询<a hidden class="anchor" aria-hidden="true" href="#通过minkey和maxkey进行查询">#</a></h3>
<p>该restaurants集合使用minKey代表不及格：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span><span class="p">:</span> <span class="s2">&#34;230&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">-73.996089</span><span class="p">,</span> <span class="mf">40.675018</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span><span class="p">:</span> <span class="s2">&#34;Huntington St&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;11231&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span><span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span><span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1393804800000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">15</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1378857600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">16</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1358985600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="err">MinKey()</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">30</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1322006400000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">15</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Dirty Dan&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span><span class="p">:</span> <span class="s2">&#34;30075445&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>而maxKey对于任何级别是最高的及格分数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span><span class="p">:</span> <span class="s2">&#34;1166&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">-73.955184</span><span class="p">,</span> <span class="mf">40.738589</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span><span class="p">:</span> <span class="s2">&#34;Manhattan Ave&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;11222&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span><span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span><span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1393804800000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="err">MaxKey()</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1378857600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">6</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1358985600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="err">MaxKey()</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">3</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1322006400000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Dainty Daisey&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span><span class="p">:</span> <span class="s2">&#34;30075449&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回其grades.grade字段包含minKey 或为包含指定类型的元素的数组的任何restaurant：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">db.restaurants.find<span class="o">(</span>
   <span class="o">{</span> <span class="s2">&#34;grades.grade&#34;</span> : <span class="o">{</span> <span class="nv">$type</span> : <span class="s2">&#34;minKey&#34;</span> <span class="o">}</span> <span class="o">}</span>
<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>这返回</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span> <span class="p">:</span> <span class="s2">&#34;230&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="mf">-73.996089</span><span class="p">,</span> <span class="mf">40.675018</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span> <span class="p">:</span> <span class="s2">&#34;Huntington St&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span> <span class="p">:</span> <span class="s2">&#34;11231&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span> <span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span> <span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2014-03-03T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">15</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-09-11T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">16</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-01-24T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$minKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">30</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2011-11-23T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">15</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;Dirty Dan&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;30075445&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回其grades.grade字段包含maxKey 或为包含指定类型的元素的数组的任何餐厅：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.restaurants.find</span><span class="p">(</span>
   <span class="p">{</span> <span class="s">&#34;grades.grade&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="s">&#34;maxKey&#34;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>这返回</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span> <span class="p">:</span> <span class="s2">&#34;1166&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="mf">-73.955184</span><span class="p">,</span> <span class="mf">40.738589</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span> <span class="p">:</span> <span class="s2">&#34;Manhattan Ave&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span> <span class="p">:</span> <span class="s2">&#34;11222&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span> <span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span> <span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2014-03-03T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$maxKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-09-11T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">6</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-01-24T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$maxKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2011-11-23T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;Dainty Daisey&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;30075449&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="由数组类型查询">由数组类型查询<a hidden class="anchor" aria-hidden="true" href="#由数组类型查询">#</a></h2>
<p>集合SensorReading包含以下文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">23</span><span class="p">,</span>
      <span class="p">[</span> <span class="s2">&#34;Warn: High Temp!&#34;</span><span class="p">,</span> <span class="mi">55</span> <span class="p">],</span>
      <span class="p">[</span> <span class="s2">&#34;ERROR: SYSTEM SHUTDOWN!&#34;</span><span class="p">,</span> <span class="mi">66</span> <span class="p">]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="mi">23</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">22</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="p">[]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="mi">24</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回readings字段为空或非空数组的任何文档。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.SensorReading.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;readings&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span><span class="o">:</span> <span class="s">&#34;array&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>上面的查询返回以下文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">23</span><span class="p">,</span>
      <span class="p">[</span> <span class="s2">&#34;Warn: High Temp!&#34;</span><span class="p">,</span> <span class="mi">55</span> <span class="p">],</span>
      <span class="p">[</span> <span class="s2">&#34;ERROR: SYSTEM SHUTDOWN!&#34;</span><span class="p">,</span> <span class="mi">66</span> <span class="p">]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="mi">23</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">22</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="p">[]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>在_id：1，_id：2，_id：3和_id：4的文档中，readings字段是一个数组。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/mongodb/">MongoDB</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
