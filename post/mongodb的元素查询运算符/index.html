<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MongoDB的元素查询运算符 - Forz Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Forz" /><meta name="description" content="$exists 语法：{ field: { $exists: &amp;lt;boolean&amp;gt; } } 如果&amp;lt;boolean&amp;gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果&amp;" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.87.0 with theme even" />


<link rel="canonical" href="/post/mongodb%E7%9A%84%E5%85%83%E7%B4%A0%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="MongoDB的元素查询运算符" />
<meta property="og:description" content="$exists 语法：{ field: { $exists: &lt;boolean&gt; } } 如果&lt;boolean&gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果&" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/mongodb%E7%9A%84%E5%85%83%E7%B4%A0%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-05-13T15:44:52+00:00" />
<meta property="article:modified_time" content="2020-05-13T15:44:52+00:00" />

<meta itemprop="name" content="MongoDB的元素查询运算符">
<meta itemprop="description" content="$exists 语法：{ field: { $exists: &lt;boolean&gt; } } 如果&lt;boolean&gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果&"><meta itemprop="datePublished" content="2020-05-13T15:44:52+00:00" />
<meta itemprop="dateModified" content="2020-05-13T15:44:52+00:00" />
<meta itemprop="wordCount" content="3316">
<meta itemprop="keywords" content="MongoDB," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MongoDB的元素查询运算符"/>
<meta name="twitter:description" content="$exists 语法：{ field: { $exists: &lt;boolean&gt; } } 如果&lt;boolean&gt;为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果&"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Forz Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Forz Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">MongoDB的元素查询运算符</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-05-13 </span>
        <div class="post-category">
            <a href="/categories/mongodb/"> MongoDB </a>
            </div>
          <span class="more-meta"> 约 3316 字 </span>
          <span class="more-meta"> 预计阅读 7 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#例子">例子</a>
      <ul>
        <li><a href="#存在且不等于">存在且不等于</a></li>
        <li><a href="#空值">空值</a></li>
        <li><a href="#exists-true">$exists: true</a></li>
        <li><a href="#exists-false">$exists: false</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#特性">特性</a>
      <ul>
        <li><a href="#数组">数组</a></li>
        <li><a href="#可用类型">可用类型</a></li>
        <li><a href="#minkey和maxkey">MinKey和MaxKey</a></li>
        <li><a href="#例子-1">例子</a></li>
        <li><a href="#通过minkey和maxkey进行查询">通过MinKey和MaxKey进行查询</a></li>
      </ul>
    </li>
    <li><a href="#由数组类型查询">由数组类型查询</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="exists">$exists</h1>
<p>语法：<code>{ field: { $exists: &lt;boolean&gt; } }</code></p>
<p>如果<code>&lt;boolean&gt;</code>为true，则$exists匹配包含该字段的文档，包括字段值为的文档 null。如果<code>&lt;boolean&gt;</code>为false，则查询仅返回不包含该字段的文档。</p>
<p>MongoDB的$exists并没有对应的SQL操作 exists。</p>
<h2 id="例子">例子</h2>
<h3 id="存在且不等于">存在且不等于</h3>
<p>考虑以下示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.inventory.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">qty</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">exists</span><span class="o">:</span> <span class="n">true</span><span class="p">,</span> <span class="o">$</span><span class="n">nin</span><span class="o">:</span> <span class="n">[</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span> <span class="n">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>该查询将选择inventory集合中该qty字段存在且其值不等于5或15的所有文档。</p>
<h3 id="空值">空值</h3>
<p>以下示例使用以records以下文档命名的集合：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">a:</span> <span class="err">5,</span> <span class="err">b:</span> <span class="err">5,</span> <span class="err">c:</span> <span class="err">null</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">null,</span> <span class="err">c:</span> <span class="err">8</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">null,</span> <span class="err">b:</span> <span class="err">3,</span> <span class="err">c:</span> <span class="err">9</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">1,</span> <span class="err">b:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">3</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">5</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">2</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">4</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">b:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">4</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">b:</span> <span class="err">2</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">c:</span> <span class="err">6</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="exists-true">$exists: true</h3>
<p>以下查询指定查询：<code>a: { $exists: true }</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.records.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">a</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">exists</span><span class="o">:</span> <span class="n">true</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>结果由包含字段a的文档组成，包括其字段a包含空值的文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">a:</span> <span class="err">5,</span> <span class="err">b:</span> <span class="err">5,</span> <span class="err">c:</span> <span class="err">null</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">null,</span> <span class="err">c:</span> <span class="err">8</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">null,</span> <span class="err">b:</span> <span class="err">3,</span> <span class="err">c:</span> <span class="err">9</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">1,</span> <span class="err">b:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">3</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">5</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">3,</span> <span class="err">b:</span> <span class="err">2</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">4</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="exists-false">$exists: false</h3>
<p>以下查询指定查询：b: { $exists: false }</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.records.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">b</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">exists</span><span class="o">:</span> <span class="n">false</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>结果由不包含该字段的那些文档组成 b：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">a:</span> <span class="err">2,</span> <span class="err">c:</span> <span class="err">5</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">a:</span> <span class="err">4</span> <span class="p">}</span>
<span class="p">{</span> <span class="err">c:</span> <span class="err">6</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="type">$type</h1>
<p>$type选择文档，其中字段的值是指定BSON类型的实例。在处理数据类型不可预测的高度非结构化数据时，按数据类型查询很有用。</p>
<p>$type单个表达BSON类型的语法如下：</p>
<p>在版本3.2中更改。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">field:</span> <span class="err">{</span> <span class="err">$type:</span> <span class="err">&lt;BSON</span> <span class="err">type&gt;</span> <span class="p">}</span> <span class="err">}</span>
</code></pre></td></tr></table>
</div>
</div><p>您可以为BSON类型指定数字或别名</p>
<p>该$type表达式还可以接受BSON类型的数组，并具有以下语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="err">field:</span> <span class="err">{</span> <span class="err">$type:</span> <span class="err">[</span> <span class="err">&lt;BSON</span> <span class="err">type1&gt;</span> <span class="err">,</span> <span class="err">&lt;BSON</span> <span class="err">type2&gt;,</span> <span class="err">...</span> <span class="err">]</span> <span class="p">}</span> <span class="err">}</span>
</code></pre></td></tr></table>
</div>
</div><p>上面的查询将匹配field值是任何列出的类型的文档。数组中指定的类型可以是数字或字符串别名。</p>
<p>有关示例，请参见按多种数据类型查询。</p>
<p>可用类型描述BSON类型及其对应的数字和字符串别名。</p>
<h2 id="特性">特性</h2>
<p>$type返回字段的BSON类型与传递给$type的BSON类型匹配的文档。</p>
<h3 id="数组">数组</h3>
<p>对于其中field是数组的文档，$ type返回的文档中至少有一个array元素与传递给$ type的类型匹配。</p>
<h4 id="查询数组bson类型">查询数组BSON类型</h4>
<p>在MongoDB 3.6和更高版本中，查询$type：“array”会返回文档，其中字段本身是数组。在MongoDB 3.6之前，$type：“array”返回文档，其中该字段是一个包含至少一个type类型元素的数组。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;data&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;values&#34;</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&#34;values&#34;</span> <span class="p">]</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;data&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;values&#34;</span> <span class="p">]</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>在MongoDB 3.6和更高版本中，<code>find( {&quot;data&quot; : { $type : &quot;array&quot; } } )</code>查询将返回两个文档。在MongoDB 3.6之前，查询仅返回第一个文档。</p>
<h3 id="可用类型">可用类型</h3>
<p>从MongoDB 3.2开始，$type除了接受与BSON类型相对应的数字外，还接受BSON类型的字符串别名。以前的版本仅接受与BSON类型相对应的数字。</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Number</th>
<th>Alias</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Double</td>
<td>1</td>
<td>“double”</td>
<td></td>
</tr>
<tr>
<td>String</td>
<td>2</td>
<td>“string”</td>
<td></td>
</tr>
<tr>
<td>Object</td>
<td>3</td>
<td>“object”</td>
<td></td>
</tr>
<tr>
<td>Array</td>
<td>4</td>
<td>“array”</td>
<td></td>
</tr>
<tr>
<td>Binary data</td>
<td>5</td>
<td>“binData”</td>
<td></td>
</tr>
<tr>
<td>Undefined</td>
<td>6</td>
<td>“undefined”</td>
<td>Deprecated.</td>
</tr>
<tr>
<td>ObjectId</td>
<td>7</td>
<td>“objectId”</td>
<td></td>
</tr>
<tr>
<td>Boolean</td>
<td>8</td>
<td>“bool”</td>
<td></td>
</tr>
<tr>
<td>Date</td>
<td>9</td>
<td>“date”</td>
<td></td>
</tr>
<tr>
<td>Null</td>
<td>10</td>
<td>“null”</td>
<td></td>
</tr>
<tr>
<td>Regular Expression</td>
<td>11</td>
<td>“regex”</td>
<td></td>
</tr>
<tr>
<td>DBPointer</td>
<td>12</td>
<td>“dbPointer”</td>
<td>Deprecated.</td>
</tr>
<tr>
<td>JavaScript</td>
<td>13</td>
<td>“javascript”</td>
<td></td>
</tr>
<tr>
<td>Symbol</td>
<td>14</td>
<td>“symbol”</td>
<td>Deprecated.</td>
</tr>
<tr>
<td>JavaScript (with scope)</td>
<td>15</td>
<td>“javascriptWithScope”</td>
<td></td>
</tr>
<tr>
<td>32-bit integer</td>
<td>16</td>
<td>“int”</td>
<td></td>
</tr>
<tr>
<td>Timestamp</td>
<td>17</td>
<td>“timestamp”</td>
<td></td>
</tr>
<tr>
<td>64-bit integer</td>
<td>18</td>
<td>“long”</td>
<td></td>
</tr>
<tr>
<td>Decimal128</td>
<td>19</td>
<td>“decimal”</td>
<td>New in version 3.4.</td>
</tr>
<tr>
<td>Min key</td>
<td>-1</td>
<td>“minKey”</td>
<td></td>
</tr>
<tr>
<td>Max key</td>
<td>127</td>
<td>“maxKey”</td>
<td></td>
</tr>
</tbody>
</table>
<p>$type支持number别名，它将与以下BSON类型匹配：</p>
<ul>
<li>double</li>
<li>32-bit integer</li>
<li>64-bit integer</li>
<li>decimal</li>
</ul>
<h3 id="minkey和maxkey">MinKey和MaxKey</h3>
<p>MinKey和 MaxKey 用于比较操作，主要用于内部使用。对于所有可能的BSON元素值，MinKey将始终为最小值，而MaxKey始终为最大值。</p>
<p>使用$type查询minKey或maxKey 只会返回与特殊MinKey或MaxKey值匹配的字段。</p>
<p>假设该data集合有两个文档，MinKey并且具有和MaxKey：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="err">x</span> <span class="err">:</span> <span class="err">{</span> <span class="nt">&#34;$minKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="err">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="err">y</span> <span class="err">:</span> <span class="err">{</span> <span class="nt">&#34;$maxKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="err">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询将返回带有以下内容的文档：_id: 1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.data.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span><span class="o">:</span> <span class="s">&#34;minKey&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询将返回带有以下内容的文档：_id: 2</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.data.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">y</span><span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span><span class="o">:</span> <span class="s">&#34;maxKey&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="例子-1">例子</h3>
<h4 id="按数据类型查询">按数据类型查询</h4>
<p>在addressBook包含地址和邮编，在那里 zipCode有string，int，double，和long 值：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.addressBook.insertMany</span><span class="p">(</span>
   <span class="n">[</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">1</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;2030 Martian Way&#34;</span><span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="s">&#34;90698345&#34;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">2</span><span class="p">,</span> <span class="n">address</span><span class="o">:</span> <span class="s">&#34;156 Lunar Place&#34;</span><span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="m">43339374</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">3</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;2324 Pluto Place&#34;</span><span class="p">,</span> <span class="n">zipCode</span><span class="o">:</span> <span class="nf">NumberLong</span><span class="p">(</span><span class="m">3921412</span><span class="p">)</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">4</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;55 Saturn Ring&#34;</span> <span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="nf">NumberInt</span><span class="p">(</span><span class="m">88602117</span><span class="p">)</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">5</span><span class="p">,</span> <span class="n">address</span> <span class="o">:</span> <span class="s">&#34;104 Venus Drive&#34;</span><span class="p">,</span> <span class="n">zipCode</span> <span class="o">:</span> <span class="n">[</span><span class="s">&#34;834847278&#34;</span><span class="p">,</span> <span class="s">&#34;1893289032&#34;</span><span class="n">]</span><span class="p">}</span>
   <span class="n">]</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回的所有文件，其中zipCode是 BSON类型string 或为含有指定的类型的元素的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="m">2</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
<span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="s">&#34;string&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="s2">&#34;2030 Martian Way&#34;</span><span class="p">,</span> <span class="nt">&#34;zipCode&#34;</span> <span class="p">:</span> <span class="s2">&#34;90698345&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;104 Venus Drive&#34;</span><span class="p">,</span> <span class="err">zipCOde</span> <span class="err">:</span> <span class="err">[</span><span class="nt">&#34;834847278&#34;</span><span class="p">,</span> <span class="nt">&#34;1893289032&#34;</span><span class="err">]</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回的所有文件，其中zipCode是 BSON类型double 或为含有指定的类型的元素的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="m">1</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
<span class="nf">db.addressBook.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;zipCode&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="s">&#34;double&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="s2">&#34;156 Lunar Place&#34;</span><span class="p">,</span> <span class="nt">&#34;zip&#34;</span> <span class="p">:</span> <span class="mi">43339374</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询使用的number别名返回文档，其中 zipCode是BSON类型double，int或long 或者是包含指定类型的元素的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">db.addressBook.find( { &#34;zipCode&#34; : { $type : &#34;number&#34; } } )
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;156 Lunar Place&#34;</span><span class="p">,</span> <span class="err">zipCode</span> <span class="err">:</span> <span class="err">43339374</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;2324 Pluto Place&#34;</span><span class="p">,</span> <span class="err">zipCode:</span> <span class="err">NumberLong(3921412)</span> <span class="p">}</span>
<span class="p">{</span> <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="err">address</span> <span class="err">:</span> <span class="nt">&#34;55 Saturn Ring&#34;</span> <span class="p">,</span> <span class="err">zipCode</span> <span class="err">:</span> <span class="err">88602117</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="通过多数据类型查询">通过多数据类型查询</h4>
<p>该grades集合包含名称和平均数，其中 classAverage有string，int和double值：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.grades.insertMany</span><span class="p">(</span>
   <span class="n">[</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">1</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Alice King&#34;</span> <span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="m">87.333333333333333</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">2</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Bob Jenkins&#34;</span><span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="s">&#34;83.52&#34;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">3</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Cathy Hart&#34;</span><span class="p">,</span> <span class="n">classAverage</span><span class="o">:</span> <span class="s">&#34;94.06&#34;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">4</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Drew Williams&#34;</span> <span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="m">93</span> <span class="p">}</span>
   <span class="n">]</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回的所有文件，其中classAverage是 BSON类型string或double 或为含有指定类型的元素的数组。第一个查询使用数字别名，而第二个查询使用字符串别名。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.grades.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;classAverage&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="n">[</span> <span class="m">2</span> <span class="p">,</span> <span class="m">1</span> <span class="n">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
<span class="nf">db.grades.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;classAverage&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="n">[</span> <span class="s">&#34;string&#34;</span> <span class="p">,</span> <span class="s">&#34;double&#34;</span> <span class="n">]</span> <span class="p">}</span> <span class="p">}</span> <span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>这些查询返回以下文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">1</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Alice King&#34;</span> <span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="m">87.333333333333333</span> <span class="p">}</span>
<span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">2</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Bob Jenkins&#34;</span><span class="p">,</span> <span class="n">classAverage</span> <span class="o">:</span> <span class="s">&#34;83.52&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s">&#34;_id&#34;</span> <span class="o">:</span> <span class="m">3</span><span class="p">,</span> <span class="n">name</span> <span class="o">:</span> <span class="s">&#34;Cathy Hart&#34;</span><span class="p">,</span> <span class="n">classAverage</span><span class="o">:</span> <span class="s">&#34;94.06&#34;</span> <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="通过minkey和maxkey进行查询">通过MinKey和MaxKey进行查询</h3>
<p>该restaurants集合使用minKey代表不及格：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span><span class="p">:</span> <span class="s2">&#34;230&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">-73.996089</span><span class="p">,</span> <span class="mf">40.675018</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span><span class="p">:</span> <span class="s2">&#34;Huntington St&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;11231&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span><span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span><span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1393804800000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">15</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1378857600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">16</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1358985600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="err">MinKey()</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">30</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1322006400000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">15</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Dirty Dan&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span><span class="p">:</span> <span class="s2">&#34;30075445&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>而maxKey对于任何级别是最高的及格分数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span><span class="p">:</span> <span class="s2">&#34;1166&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">-73.955184</span><span class="p">,</span> <span class="mf">40.738589</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span><span class="p">:</span> <span class="s2">&#34;Manhattan Ave&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span><span class="p">:</span> <span class="s2">&#34;11222&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span><span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span><span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1393804800000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="err">MaxKey()</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1378857600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">6</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1358985600000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="err">MaxKey()</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">3</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span><span class="p">:</span> <span class="err">new</span> <span class="err">Date(</span><span class="mi">1322006400000</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span><span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Dainty Daisey&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span><span class="p">:</span> <span class="s2">&#34;30075449&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回其grades.grade字段包含minKey 或为包含指定类型的元素的数组的任何restaurant：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">db.restaurants.find<span class="o">(</span>
   <span class="o">{</span> <span class="s2">&#34;grades.grade&#34;</span> : <span class="o">{</span> <span class="nv">$type</span> : <span class="s2">&#34;minKey&#34;</span> <span class="o">}</span> <span class="o">}</span>
<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>这返回</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span> <span class="p">:</span> <span class="s2">&#34;230&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="mf">-73.996089</span><span class="p">,</span> <span class="mf">40.675018</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span> <span class="p">:</span> <span class="s2">&#34;Huntington St&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span> <span class="p">:</span> <span class="s2">&#34;11231&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span> <span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span> <span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2014-03-03T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">15</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-09-11T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">16</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-01-24T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$minKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">30</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2011-11-23T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;C&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">15</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;Dirty Dan&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;30075445&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回其grades.grade字段包含maxKey 或为包含指定类型的元素的数组的任何餐厅：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.restaurants.find</span><span class="p">(</span>
   <span class="p">{</span> <span class="s">&#34;grades.grade&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span> <span class="o">:</span> <span class="s">&#34;maxKey&#34;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>这返回</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;address&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;building&#34;</span> <span class="p">:</span> <span class="s2">&#34;1166&#34;</span><span class="p">,</span>
      <span class="nt">&#34;coord&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="mf">-73.955184</span><span class="p">,</span> <span class="mf">40.738589</span> <span class="p">],</span>
      <span class="nt">&#34;street&#34;</span> <span class="p">:</span> <span class="s2">&#34;Manhattan Ave&#34;</span><span class="p">,</span>
      <span class="nt">&#34;zipcode&#34;</span> <span class="p">:</span> <span class="s2">&#34;11222&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;borough&#34;</span> <span class="p">:</span> <span class="s2">&#34;Brooklyn&#34;</span><span class="p">,</span>
   <span class="nt">&#34;cuisine&#34;</span> <span class="p">:</span> <span class="s2">&#34;Bakery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;grades&#34;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2014-03-03T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$maxKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-09-11T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">6</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2013-01-24T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$maxKey&#34;</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">3</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nt">&#34;date&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2011-11-23T00:00:00Z&#34;</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;grade&#34;</span> <span class="p">:</span> <span class="s2">&#34;B&#34;</span><span class="p">,</span> <span class="nt">&#34;score&#34;</span> <span class="p">:</span> <span class="mi">5</span> <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;Dainty Daisey&#39;s Donuts&#34;</span><span class="p">,</span>
   <span class="nt">&#34;restaurant_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;30075449&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="由数组类型查询">由数组类型查询</h2>
<p>集合SensorReading包含以下文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">23</span><span class="p">,</span>
      <span class="p">[</span> <span class="s2">&#34;Warn: High Temp!&#34;</span><span class="p">,</span> <span class="mi">55</span> <span class="p">],</span>
      <span class="p">[</span> <span class="s2">&#34;ERROR: SYSTEM SHUTDOWN!&#34;</span><span class="p">,</span> <span class="mi">66</span> <span class="p">]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="mi">23</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">22</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="p">[]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="mi">24</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下查询返回readings字段为空或非空数组的任何文档。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.SensorReading.find</span><span class="p">(</span> <span class="p">{</span> <span class="s">&#34;readings&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="o">$</span><span class="n">type</span><span class="o">:</span> <span class="s">&#34;array&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>上面的查询返回以下文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">23</span><span class="p">,</span>
      <span class="p">[</span> <span class="s2">&#34;Warn: High Temp!&#34;</span><span class="p">,</span> <span class="mi">55</span> <span class="p">],</span>
      <span class="p">[</span> <span class="s2">&#34;ERROR: SYSTEM SHUTDOWN!&#34;</span><span class="p">,</span> <span class="mi">66</span> <span class="p">]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">25</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="mi">23</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="mi">22</span><span class="p">,</span>
      <span class="mi">24</span><span class="p">,</span>
      <span class="p">[]</span>
   <span class="p">]</span>
<span class="p">}</span><span class="err">,</span>
<span class="p">{</span>
   <span class="nt">&#34;_id&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
   <span class="nt">&#34;readings&#34;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>在_id：1，_id：2，_id：3和_id：4的文档中，readings字段是一个数组。</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Forz</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2020-05-13
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/mongodb/">MongoDB</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/mongodb%E7%9A%84%E8%AF%84%E4%BC%B0%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">MongoDB的评估查询运算符</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/mongodb%E7%9A%84%E9%80%BB%E8%BE%91%E6%9F%A5%E8%AF%A2%E8%BF%90%E7%AE%97%E7%AC%A6/">
            <span class="next-text nav-default">MongoDB的逻辑查询运算符</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="forz/forzblog.talk"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2021<span class="heart"><i class="iconfont icon-heart"></i></span><span>Forz</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
