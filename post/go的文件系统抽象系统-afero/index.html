<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Go的文件系统抽象系统:Afero | Forz Blog</title>
<meta name="keywords" content="Go" />
<meta name="description" content="概观 Afero 是一个文件系统框架,提供与任何文件系统的简单,统一和通用的交互 API。作为提供接口,类型和方法的抽象层，Afero 具有非常干净的接口和">
<meta name="author" content="">
<link rel="canonical" href="/post/go%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8A%BD%E8%B1%A1%E7%B3%BB%E7%BB%9F-afero/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="Go的文件系统抽象系统:Afero" />
<meta property="og:description" content="概观 Afero 是一个文件系统框架,提供与任何文件系统的简单,统一和通用的交互 API。作为提供接口,类型和方法的抽象层，Afero 具有非常干净的接口和" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/go%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8A%BD%E8%B1%A1%E7%B3%BB%E7%BB%9F-afero/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-08-30T23:08:43&#43;00:00" />
<meta property="article:modified_time" content="2020-08-30T23:08:43&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go的文件系统抽象系统:Afero"/>
<meta name="twitter:description" content="概观 Afero 是一个文件系统框架,提供与任何文件系统的简单,统一和通用的交互 API。作为提供接口,类型和方法的抽象层，Afero 具有非常干净的接口和"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Go的文件系统抽象系统:Afero",
      "item": "/post/go%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8A%BD%E8%B1%A1%E7%B3%BB%E7%BB%9F-afero/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Go的文件系统抽象系统:Afero",
  "name": "Go的文件系统抽象系统:Afero",
  "description": "概观 Afero 是一个文件系统框架,提供与任何文件系统的简单,统一和通用的交互 API。作为提供接口,类型和方法的抽象层，Afero 具有非常干净的接口和",
  "keywords": [
    "Go"
  ],
  "articleBody": "概观 Afero 是一个文件系统框架,提供与任何文件系统的简单,统一和通用的交互 API。作为提供接口,类型和方法的抽象层，Afero 具有非常干净的接口和简单的设计,没有不必要的构造函数或初始化方法。\nAfero 也是一个库,提供一组可互操作的后端文件系统,轻松地使用。同时保留 os 和 ioutil 包的所有功能和优点.\nAfero 比单独使用 os 包提供了显着的改进,最显着的是能够在不依赖磁盘的情况下，创建模拟和测试文件系统.\n它考虑到了，您想使用 OS 包的任何情况,因为它提供了额外的抽象,使得在测试期间可以轻松使用内存支持的文件系统。它还增加了对 http 文件系统的支持,以实现完全的互操作性.\nAfero 特性  用于访问各种文件系统的唯一的一致 API 各种文件系统类型之间的互操作 一组接口,用于鼓励，和实现后端之间的互操作性 跨平台内存支持的文件原子系统 通过组合多个文件系统，来支持一个组合(联合)文件系统 修改现有文件系统的专用后端(只读,Regexp 过滤) 一组从 io,ioutil 和 hugo 移植到 afero 的实用函数  使用 Afero Afero 易于使用，且简单明了.\n您可以使用 Afero 的几种不同方式:\n 单独使用接口，来定义您自己的文件系统. 包装为 OS 包. 为应用程序的不同部分，定义不同的文件系统. 在测试时，使用 Afero 模拟文件系统  第 1 步:安装 Afero 首先使用 go get 安装最新版本的库.\n1  go get github.com/spf13/afero   接下来在您的应用程序中，包含 Afero.\n1  import \"github.com/spf13/afero\"   第 2 步:声明后端 首先定义一个包级变量，并将其设置为指向文件系统的指针.\n1 2 3 4 5  var AppFs = afero.NewMemMapFs() or var AppFs = afero.NewOsFs()   重要的是要注意,如果重复调用，您将使用一个全新的隔离文件系统。在 OsFs 的情况下,它仍将使用相同的底层文件系统，但会降低根据需要放入其他文件系统的能力.\n第 3 步:像操作系统包一样使用它 在整个应用程序中,使用您通常会使用的任何功能和方法.\n所以,如果我以前的应用有:\n1  os.Open('/tmp/foo')   我们将其替换为:\n1  AppFs.Open('/tmp/foo')   AppFs是我们上面定义的变量.\n所有可用功能的列表 文件系统方法可用:\n1 2 3 4 5 6 7 8 9 10 11 12  Chmod(name string, mode os.FileMode) : error Chtimes(name string, atime time.Time, mtime time.Time) : error Create(name string) : File, error Mkdir(name string, perm os.FileMode) : error MkdirAll(path string, perm os.FileMode) : error Name() : string Open(name string) : File, error OpenFile(name string, flag int, perm os.FileMode) : File, error Remove(name string) : error RemoveAll(path string) : error Rename(oldname, newname string) : error Stat(name string) : os.FileInfo, error   文件接口和方法可用:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  io.Closer io.Reader io.ReaderAt io.Seeker io.Writer io.WriterAt Name() : string Readdir(count int) : []os.FileInfo, error Readdirnames(n int) : []string, error Stat() : os.FileInfo, error Sync() : error Truncate(size int64) : error WriteString(s string) : ret int, err error   在某些应用程序中,定义一个只导出文件系统变量的新包，就可以从任何地方轻松访问。\n使用 Afero 的实用功能 Afero 提供了一组函数,使其更易于使用底层文件系统。这些函数主要来自 io\u0026ioutil,其中一些是为 Hugo 开发的.\nafero 实用程序，支持所有 afero 兼容的后端.\n实用程序列表包括:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  DirExists(path string) (bool, error) Exists(path string) (bool, error) FileContainsBytes(filename string, subslice []byte) (bool, error) GetTempDir(subPath string) string IsDir(path string) (bool, error) IsEmpty(path string) (bool, error) ReadDir(dirname string) ([]os.FileInfo, error) ReadFile(filename string) ([]byte, error) SafeWriteReader(path string, r io.Reader) (err error) TempDir(dir, prefix string) (name string, err error) TempFile(dir, prefix string) (f File, err error) Walk(root string, walkFn filepath.WalkFunc) error WriteFile(filename string, data []byte, perm os.FileMode) error WriteReader(path string, r io.Reader) (err error)   有关完整列表,请参阅Afero 的 GoDoc\n这里是有两种不同的使用方法。\n  您可以直接调用它们,每个函数的第一个参数将是文件系统,或者\n  您可以声明一个新Afero,一种自定义类型,用于将这些函数绑定到，给定文件系统的方法.\n  直接调用实用程序 1 2  fs := new(afero.MemMapFs) f, err := afero.TempFile(fs,\"\", \"ioutil-test\")   通过 Afero 调用 1 2 3  fs := afero.NewMemMapFs() afs := \u0026afero.Afero{Fs: fs} f, err := afs.TempFile(\"\", \"ioutil-test\")   使用 Afero 进行测试 使用模拟文件系统进行测试有很大好处。每次初始化时，它都处于完全空白状态,无论操作系统如何,都可以轻松重现。您可以创建重要内容文件,文件访问速度快,同时还可以避免，删除临时文件,Windows 文件锁定等所有烦人的问题。MemMapFs 后端非常适合测试.\n 比在磁盘上执行 I/O 操作快得多 避免安全和权限问题 更多的控制。‘rm -rf /‘将充满信心 测试设置要容易得多 无需进行测试清理  实现此目的的一种方法是定义如上所述的变量。在您的应用程序测试期间，这将被设置为afero.NewOsFs()，当然您也可以设为 afero.NewMemMapFs().\n每个测试都初始化一个空白的平板内存后端并不少见。要做到这一点, 在我应用程序代码中适当的地方，定义appFS = afero.NewOsFs()。此方法可确保测试与顺序无关,并且没有依赖于早期测试留下的状态.\n然后在我的测试中,我会为每个测试初始化一个新的 MemMapF:\n1 2 3 4 5 6 7 8 9 10 11 12  func TestExist(t *testing.T) { appFS := afero.NewMemMapFs() // 创建 test 文件 和 目录 \tappFS.MkdirAll(\"src/a\", 0755) afero.WriteFile(appFS, \"src/a/b\", []byte(\"file b\"), 0644) afero.WriteFile(appFS, \"src/c\", []byte(\"file c\"), 0644) name := \"src/c\" _, err := appFS.Stat(name) if os.IsNotExist(err) { t.Errorf(\"file \\\"%s\\\" does not exist.\\n\", name) } }   可用的后端 原生操作系统 OsFs 第一个是围绕原生 OS 调用的包装器。将它变得非常容易使用,因为所有调用都与现有的 OS 调用相同。它还使您的代码在操作系统，与根据需要使用模拟文件系统时，变得轻松，甚至无聊^_^。\n1 2  appfs := afero.NewOsFs() appfs.MkdirAll(\"src/a\", 0755))   内存支持存储 MemMapFs Afero 还提供完全原子内存支持的文件系统,非常适合用于模拟,并在不需要保持时，加速不必要的磁盘。它是完全并发的,可以安全地在 go 协程中使用.\n1 2  mm := afero.NewMemMapFs() mm.MkdirAll(\"src/a\", 0755))   InMemoryFile 作为 MemMapFs 的一部分,Afero 还提供原子的,完全并发的内存支持文件实现.这可以轻松地在其他内存支持的文件系统中使用.计划是使用 InMemoryFile 添加基数树内存存储文件系统.\n网络接口 SftpFs Afero 对安全文件传输协议(sftp)有实验性的支持。可用于加密通道上执行文件操作.\n过滤后端 BasePathFs BasePathF 将所有操作限制在 Fs 内的给定路径。在调用这个源 Fs 之前, Fs 操作的给定文件名，会以基本路径为前缀.\n1  bp := afero.NewBasePathFs(afero.NewOsFs(), \"/base/path\")   ReadOnlyFs 源 Fs 周围的薄包装器,提供只读的.\n1 2 3  fs := afero.NewReadOnlyFs(afero.NewOsFs()) _, err := fs.Create(\"/file.txt\") // err = syscall.EPERM   RegexpFs 对文件名进行过滤后的,任何与传递的正则表达式不匹配的文件，都将被视为不存在。将不会创建与提供的正则表达式不匹配的文件。目录不过滤.\n1 2 3  fs := afero.NewRegexpFs(afero.NewMemMapFs(), regexp.MustCompile(`\\.txt$`)) _, err := fs.Create(\"/file.html\") // err = syscall.ENOENT   HttpFs Afero 提供了一个 http 兼容的后端,可以包装任何现有的后端.\nHttp 包需要稍微特定的 Open 版本,它返回一个 http.File 类型.\nAfero 提供满足此要求的 httpFs 文件系统。任何 Afero FileSystem 都可以用作 httpFs。\n1 2 3  httpFs := afero.NewHttpFs(ExistingFS) fileserver := http.FileServer(httpFs.Dir(PATH))) http.Handle(\"/\", fileserver)   复合后端 Afero 提供合成两个文件系统(或更多)，作为单个文件系统的能力.\nCacheOnReadFs CacheOnReadFs 将懒洋洋地将任何访问过的文件，从基础层-base复制到覆盖层-overlay中。后续读取将直接从覆盖层中提取，允许缓存持续时间内，请求在覆盖层中创建的缓存。\n如果基本文件系统是可写的,则对文件的任何更改，将首先对基础层进行,然后对覆盖层进行。而打开文件的 Write 调用控制,如Write()或Truncate()则先到覆盖层.\n要仅将文件写入覆盖层,可以直接使用覆盖层 Fs(而不是通过联合 Fs).\n在给定time.Duration缓存持续时间内，对该层中的文件进行缓存，缓存持续时间为 0 ，意味着\"永远\"，意味着文件将不会从基础层重新请求.\n只读的基础层会让覆盖层也是只读的，但是当文件在缓存层中不存在(或过时)时，仍然将文件从基础层复制到覆盖层.\n1 2 3  base := afero.NewOsFs() layer := afero.NewMemMapFs() ufs := afero.NewCacheOnReadFs(base, layer, 100 * time.Second)   CopyOnWriteFs() CopyOnWriteFs 是一个只读的基本文件系统,顶部有一个可写的层.\nRead 操作首先查看覆盖层,如果没有找到,将从基础层提供文件服务.\n只能在覆盖层中对文件系统进行更改.\n任何仅在基础中找到的文件的修改，都会在修改(包括打开可写的文件)之前，将文件复制到覆盖层.\n目前不允许删除和重命名，仅存在于基础层中的文件。如果文件在基础层和覆盖层中存在,则仅能删除/重命名覆盖层.\n1 2 3 4 5 6 7  base := afero.NewOsFs() roBase := afero.NewReadOnlyFs(base) ufs := afero.NewCopyOnWriteFs(roBase, afero.NewMemMapFs()) fh, _ = ufs.Create(\"/home/test/file2.txt\") fh.WriteString(\"This is a test\") fh.Close()   在此示例中,所有写入操作仅发生在内存(MemMapFs)中, 基本文件系统(OsFs)保持不变.\n库 常量 1 2  const BADFD = syscall.EBADFD const FilePathSeparator = string(filepath.Separator)   os.Separator定义的文件路径分隔符。\n变量 1 2 3 4 5 6 7 8 9 10 11  var（ var ( ErrFileClosed = errors.New(\"File is closed\") ErrOutOfRange = errors.New(\"Out of range\") ErrTooLarge = errors.New(\"Too large\") ErrFileNotFound = os.ErrNotExist ErrFileExists = os.ErrExist ErrDestinationExists = os.ErrExist ) var ErrNoReadlink = errors.New(\"readlink not supported\")   如果文件系统不直接或通过其委派的文件系统不支持readlink操作，则ErrNoReadlink是将包装在os.Path中的错误。如对LinkReader接口的支持所示。\n1  var ErrNoSymlink = errors.New(\"symlink not supported\")   如果文件系统不直接或通过其委派的文件系统不支持Symlink，则ErrNoSymlink是将包装在os.LinkError中的错误。如对Linker接口的支持所示。\nfunc DirExists 1  func DirExists(fs Fs, path string) (bool, error)   DirExists检查路径是否存在并且是目录。\nfunc Exists 1  func Exists(fs Fs, path string) (bool, error)   检查文件或目录是否存在。\nfunc FileContainsAnyBytes 1  func FileContainsAnyBytes(fs Fs, filename string, subslices [][]byte) (bool, error)   检查文件是否包含任何指定的字节片。\nfunc FileContainsBytes 1  func FileContainsBytes(fs Fs, filename string, subslice []byte) (bool, error)   检查文件是否包含指定的字节片。\nfunc FullBaseFsPath 1  func FullBaseFsPath(basePathFs *BasePathFs, relativePath string) string   func GetTempDir 1  func GetTempDir(fs Fs, subPath string) string   如果subPath不为空，则GetTempDir返回带有尾斜杠的默认temp目录，它将以777 rwx rwx rwx模式递归创建\nfunc Glob 1  func Glob(fs Fs, pattern string) (matches []string, err error)   Glob返回所有匹配模式的文件的名称，如果没有匹配的文件，则返回nil。模式的语法与Match中的语法相同。该模式可以描述分层名称，例如/usr/*/bin/ed（假设分隔符为’/'）。\nGlob会忽略文件系统错误，例如读取目录的I/O错误。模式格式错误时，唯一可能返回的错误是ErrBadPattern。\n改编自（http://golang.org/pkg/path/filepath），并使用了该软件包中的多个内置插件。\nfunc IsDir 1  func IsDir(fs Fs, path string) (bool, error)   IsDir检查给定路径是否为目录。\nfunc IsEmpty 1  func IsEmpty(fs Fs, path string) (bool, error)   IsEmpty检查给定的文件或目录是否为空。\nfunc NeuterAccents 1  func NeuterAccents(s string) string   将带有重音符号的字符转换为简单形式。\nfunc ReadAll 1  func ReadAll(r io.Reader) ([]byte, error)   ReadAll从r读取直到出现错误或EOF，然后返回读取的数据。成功调用将返回err == nil，而不是err == EOF。因为ReadAll被定义为从src读取直到EOF，所以它不会将读取的EOF视为要报告的错误。\nfunc ReadDir 1  func ReadDir(fs Fs, dirname string) ([]os.FileInfo, error)   func ReadFile 1  func ReadFile(fs Fs, filename string) ([]byte, error)   func SafeWriteReader 1  func SafeWriteReader(fs Fs, path string, r io.Reader) (err error)   func TempDir 1  func TempDir(fs Fs, dir, prefix string) (name string, err error)   func UnicodeSanitize 1  func UnicodeSanitize(s string) string   重写字符串以删除非标准路径字符\nfunc Walk 1  func Walk(fs Fs, root string, walkFn filepath.WalkFunc) error   func WriteFile 1  func WriteFile(fs Fs, filename string, data []byte, perm os.FileMode) error   func WriteReader 1  func WriteReader(fs Fs, path string, r io.Reader) (err error)   type Afero 1 2 3  type Afero struct { Fs }   func (Afero) DirExists 1  func (a Afero) DirExists(path string) (bool, error)   func (Afero) Exists 1  func (a Afero) Exists(path string) (bool, error)   func (Afero) FileContainsAnyBytes 1  func (a Afero) FileContainsAnyBytes(filename string, subslices [][]byte) (bool, error)   func (Afero) FileContainsBytes 1  func (a Afero) FileContainsBytes(filename string, subslice []byte) (bool, error)   func (Afero) GetTempDir 1  func (a Afero) GetTempDir(subPath string) string   func (Afero) IsDir 1  func (a Afero) IsDir(path string) (bool, error)   func (Afero) IsEmpty 1  func (a Afero) IsEmpty(path string) (bool, error)   func (Afero) ReadDir 1  func (a Afero) ReadDir(dirname string) ([]os.FileInfo, error)   ReadDir读取以目录名命名的目录，并返回已排序目录条目的列表。\nfunc (Afero) ReadFile 1  func (a Afero) ReadFile(filename string) ([]byte, error)   ReadFile读取以文件名命名的文件并返回内容。成功调用将返回err == nil，而不是err == EOF。由于ReadFile读取整个文件，因此不会将Read中的EOF视为要报告的错误。\nfunc (Afero) SafeWriteReader 1  func (a Afero) SafeWriteReader(path string, r io.Reader) (err error)   与WriteReader相同，但检查文件/目录是否已存在。\nfunc (Afero) TempDir 1  func (a Afero) TempDir(dir, prefix string) (name string, err error)   TempDir在目录dir中创建一个以前缀开头的名称的新临时目录，并返回新目录的路径。如果dir是空字符串，则TempDir使用默认目录存储临时文件（请参见os.TempDir）。同时调用TempDir的多个程序将不会选择同一目录。不再需要该目录时，调用方有责任删除它。\nfunc (Afero) TempFile 1  func (a Afero) TempFile(dir, pattern string) (f File, err error)   TempFile在目录dir中创建一个新的临时文件，打开该文件以进行读取和写入，然后返回生成的*os.File。通过采用模式并在末尾添加随机字符串来生成文件名。如果pattern包含“”，则随机字符串将替换最后的“”。如果dir是空字符串，则TempFile使用默认目录存储临时文件（请参见os.TempDir）。同时调用TempFile的多个程序将不会选择同一文件。调用者可以使用f.Name()查找文件的路径名。不再需要该文件时，调用方有责任删除它。\nfunc (Afero) Walk 1  func (a Afero) Walk(root string, walkFn filepath.WalkFunc) error   func (Afero) WriteFile 1  func (a Afero) WriteFile(filename string, data []byte, perm os.FileMode) error   WriteFile将数据写入以文件名命名的文件。如果该文件不存在，则WriteFile使用权限perm创建它；否则WriteFile会在写入之前将其截断。\nfunc (Afero) WriteReader 1  func (a Afero) WriteReader(path string, r io.Reader) (err error)   采取读者和路径并撰写内容\ntype BasePathFile 1 2 3 4  type BasePathFile struct { File // contains filtered or unexported fields }   func (*BasePathFile) Name 1  func (f *BasePathFile) Name() string   type BasePathFs 1 2 3  type BasePathFs struct { // contains filtered or unexported fields }   BasePathFs将所有操作限制为Fs中的给定路径。在调用基本F之前，此F上的操作给定的文件名将带有基本路径。该基本路径之外的任何文件名（在filepath.Clean()之后）将被视为不存在的文件。\n请注意，它不会清除返回时的错误消息，因此您可能会揭示错误的真实路径。\nfunc (*BasePathFs) Chmod 1  FUNC度（b* BasePathFs）CHMOD（名称字符串，模式OS。的FileMode）（ERR 出错）   func (*BasePathFs) Chtimes 1  func (b *BasePathFs) Chtimes(name string, atime, mtime time.Time) (err error)   func (*BasePathFs) Create 1  func (b *BasePathFs) Create(name string) (f File, err error)   func (*BasePathFs) LstatIfPossible 1  func (b *BasePathFs) LstatIfPossible(name string) (os.FileInfo, bool, error)   func (*BasePathFs) Mkdir 1  func (b *BasePathFs) Mkdir(name string, mode os.FileMode) (err error)   func (*BasePathFs) MkdirAll 1  func (b *BasePathFs) MkdirAll(name string, mode os.FileMode) (err error)   func (*BasePathFs) Name 1  func (b *BasePathFs) Name() string   func (*BasePathFs) Open 1  func (b *BasePathFs) Open(name string) (f File, err error)   func (*BasePathFs) OpenFile 1  func (b *BasePathFs) OpenFile(name string, flag int, mode os.FileMode) (f File, err error)   func (*BasePathFs) ReadlinkIfPossible 1  func (b *BasePathFs) ReadlinkIfPossible(name string) (string, error)   func (*BasePathFs) RealPath 1  func (b *BasePathFs) RealPath(name string) (path string, err error)   在基本路径之外的文件上，它返回给定的文件名和错误，否则给定的文件带有基本路径\nfunc (*BasePathFs) Remove 1  func (b *BasePathFs) Remove(name string) (err error)   func (*BasePathFs) RemoveAll 1  func (b *BasePathFs) RemoveAll(name string) (err error)   func (*BasePathFs) Rename 1  func (b *BasePathFs) Rename(oldname, newname string) (err error)   func (*BasePathFs) Stat 1  func (b *BasePathFs) Stat(name string) (fi os.FileInfo, err error)   func (*BasePathFs) SymlinkIfPossible 1  func (b *BasePathFs) SymlinkIfPossible(oldname, newname string) error   type CacheOnReadFs 1 2 3  type CacheOnReadFs struct { // contains filtered or unexported fields }   如果缓存持续时间为0，则缓存时间将不受限制，即，一旦文件位于层中，就永远不会再为该文件读取基址。\n对于大于0的缓存时间，将检查文件的修改时间。请注意，许多文件系统实现只为时间戳允许分辨率为一秒…或作为os.Chtimes()的godoc声明：“底层文件系统可能会截断值或将值舍入为不太精确的时间单位。”\n此缓存联合将首先将所有写调用也转发到基本文件系统。为了防止写入基本Fs，请将其包装在只读过滤器中-注意：这还将使叠加层为只读，要在叠加层中写入文件，请直接使用叠加层Fs，而不是通过并集Fs。\nfunc (*CacheOnReadFs) Chmod 1  func (u *CacheOnReadFs) Chmod(name string, mode os.FileMode) error   func (*CacheOnReadFs) Chtimes 1  func (u *CacheOnReadFs) Chtimes(name string, atime, mtime time.Time) error   func (*CacheOnReadFs) Create 1  func (u *CacheOnReadFs) Create(name string) (File, error)   func (*CacheOnReadFs) Mkdir 1  func (u *CacheOnReadFs) Mkdir(name string, perm os.FileMode) error   func (*CacheOnReadFs) MkdirAll 1  func (u *CacheOnReadFs) MkdirAll(name string, perm os.FileMode) error   func (*CacheOnReadFs) Name 1  func (u *CacheOnReadFs) Name() string   func (*CacheOnReadFs) Open 1  func (u *CacheOnReadFs) Open(name string) (File, error)   func (*CacheOnReadFs) OpenFile 1  func (u *CacheOnReadFs) OpenFile(name string, flag int, perm os.FileMode) (File, error)   func (*CacheOnReadFs) Remove 1  func (u *CacheOnReadFs) Remove(name string) error   func (*CacheOnReadFs) RemoveAll 1  func (u *CacheOnReadFs) RemoveAll(name string) error   func (*CacheOnReadFs) Rename 1  func (u *CacheOnReadFs) Rename(oldname, newname string) error   func (*CacheOnReadFs) Stat 1  func (u *CacheOnReadFs) Stat(name string) (os.FileInfo, error)   type CopyOnWriteFs 1 2 3  type CopyOnWriteFs struct { // contains filtered or unexported fields }   CopyOnWriteFs是联合文件系统：只读的基本文件系统，其顶部可能是可写层。只能在叠加层中对文件系统进行更改：更改基本层中不存在于叠加层中的现有文件会将文件复制到叠加层中（“更改”还包括对例如Chtimes()和Chmod()）。\n当前仅通过Open()而不是OpenFile()支持读取目录。\nfunc (*CopyOnWriteFs) Chmod 1  func (u *CopyOnWriteFs) Chmod(name string, mode os.FileMode) error   func (*CopyOnWriteFs) Chtimes 1  func (u *CopyOnWriteFs) Chtimes(name string, atime, mtime time.Time) error   func (*CopyOnWriteFs) Create 1  func (u *CopyOnWriteFs) Create(name string) (File, error)   func (*CopyOnWriteFs) LstatIfPossible 1  func (u *CopyOnWriteFs) LstatIfPossible(name string) (os.FileInfo, bool, error)   func (*CopyOnWriteFs) Mkdir 1  func (u *CopyOnWriteFs) Mkdir(name string, perm os.FileMode) error   func (*CopyOnWriteFs) MkdirAll 1  func (u *CopyOnWriteFs) MkdirAll(name string, perm os.FileMode) error   func (*CopyOnWriteFs) Name 1  func (u *CopyOnWriteFs) Name() string   func (*CopyOnWriteFs) Open 1  func (u *CopyOnWriteFs) Open(name string) (File, error)   此功能处理由联合引起的9种不同可能性，这些可能性是以下原因的交集…\n1 2  layer: doesn't exist, exists as a file, and exists as a directory base: doesn't exist, exists as a file, and exists as a directory   func (*CopyOnWriteFs) OpenFile 1  func (u *CopyOnWriteFs) OpenFile(name string, flag int, perm os.FileMode) (File, error)   func (*CopyOnWriteFs) ReadlinkIfPossible 1 2  func (u *CopyOnWriteFs) ReadlinkIfPossible(name string) (string, error)   func (*CopyOnWriteFs) Remove 1  func (u *CopyOnWriteFs) Remove(name string) error   不允许删除仅存在于基础层中的文件。如果基础层和覆盖中存在文件，则仅覆盖将被删除。\nfunc (*CopyOnWriteFs) RemoveAll 1  func (u *CopyOnWriteFs) RemoveAll(name string) error   func (*CopyOnWriteFs) Rename 1  func (u *CopyOnWriteFs) Rename(oldname, newname string) error   重命名仅存在于基础层中的文件是不允许的\nfunc (*CopyOnWriteFs) Stat 1  func (u *CopyOnWriteFs) Stat(name string) (os.FileInfo, error)   func (*CopyOnWriteFs) SymlinkIfPossible 1 2  func (u *CopyOnWriteFs) SymlinkIfPossible(oldname, newname string) error   type DirsMerger 1  type DirsMerger func(lofi, bofi []os.FileInfo) ([]os.FileInfo, error)   DirsMerger是UnionFile将两个目录编织在一起的方式。它从图层和基础中获取FileInfo切片，并返回单个视图。\ntype File 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  type File interface { io.Closer io.Reader io.ReaderAt io.Seeker io.Writer io.WriterAt Name() string Readdir(count int) ([]os.FileInfo, error) Readdirnames(n int) ([]string, error) Stat() (os.FileInfo, error) Sync() error Truncate(size int64) error WriteString(s string) (ret int, err error) }   文件表示文件系统中的文件。\nfunc TempFile 1  func TempFile(fs Fs, dir, pattern string) (f File, err error)   type Fs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  type Fs interface { // Create creates a file in the filesystem, returning the file and an \t// error, if any happens. \tCreate(name string) (File, error) // Mkdir creates a directory in the filesystem, return an error if any \t// happens. \tMkdir(name string, perm os.FileMode) error // MkdirAll creates a directory path and all parents that does not exist \t// yet. \tMkdirAll(path string, perm os.FileMode) error // Open opens a file, returning it or an error, if any happens. \tOpen(name string) (File, error) // OpenFile opens a file using the given flags and the given mode. \tOpenFile(name string, flag int, perm os.FileMode) (File, error) // Remove removes a file identified by name, returning an error, if any \t// happens. \tRemove(name string) error // RemoveAll removes a directory path and any children it contains. It \t// does not fail if the path does not exist (return nil). \tRemoveAll(path string) error // Rename renames a file. \tRename(oldname, newname string) error // Stat returns a FileInfo describing the named file, or an error, if any \t// happens. \tStat(name string) (os.FileInfo, error) // The name of this FileSystem \tName() string //Chmod changes the mode of the named file to mode. \tChmod(name string, mode os.FileMode) error //Chtimes changes the access and modification times of the named file \tChtimes(name string, atime time.Time, mtime time.Time) error }   Fs是文件系统接口。\n任何模拟或真实文件系统都应实现此接口。\nfunc NewBasePathFs 1  func NewBasePathFs(source Fs, path string) Fs   func NewCacheOnReadFs 1  func NewCacheOnReadFs(base Fs, layer Fs, cacheTime time.Duration) Fs   func NewCopyOnWriteFs 1  func NewCopyOnWriteFs(base Fs, layer Fs) Fs   func NewMemMapFs 1  func NewMemMapFs() Fs   func NewOsFs 1  func NewOsFs() Fs   func NewReadOnlyFs 1  func NewReadOnlyFs(source Fs) Fs   func NewRegexpFs 1  func NewRegexpFs(source Fs, re *regexp.Regexp) Fs   type HttpFs 1 2 3 4  type HttpFs struct { // contains filtered or unexported fields }   func NewHttpFs 1  func NewHttpFs(source Fs) *HttpFs   func (HttpFs) Chmod 1  func (h HttpFs) Chmod(name string, mode os.FileMode) error   func (HttpFs) Chtimes 1 2  func (h HttpFs) Chtimes(name string, atime time.Time, mtime time. Time) error   func (HttpFs) Create 1  func (h HttpFs) Create(name string) (File, error)   func (HttpFs) Dir 1  func (h HttpFs) Dir(s string) *httpDir   func (HttpFs) Mkdir 1  func (h HttpFs) Mkdir(name string, perm os.FileMode) error   func (HttpFs) MkdirAll 1  func (h HttpFs) MkdirAll(path string, perm os.FileMode) error   func (HttpFs) Name 1  func (h HttpFs) Name() string   func (HttpFs) Open 1  func (h HttpFs) Open(name string) (http.File, error)   func (HttpFs) OpenFile 1 2  func (h HttpFs) OpenFile(name string, flag int, perm os.FileMode) (File, error)   func (HttpFs) Remove 1  func (h HttpFs) Remove(name string) error   func (HttpFs) RemoveAll 1  func (h HttpFs) RemoveAll(path string) error   func (HttpFs) Rename 1  func (h HttpFs) Rename(oldname, newname string) error   func (HttpFs) Stat 1  func (h HttpFs) Stat(name string) (os.FileInfo, error)   type LinkReader 1 2 3  type LinkReader interface { ReadlinkIfPossible(name string) (string, error) }   LinkReader是Afero中的可选接口。只能通过文件系统来实现。\ntype Linker 1 2 3  type Linker interface { SymlinkIfPossible(oldname, newname string) error }   链接器是Afero中的可选接口。只能通过文件系统来实现。如果文件系统本身是os文件系统或委托给os文件系统，或者文件系统另外支持Symlink的文件系统，它将调用Symlink。\ntype Lstater 1 2 3  type Lstater interface { LstatIfPossible(name string) (os.FileInfo, bool, error) }   Lstater是Afero中的可选接口。只能通过文件系统来实现。如果文件系统iself是或委托给os文件系统，它将调用Lstat。除了FileInfo之外，它还将返回一个布尔值，告知是否调用了Lstat。\ntype MemMapFs 1 2 3  type MemMapFs struct { // contains filtered or unexported fields }   func (*MemMapFs) Chmod 1  func (m *MemMapFs) Chmod(name string, mode os.FileMode) error   func (*MemMapFs) Chtimes 1 2  func (m *MemMapFs) Chtimes(name string, atime time.Time, mtime time. Time) error   func (*MemMapFs) Create 1  func (m *MemMapFs) Create(name string) (File, error)   func (*MemMapFs) List 1  func (m *MemMapFs) List()   func (*MemMapFs) Mkdir 1  func (m *MemMapFs) Mkdir(name string, perm os.FileMode) error   func (*MemMapFs) MkdirAll 1  func (m *MemMapFs) MkdirAll(path string, perm os.FileMode) error   func (*MemMapFs) Name 1  func (*MemMapFs) Name() string   func (*MemMapFs) Open 1  func (m *MemMapFs) Open(name string) (File, error)   func (*MemMapFs) OpenFile 1 2  func (m *MemMapFs) OpenFile(name string, flag int, perm os.FileMode) (File, error)   func (*MemMapFs) Remove 1  func (m *MemMapFs) Remove(name string) error   func (*MemMapFs) RemoveAll 1  func (m *MemMapFs) RemoveAll(path string) error   func (*MemMapFs) Rename 1  func (m *MemMapFs) Rename(oldname, newname string) error   func (*MemMapFs) Stat 1  func (m *MemMapFs) Stat(name string) (os.FileInfo, error)   type OsFs 1  type OsFs struct{}   OsFs是使用os软件包提供的功能的Fs实现。\n有关任何方法的详细信息，请检查os软件包的文档（http://golang.org/pkg/os/）。\nfunc (OsFs) Chmod 1  func (OsFs) Chmod(name string, mode os.FileMode) error   func (OsFs) Chtimes 1 2  func (OsFs) Chtimes(name string, atime time.Time, mtime time.Time) error   func (OsFs) Create 1  func (OsFs) Create(name string) (File, error)   func (OsFs) LstatIfPossible 1  func (OsFs) LstatIfPossible(name string) (os.FileInfo, bool, error)   func (OsFs) Mkdir 1  func (OsFs) Mkdir(name string, perm os.FileMode) error   func (OsFs) MkdirAll 1  func (OsFs) MkdirAll(path string, perm os.FileMode) error   func (OsFs) Name 1  func (OsFs) Name() string   func (OsFs) Open 1  func (OsFs) Open(name string) (File, error)   func (OsFs) OpenFile 1 2  func (OsFs) OpenFile(name string, flag int, perm os.FileMode) (File, error)   func (OsFs) ReadlinkIfPossible 1  func (OsFs) ReadlinkIfPossible(name string) (string, error)   func (OsFs) Remove 1  func (OsFs) Remove(name string) error   func (OsFs) RemoveAll 1  func (OsFs) RemoveAll(path string) error   func (OsFs) Rename 1  func (OsFs) Rename(oldname, newname string) error   func (OsFs) Stat 1  func (OsFs) Stat(name string) (os.FileInfo, error)   func (OsFs) SymlinkIfPossible 1  func (OsFs) SymlinkIfPossible(oldname, newname string) error   type ReadOnlyFs 1 2 3  type ReadOnlyFs struct { // contains filtered or unexported fields }   func (*ReadOnlyFs) Chmod 1  func (r *ReadOnlyFs) Chmod(n string, m os.FileMode) error   func (*ReadOnlyFs) Chtimes 1  func (r *ReadOnlyFs) Chtimes(n string, a, m time.Time) error   func (*ReadOnlyFs) Create 1  func (r *ReadOnlyFs) Create(n string) (File, error)   func (*ReadOnlyFs) LstatIfPossible 1 2  func (r *ReadOnlyFs) LstatIfPossible(name string) (os.FileInfo, bool, error)   func (*ReadOnlyFs) Mkdir 1  func (r *ReadOnlyFs) Mkdir(n string, p os.FileMode) error   func (*ReadOnlyFs) MkdirAll 1  func (r *ReadOnlyFs) MkdirAll(n string, p os.FileMode) error   func (*ReadOnlyFs) Name 1  func (r *ReadOnlyFs) Name() string   func (*ReadOnlyFs) Open 1  func (r *ReadOnlyFs) Open(n string) (File, error)   func (*ReadOnlyFs) OpenFile 1 2  func (r *ReadOnlyFs) OpenFile(name string, flag int, perm os. FileMode) (File, error)   func (*ReadOnlyFs) ReadDir 1  func (r *ReadOnlyFs) ReadDir(name string) ([]os.FileInfo, error)   func (*ReadOnlyFs) ReadlinkIfPossible 1  func (r *ReadOnlyFs) ReadlinkIfPossible(name string) (string, error)   func (*ReadOnlyFs) Remove 1  func (r *ReadOnlyFs) Remove(n string) error   func (*ReadOnlyFs) RemoveAll 1  func (r *ReadOnlyFs) RemoveAll(p string) error   func (*ReadOnlyFs) Rename 1  func (r *ReadOnlyFs) Rename(o, n string) error   func (*ReadOnlyFs) Stat 1  func (r *ReadOnlyFs) Stat(name string) (os.FileInfo, error)   func (*ReadOnlyFs) SymlinkIfPossible 1  func (r *ReadOnlyFs) SymlinkIfPossible(oldname, newname string) error   type RegexpFile 1  type RegexpFile struct {   // contains filtered or unexported fields }\nfunc (*RegexpFile) Close 1  func (f *RegexpFile) Close() error   func (*RegexpFile) Name 1  func (f *RegexpFile) Name() string   func (*RegexpFile) Read 1  func (f *RegexpFile) Read(s []byte) (int, error)   func (*RegexpFile) ReadAt 1  func (f *RegexpFile) ReadAt(s []byte, o int64) (int, error)   func (*RegexpFile) Readdir 1  func (f *RegexpFile) Readdir(c int) (fi []os.FileInfo, err error)   func (*RegexpFile) Readdirnames 1  func (f *RegexpFile) Readdirnames(c int) (n []string, err error)   func (*RegexpFile) Seek 1  func (f *RegexpFile) Seek(o int64, w int) (int64, error)   func (*RegexpFile) Stat 1  func (f *RegexpFile) Stat() (os.FileInfo, error)   func (*RegexpFile) Sync 1  func (f *RegexpFile) Sync() error   func (*RegexpFile) Truncate 1  func (f *RegexpFile) Truncate(s int64) error   func (*RegexpFile) Write 1  func (f *RegexpFile) Write(s []byte) (int, error)   func (*RegexpFile) WriteAt 1  func (f *RegexpFile) WriteAt(s []byte, o int64) (int, error)   func (*RegexpFile) WriteString 1  func (f *RegexpFile) WriteString(s string) (int, error)   type RegexpFs 1 2 3  type RegexpFs struct { // contains filtered or unexported fields }   RegexpFs按正则表达式过滤文件（而不是目录）。只允许与给定的regexp匹配的文件，所有其他文件都会得到一个enent错误（“没有这样的文件或目录”）。\nfunc (*RegexpFs) Chmod 1  func (r *RegexpFs) Chmod(name string, mode os.FileMode) error   func (*RegexpFs) Chtimes 1  func (r *RegexpFs) Chtimes(name string, a, m time.Time) error   func (*RegexpFs) Create 1  func (r *RegexpFs) Create(name string) (File, error)   func (*RegexpFs) Mkdir 1  func (r *RegexpFs) Mkdir(n string, p os.FileMode) error   func (*RegexpFs) MkdirAll 1  func (r *RegexpFs) MkdirAll(n string, p os.FileMode) error   func (*RegexpFs) Name 1  func (r *RegexpFs) Name() string   func (*RegexpFs) Open 1  func (r *RegexpFs) Open(name string) (File, error)   func (*RegexpFs) OpenFile 1 2  func (r *RegexpFs) OpenFile(name string, flag int, perm os.FileMode) (File, error)   func (*RegexpFs) Remove 1  func (r *RegexpFs) Remove(name string) error   func (*RegexpFs) RemoveAll 1  func (r *RegexpFs) RemoveAll(p string) error   func (*RegexpFs) Rename 1  func (r *RegexpFs) Rename(oldname, newname string) error   func (*RegexpFs) Stat 1  func (r *RegexpFs) Stat(name string) (os.FileInfo, error)   type Symlinker 1 2 3 4 5  type Symlinker interface { Lstater Linker LinkReader }   符号链接器是Afero中的一个可选接口。它只由文件系统来实现。它表示支持实现操作系统方法行为的3个符号链接相关接口：\n1 2 3  - Lstat - Symlink, and - Readlink   type UnionFile 1 2 3 4 5 6  type UnionFile struct { Base File Layer File Merger DirsMerger // contains filtered or unexported fields }   UnionFile实现阿费罗文件接口，并将在读取至少存在于覆盖中的目录或打开文件进行写入时返回。\n对Readdir()和Readdirnames() 的调用将合并文件操作系统文件信息/来自基础和覆盖层的名称-对于存在于两个层中的文件，将仅使用来自覆盖层的文件。\n当打开文件进行写入时（Create() / OpenFile()，使用正确的标志），操作将在两个层中完成，从覆盖开始。覆盖层中的成功读取将使光标在基础层中的位置按读取的字节数移动。\nfunc (*UnionFile) Close 1  func (f *UnionFile) Close() error   func (*UnionFile) Name 1  func (f *UnionFile) Name() string   func (*UnionFile) Read 1  func (f *UnionFile) Read(s []byte) (int, error)   func (*UnionFile) ReadAt 1  func (f *UnionFile) ReadAt(s []byte, o int64) (int, error)   func (*UnionFile) Readdir 1  func (f *UnionFile) Readdir(c int) (ofi []os.FileInfo, err error)   Readdir将把两个目录编织在一起，并返回重叠目录的单一视图。在目录视图的末尾，错误是io.EOF如果c0。\nfunc (*UnionFile) Readdirnames 1  func (f *UnionFile) Readdirnames(c int) ([]string, error)   func (*UnionFile) Seek 1  func (f *UnionFile) Seek(o int64, w int) (pos int64, err error)   func (*UnionFile) Stat 1  func (f *UnionFile) Stat() (os.FileInfo, error)   func (*UnionFile) Sync 1  func (f *UnionFile) Sync() (err error)   func (*UnionFile) Truncate 1  func (f *UnionFile) Truncate(s int64) (err error)   func (*UnionFile) Write 1  func (f *UnionFile) Write(s []byte) (n int, err error)   func (*UnionFile) WriteAt 1  func (f *UnionFile) WriteAt(s []byte, o int64) (n int, err error)   func (*UnionFile) WriteString 1  func (f *UnionFile) WriteString(s string) (n int, err error)   ",
  "wordCount" : "8454",
  "inLanguage": "zh-cn",
  "datePublished": "2020-08-30T23:08:43Z",
  "dateModified": "2020-08-30T23:08:43Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/go%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8A%BD%E8%B1%A1%E7%B3%BB%E7%BB%9F-afero/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Go的文件系统抽象系统:Afero
    </h1>
    <div class="post-meta">August 30, 2020
</div>
  </header> 
  <div class="post-content"><h2 id="概观">概观<a hidden class="anchor" aria-hidden="true" href="#概观">#</a></h2>
<p>Afero 是一个文件系统框架,提供与任何文件系统的简单,统一和通用的交互 API。作为提供接口,类型和方法的抽象层，Afero 具有非常干净的接口和简单的设计,没有不必要的构造函数或初始化方法。</p>
<p>Afero 也是一个库,提供一组可互操作的后端文件系统,轻松地使用。同时保留 os 和 ioutil 包的所有功能和优点.</p>
<p>Afero 比单独使用 os 包提供了显着的改进,最显着的是能够在不依赖磁盘的情况下，创建模拟和测试文件系统.</p>
<p>它考虑到了，您想使用 OS 包的任何情况,因为它提供了额外的抽象,使得在测试期间可以轻松使用内存支持的文件系统。它还增加了对 http 文件系统的支持,以实现完全的互操作性.</p>
<h3 id="afero-特性">Afero 特性<a hidden class="anchor" aria-hidden="true" href="#afero-特性">#</a></h3>
<ul>
<li>用于访问各种文件系统的唯一的一致 API</li>
<li>各种文件系统类型之间的互操作</li>
<li>一组接口,用于鼓励，和实现后端之间的互操作性</li>
<li>跨平台内存支持的文件原子系统</li>
<li>通过组合多个文件系统，来支持一个组合(联合)文件系统</li>
<li>修改现有文件系统的专用后端(只读,Regexp 过滤)</li>
<li>一组从 io,ioutil 和 hugo 移植到 afero 的实用函数</li>
</ul>
<h2 id="使用-afero">使用 Afero<a hidden class="anchor" aria-hidden="true" href="#使用-afero">#</a></h2>
<p>Afero 易于使用，且简单明了.</p>
<p>您可以使用 Afero 的几种不同方式:</p>
<ul>
<li>单独使用接口，来定义您自己的文件系统.</li>
<li>包装为 OS 包.</li>
<li>为应用程序的不同部分，定义不同的文件系统.</li>
<li>在测试时，使用 Afero 模拟文件系统</li>
</ul>
<h3 id="第-1-步安装-afero">第 1 步:安装 Afero<a hidden class="anchor" aria-hidden="true" href="#第-1-步安装-afero">#</a></h3>
<p>首先使用 go get 安装最新版本的库.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">go get github.com/spf13/afero
</code></pre></td></tr></table>
</div>
</div><p>接下来在您的应用程序中，包含 Afero.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="s">&#34;github.com/spf13/afero&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="第-2-步声明后端">第 2 步:声明后端<a hidden class="anchor" aria-hidden="true" href="#第-2-步声明后端">#</a></h3>
<p>首先定义一个包级变量，并将其设置为指向文件系统的指针.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">var</span> <span class="nx">AppFs</span> <span class="p">=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewMemMapFs</span><span class="p">()</span>

<span class="nx">or</span>

<span class="kd">var</span> <span class="nx">AppFs</span> <span class="p">=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewOsFs</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>重要的是要注意,如果重复调用，您将使用一个全新的隔离文件系统。在 OsFs 的情况下,它仍将使用相同的底层文件系统，但会降低根据需要放入其他文件系统的能力.</p>
<h3 id="第-3-步像操作系统包一样使用它">第 3 步:像操作系统包一样使用它<a hidden class="anchor" aria-hidden="true" href="#第-3-步像操作系统包一样使用它">#</a></h3>
<p>在整个应用程序中,使用您通常会使用的任何功能和方法.</p>
<p>所以,如果我以前的应用有:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">os</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="err">&#39;</span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">foo</span><span class="err">&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>我们将其替换为:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">AppFs</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="err">&#39;</span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">foo</span><span class="err">&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>AppFs</code>是我们上面定义的变量.</p>
<h3 id="所有可用功能的列表">所有可用功能的列表<a hidden class="anchor" aria-hidden="true" href="#所有可用功能的列表">#</a></h3>
<p>文件系统方法可用:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="nx">File</span><span class="p">,</span> <span class="kt">error</span>
<span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">Name</span><span class="p">()</span> <span class="p">:</span> <span class="kt">string</span>
<span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="nx">File</span><span class="p">,</span> <span class="kt">error</span>
<span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">:</span> <span class="nx">File</span><span class="p">,</span> <span class="kt">error</span>
<span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><p>文件接口和方法可用:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">io</span><span class="p">.</span><span class="nx">Closer</span>
<span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span>
<span class="nx">io</span><span class="p">.</span><span class="nx">ReaderAt</span>
<span class="nx">io</span><span class="p">.</span><span class="nx">Seeker</span>
<span class="nx">io</span><span class="p">.</span><span class="nx">Writer</span>
<span class="nx">io</span><span class="p">.</span><span class="nx">WriterAt</span>

<span class="nf">Name</span><span class="p">()</span> <span class="p">:</span> <span class="kt">string</span>
<span class="nf">Readdir</span><span class="p">(</span><span class="nx">count</span> <span class="kt">int</span><span class="p">)</span> <span class="p">:</span> <span class="p">[]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span>
<span class="nf">Readdirnames</span><span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">)</span> <span class="p">:</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span>
<span class="nf">Stat</span><span class="p">()</span> <span class="p">:</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span>
<span class="nf">Sync</span><span class="p">()</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">Truncate</span><span class="p">(</span><span class="nx">size</span> <span class="kt">int64</span><span class="p">)</span> <span class="p">:</span> <span class="kt">error</span>
<span class="nf">WriteString</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="p">:</span> <span class="nx">ret</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><p>在某些应用程序中,定义一个只导出<strong>文件系统变量</strong>的新包，就可以从任何地方轻松访问。</p>
<h3 id="使用-afero-的实用功能">使用 Afero 的实用功能<a hidden class="anchor" aria-hidden="true" href="#使用-afero-的实用功能">#</a></h3>
<p>Afero 提供了一组函数,使其更易于使用底层文件系统。这些函数主要来自 io&amp;ioutil,其中一些是为 Hugo 开发的.</p>
<p>afero 实用程序，支持所有 afero 兼容的后端.</p>
<p>实用程序列表包括:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nf">DirExists</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">Exists</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">FileContainsBytes</span><span class="p">(</span><span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">subslice</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">GetTempDir</span><span class="p">(</span><span class="nx">subPath</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span>
<span class="nf">IsDir</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">IsEmpty</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">ReadDir</span><span class="p">(</span><span class="nx">dirname</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">ReadFile</span><span class="p">(</span><span class="nx">filename</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">SafeWriteReader</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">r</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">TempDir</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">prefix</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">TempFile</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">prefix</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">File</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="nf">Walk</span><span class="p">(</span><span class="nx">root</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">walkFn</span> <span class="nx">filepath</span><span class="p">.</span><span class="nx">WalkFunc</span><span class="p">)</span> <span class="kt">error</span>
<span class="nf">WriteFile</span><span class="p">(</span><span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">data</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
<span class="nf">WriteReader</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">r</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>有关完整列表,请参阅<a href="https://godoc.org/github.com/spf13/afero">Afero 的 GoDoc</a></p>
<p>这里是有两种不同的使用方法。</p>
<ul>
<li>
<p>您可以直接调用它们,每个函数的第一个参数将是文件系统,或者</p>
</li>
<li>
<p>您可以声明一个新<code>Afero</code>,一种自定义类型,用于将这些函数绑定到，给定文件系统的方法.</p>
</li>
</ul>
<h4 id="直接调用实用程序">直接调用实用程序<a hidden class="anchor" aria-hidden="true" href="#直接调用实用程序">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">fs</span> <span class="o">:=</span> <span class="nb">new</span><span class="p">(</span><span class="nx">afero</span><span class="p">.</span><span class="nx">MemMapFs</span><span class="p">)</span>
<span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">TempFile</span><span class="p">(</span><span class="nx">fs</span><span class="p">,</span><span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;ioutil-test&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="通过-afero-调用">通过 Afero 调用<a hidden class="anchor" aria-hidden="true" href="#通过-afero-调用">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">fs</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewMemMapFs</span><span class="p">()</span>
<span class="nx">afs</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">afero</span><span class="p">.</span><span class="nx">Afero</span><span class="p">{</span><span class="nx">Fs</span><span class="p">:</span> <span class="nx">fs</span><span class="p">}</span>
<span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">afs</span><span class="p">.</span><span class="nf">TempFile</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;ioutil-test&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="使用-afero-进行测试">使用 Afero 进行测试<a hidden class="anchor" aria-hidden="true" href="#使用-afero-进行测试">#</a></h3>
<p>使用模拟文件系统进行测试有很大好处。每次初始化时，它都处于完全空白状态,无论操作系统如何,都可以轻松重现。您可以创建重要内容文件,文件访问速度快,同时还可以避免，删除临时文件,Windows 文件锁定等所有烦人的问题。MemMapFs 后端非常适合测试.</p>
<ul>
<li>比在磁盘上执行 I/O 操作快得多</li>
<li>避免安全和权限问题</li>
<li>更多的控制。&lsquo;rm -rf /&lsquo;将充满信心</li>
<li>测试设置要容易得多</li>
<li>无需进行测试清理</li>
</ul>
<p>实现此目的的一种方法是定义如上所述的变量。在您的应用程序测试期间，这将被设置为<code>afero.NewOsFs()</code>，当然您也可以设为 <code>afero.NewMemMapFs()</code>.</p>
<p>每个测试都初始化一个空白的平板内存后端并不少见。要做到这一点, 在我应用程序代码中适当的地方，定义<code>appFS = afero.NewOsFs()</code>。此方法可确保测试与顺序无关,并且没有依赖于早期测试留下的状态.</p>
<p>然后在我的测试中,我会为每个测试初始化一个新的 MemMapF:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">TestExist</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">appFS</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewMemMapFs</span><span class="p">()</span>
	<span class="c1">// 创建 test 文件 和 目录
</span><span class="c1"></span>	<span class="nx">appFS</span><span class="p">.</span><span class="nf">MkdirAll</span><span class="p">(</span><span class="s">&#34;src/a&#34;</span><span class="p">,</span> <span class="mo">0755</span><span class="p">)</span>
	<span class="nx">afero</span><span class="p">.</span><span class="nf">WriteFile</span><span class="p">(</span><span class="nx">appFS</span><span class="p">,</span> <span class="s">&#34;src/a/b&#34;</span><span class="p">,</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;file b&#34;</span><span class="p">),</span> <span class="mo">0644</span><span class="p">)</span>
	<span class="nx">afero</span><span class="p">.</span><span class="nf">WriteFile</span><span class="p">(</span><span class="nx">appFS</span><span class="p">,</span> <span class="s">&#34;src/c&#34;</span><span class="p">,</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;file c&#34;</span><span class="p">),</span> <span class="mo">0644</span><span class="p">)</span>
	<span class="nx">name</span> <span class="o">:=</span> <span class="s">&#34;src/c&#34;</span>
	<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">appFS</span><span class="p">.</span><span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">os</span><span class="p">.</span><span class="nf">IsNotExist</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nf">Errorf</span><span class="p">(</span><span class="s">&#34;file \&#34;%s\&#34; does not exist.\n&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="可用的后端">可用的后端<a hidden class="anchor" aria-hidden="true" href="#可用的后端">#</a></h2>
<h3 id="原生操作系统">原生操作系统<a hidden class="anchor" aria-hidden="true" href="#原生操作系统">#</a></h3>
<h4 id="osfs">OsFs<a hidden class="anchor" aria-hidden="true" href="#osfs">#</a></h4>
<p>第一个是围绕原生 OS 调用的包装器。将它变得非常容易使用,因为所有调用都与现有的 OS 调用相同。它还使您的代码在操作系统，与根据需要使用模拟文件系统时，变得轻松，甚至<em>无聊^_^</em>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">appfs</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewOsFs</span><span class="p">()</span>
<span class="nx">appfs</span><span class="p">.</span><span class="nf">MkdirAll</span><span class="p">(</span><span class="s">&#34;src/a&#34;</span><span class="p">,</span> <span class="mo">0755</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="内存支持存储">内存支持存储<a hidden class="anchor" aria-hidden="true" href="#内存支持存储">#</a></h3>
<h4 id="memmapfs">MemMapFs<a hidden class="anchor" aria-hidden="true" href="#memmapfs">#</a></h4>
<p>Afero 还提供完全原子内存支持的文件系统,非常适合用于模拟,并在不需要保持时，加速不必要的磁盘。它是完全并发的,可以安全地在 go 协程中使用.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">mm</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewMemMapFs</span><span class="p">()</span>
<span class="nx">mm</span><span class="p">.</span><span class="nf">MkdirAll</span><span class="p">(</span><span class="s">&#34;src/a&#34;</span><span class="p">,</span> <span class="mo">0755</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="inmemoryfile">InMemoryFile<a hidden class="anchor" aria-hidden="true" href="#inmemoryfile">#</a></h5>
<p>作为 MemMapFs 的一部分,Afero 还提供原子的,完全并发的内存支持文件实现.这可以轻松地在其他内存支持的文件系统中使用.计划是使用 InMemoryFile 添加基数树内存存储文件系统.</p>
<h3 id="网络接口">网络接口<a hidden class="anchor" aria-hidden="true" href="#网络接口">#</a></h3>
<h4 id="sftpfs">SftpFs<a hidden class="anchor" aria-hidden="true" href="#sftpfs">#</a></h4>
<p>Afero 对安全文件传输协议(sftp)有实验性的支持。可用于加密通道上执行文件操作.</p>
<h3 id="过滤后端">过滤后端<a hidden class="anchor" aria-hidden="true" href="#过滤后端">#</a></h3>
<h4 id="basepathfs">BasePathFs<a hidden class="anchor" aria-hidden="true" href="#basepathfs">#</a></h4>
<p>BasePathF 将所有操作限制在 Fs 内的给定路径。在调用这个源 Fs 之前, Fs 操作的给定文件名，会以基本路径为前缀.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">bp</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewBasePathFs</span><span class="p">(</span><span class="nx">afero</span><span class="p">.</span><span class="nf">NewOsFs</span><span class="p">(),</span> <span class="s">&#34;/base/path&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="readonlyfs">ReadOnlyFs<a hidden class="anchor" aria-hidden="true" href="#readonlyfs">#</a></h4>
<p>源 Fs 周围的薄包装器,提供只读的.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">fs</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewReadOnlyFs</span><span class="p">(</span><span class="nx">afero</span><span class="p">.</span><span class="nf">NewOsFs</span><span class="p">())</span>
<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">fs</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">&#34;/file.txt&#34;</span><span class="p">)</span>
<span class="c1">// err = syscall.EPERM
</span></code></pre></td></tr></table>
</div>
</div><h2 id="regexpfs">RegexpFs<a hidden class="anchor" aria-hidden="true" href="#regexpfs">#</a></h2>
<p>对文件名进行过滤后的,任何与传递的正则表达式不匹配的文件，都将被视为不存在。将不会创建与提供的正则表达式不匹配的文件。目录不过滤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">fs</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewRegexpFs</span><span class="p">(</span><span class="nx">afero</span><span class="p">.</span><span class="nf">NewMemMapFs</span><span class="p">(),</span> <span class="nx">regexp</span><span class="p">.</span><span class="nf">MustCompile</span><span class="p">(</span><span class="s">`\.txt$`</span><span class="p">))</span>
<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">fs</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">&#34;/file.html&#34;</span><span class="p">)</span>
<span class="c1">// err = syscall.ENOENT
</span></code></pre></td></tr></table>
</div>
</div><h3 id="httpfs">HttpFs<a hidden class="anchor" aria-hidden="true" href="#httpfs">#</a></h3>
<p>Afero 提供了一个 http 兼容的后端,可以包装任何现有的后端.</p>
<p>Http 包需要稍微特定的 Open 版本,它返回一个 http.File 类型.</p>
<p>Afero 提供满足此要求的 httpFs 文件系统。任何 Afero FileSystem 都可以用作 httpFs。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">httpFs</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewHttpFs</span><span class="p">(&lt;</span><span class="nx">ExistingFS</span><span class="p">&gt;)</span>
<span class="nx">fileserver</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">FileServer</span><span class="p">(</span><span class="nx">httpFs</span><span class="p">.</span><span class="nf">Dir</span><span class="p">(&lt;</span><span class="nx">PATH</span><span class="p">&gt;)))</span>
<span class="nx">http</span><span class="p">.</span><span class="nf">Handle</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">fileserver</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="复合后端">复合后端<a hidden class="anchor" aria-hidden="true" href="#复合后端">#</a></h3>
<p>Afero 提供合成两个文件系统(或更多)，作为单个文件系统的能力.</p>
<h4 id="cacheonreadfs">CacheOnReadFs<a hidden class="anchor" aria-hidden="true" href="#cacheonreadfs">#</a></h4>
<p>CacheOnReadFs 将懒洋洋地将任何访问过的文件，从<code>基础层-base</code>复制到<code>覆盖层-overlay</code>中。后续读取将直接从覆盖层中提取，允许缓存持续时间内，请求在覆盖层中创建的缓存。</p>
<p>如果基本文件系统是可写的,则对文件的任何更改，将首先对基础层进行,然后对覆盖层进行。而打开文件的 Write 调用控制,如<code>Write()</code>或<code>Truncate()</code>则先到覆盖层.</p>
<p>要仅将文件写入覆盖层,可以直接使用覆盖层 Fs(而不是通过联合 Fs).</p>
<p>在给定<code>time.Duration</code>缓存持续时间内，对该层中的文件进行缓存，缓存持续时间为 0 ，意味着&quot;永远&quot;，意味着文件将不会从基础层重新请求.</p>
<p>只读的基础层会让覆盖层也是只读的，但是当文件在缓存层中不存在(或过时)时，仍然将文件从基础层复制到覆盖层.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">base</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewOsFs</span><span class="p">()</span>
<span class="nx">layer</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewMemMapFs</span><span class="p">()</span>
<span class="nx">ufs</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewCacheOnReadFs</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">layer</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="copyonwritefs">CopyOnWriteFs()<a hidden class="anchor" aria-hidden="true" href="#copyonwritefs">#</a></h4>
<p>CopyOnWriteFs 是一个只读的基本文件系统,顶部有一个可写的层.</p>
<p>Read 操作首先查看覆盖层,如果没有找到,将从基础层提供文件服务.</p>
<p>只能在覆盖层中对文件系统进行更改.</p>
<p>任何仅在基础中找到的文件的修改，都会在修改(包括打开可写的文件)之前，将文件复制到覆盖层.</p>
<p>目前不允许删除和重命名，仅存在于基础层中的文件。如果文件在基础层和覆盖层中存在,则仅能删除/重命名覆盖层.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go">	<span class="nx">base</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewOsFs</span><span class="p">()</span>
	<span class="nx">roBase</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewReadOnlyFs</span><span class="p">(</span><span class="nx">base</span><span class="p">)</span>
	<span class="nx">ufs</span> <span class="o">:=</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewCopyOnWriteFs</span><span class="p">(</span><span class="nx">roBase</span><span class="p">,</span> <span class="nx">afero</span><span class="p">.</span><span class="nf">NewMemMapFs</span><span class="p">())</span>

	<span class="nx">fh</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="nx">ufs</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">&#34;/home/test/file2.txt&#34;</span><span class="p">)</span>
	<span class="nx">fh</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;This is a test&#34;</span><span class="p">)</span>
	<span class="nx">fh</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>在此示例中,所有写入操作仅发生在内存(MemMapFs)中, 基本文件系统(OsFs)保持不变.</p>
<h2 id="库">库<a hidden class="anchor" aria-hidden="true" href="#库">#</a></h2>
<h3 id="常量">常量<a hidden class="anchor" aria-hidden="true" href="#常量">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">const</span> <span class="nx">BADFD</span> <span class="p">=</span> <span class="nx">syscall</span><span class="p">.</span><span class="nx">EBADFD</span>
<span class="kd">const</span> <span class="nx">FilePathSeparator</span> <span class="p">=</span> <span class="nb">string</span><span class="p">(</span><span class="nx">filepath</span><span class="p">.</span><span class="nx">Separator</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>os.Separator定义的文件路径分隔符。</p>
<h3 id="变量">变量<a hidden class="anchor" aria-hidden="true" href="#变量">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">var</span><span class="err">（</span>
<span class="kd">var</span> <span class="p">(</span>
	<span class="nx">ErrFileClosed</span>        <span class="p">=</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;File is closed&#34;</span><span class="p">)</span>
	<span class="nx">ErrOutOfRange</span>        <span class="p">=</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;Out of range&#34;</span><span class="p">)</span>
	<span class="nx">ErrTooLarge</span>          <span class="p">=</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;Too large&#34;</span><span class="p">)</span>
	<span class="nx">ErrFileNotFound</span>      <span class="p">=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">ErrNotExist</span>
	<span class="nx">ErrFileExists</span>        <span class="p">=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">ErrExist</span>
	<span class="nx">ErrDestinationExists</span> <span class="p">=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">ErrExist</span>
<span class="p">)</span>

<span class="kd">var</span> <span class="nx">ErrNoReadlink</span> <span class="p">=</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;readlink not supported&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>如果文件系统不直接或通过其委派的文件系统不支持readlink操作，则ErrNoReadlink是将包装在os.Path中的错误。如对LinkReader接口的支持所示。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">var</span> <span class="nx">ErrNoSymlink</span> <span class="p">=</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;symlink not supported&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>如果文件系统不直接或通过其委派的文件系统不支持Symlink，则ErrNoSymlink是将包装在os.LinkError中的错误。如对Linker接口的支持所示。</p>
<h3 id="func-direxists">func DirExists<a hidden class="anchor" aria-hidden="true" href="#func-direxists">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">DirExists</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>DirExists检查路径是否存在并且是目录。</p>
<h3 id="func-exists">func Exists<a hidden class="anchor" aria-hidden="true" href="#func-exists">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">Exists</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>检查文件或目录是否存在。</p>
<h3 id="func-filecontainsanybytes">func FileContainsAnyBytes<a hidden class="anchor" aria-hidden="true" href="#func-filecontainsanybytes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">FileContainsAnyBytes</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">subslices</span> <span class="p">[][]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>检查文件是否包含任何指定的字节片。</p>
<h3 id="func-filecontainsbytes">func FileContainsBytes<a hidden class="anchor" aria-hidden="true" href="#func-filecontainsbytes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">FileContainsBytes</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">subslice</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>检查文件是否包含指定的字节片。</p>
<h3 id="func-fullbasefspath">func FullBaseFsPath<a hidden class="anchor" aria-hidden="true" href="#func-fullbasefspath">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">FullBaseFsPath</span><span class="p">(</span><span class="nx">basePathFs</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">,</span> <span class="nx">relativePath</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-gettempdir">func GetTempDir<a hidden class="anchor" aria-hidden="true" href="#func-gettempdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">GetTempDir</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">subPath</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><p>如果subPath不为空，则GetTempDir返回带有尾斜杠的默认temp目录，它将以777 rwx rwx rwx模式递归创建</p>
<h3 id="func-glob">func Glob<a hidden class="anchor" aria-hidden="true" href="#func-glob">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">Glob</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">pattern</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">matches</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Glob返回所有匹配模式的文件的名称，如果没有匹配的文件，则返回nil。模式的语法与Match中的语法相同。该模式可以描述分层名称，例如<code>/usr/*/bin/ed</code>（假设分隔符为&rsquo;/'）。</p>
<p>Glob会忽略文件系统错误，例如读取目录的I/O错误。模式格式错误时，唯一可能返回的错误是ErrBadPattern。</p>
<p>改编自（<a href="http://golang.org/pkg/path/filepath">http://golang.org/pkg/path/filepath</a>），并使用了该软件包中的多个内置插件。</p>
<h3 id="func-isdir">func IsDir<a hidden class="anchor" aria-hidden="true" href="#func-isdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">IsDir</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>IsDir检查给定路径是否为目录。</p>
<h3 id="func-isempty">func IsEmpty<a hidden class="anchor" aria-hidden="true" href="#func-isempty">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">IsEmpty</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>IsEmpty检查给定的文件或目录是否为空。</p>
<h3 id="func-neuteraccents">func NeuterAccents<a hidden class="anchor" aria-hidden="true" href="#func-neuteraccents">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NeuterAccents</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><p>将带有重音符号的字符转换为简单形式。</p>
<h3 id="func-readall">func ReadAll<a hidden class="anchor" aria-hidden="true" href="#func-readall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">ReadAll</span><span class="p">(</span><span class="nx">r</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span><span class="p">)</span> <span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ReadAll从r读取直到出现错误或EOF，然后返回读取的数据。成功调用将返回err == nil，而不是err == EOF。因为ReadAll被定义为从src读取直到EOF，所以它不会将读取的EOF视为要报告的错误。</p>
<h3 id="func-readdir">func ReadDir<a hidden class="anchor" aria-hidden="true" href="#func-readdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">ReadDir</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">dirname</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readfile">func ReadFile<a hidden class="anchor" aria-hidden="true" href="#func-readfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">ReadFile</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">filename</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-safewritereader">func SafeWriteReader<a hidden class="anchor" aria-hidden="true" href="#func-safewritereader">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">SafeWriteReader</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">r</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-tempdir">func TempDir<a hidden class="anchor" aria-hidden="true" href="#func-tempdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">TempDir</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">dir</span><span class="p">,</span> <span class="nx">prefix</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unicodesanitize">func UnicodeSanitize<a hidden class="anchor" aria-hidden="true" href="#func-unicodesanitize">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">UnicodeSanitize</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><p>重写字符串以删除非标准路径字符</p>
<h3 id="func-walk">func Walk<a hidden class="anchor" aria-hidden="true" href="#func-walk">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">Walk</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">root</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">walkFn</span> <span class="nx">filepath</span><span class="p">.</span><span class="nx">WalkFunc</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-writefile">func WriteFile<a hidden class="anchor" aria-hidden="true" href="#func-writefile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">WriteFile</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">data</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-writereader">func WriteReader<a hidden class="anchor" aria-hidden="true" href="#func-writereader">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">WriteReader</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">r</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-afero">type Afero<a hidden class="anchor" aria-hidden="true" href="#type-afero">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Afero</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">Fs</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-direxists">func (Afero) DirExists<a hidden class="anchor" aria-hidden="true" href="#func-afero-direxists">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">DirExists</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-exists">func (Afero) Exists<a hidden class="anchor" aria-hidden="true" href="#func-afero-exists">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">Exists</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-filecontainsanybytes">func (Afero) FileContainsAnyBytes<a hidden class="anchor" aria-hidden="true" href="#func-afero-filecontainsanybytes">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">FileContainsAnyBytes</span><span class="p">(</span><span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">subslices</span> <span class="p">[][]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-filecontainsbytes">func (Afero) FileContainsBytes<a hidden class="anchor" aria-hidden="true" href="#func-afero-filecontainsbytes">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">FileContainsBytes</span><span class="p">(</span><span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">subslice</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-gettempdir">func (Afero) GetTempDir<a hidden class="anchor" aria-hidden="true" href="#func-afero-gettempdir">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">GetTempDir</span><span class="p">(</span><span class="nx">subPath</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-isdir">func (Afero) IsDir<a hidden class="anchor" aria-hidden="true" href="#func-afero-isdir">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">IsDir</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-isempty">func (Afero) IsEmpty<a hidden class="anchor" aria-hidden="true" href="#func-afero-isempty">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">IsEmpty</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-readdir">func (Afero) ReadDir<a hidden class="anchor" aria-hidden="true" href="#func-afero-readdir">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">ReadDir</span><span class="p">(</span><span class="nx">dirname</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ReadDir读取以目录名命名的目录，并返回已排序目录条目的列表。</p>
<h4 id="func-afero-readfile">func (Afero) ReadFile<a hidden class="anchor" aria-hidden="true" href="#func-afero-readfile">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">ReadFile</span><span class="p">(</span><span class="nx">filename</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ReadFile读取以文件名命名的文件并返回内容。成功调用将返回err == nil，而不是err == EOF。由于ReadFile读取整个文件，因此不会将Read中的EOF视为要报告的错误。</p>
<h4 id="func-afero-safewritereader">func (Afero) SafeWriteReader<a hidden class="anchor" aria-hidden="true" href="#func-afero-safewritereader">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">SafeWriteReader</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">r</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>与WriteReader相同，但检查文件/目录是否已存在。</p>
<h4 id="func-afero-tempdir">func (Afero) TempDir<a hidden class="anchor" aria-hidden="true" href="#func-afero-tempdir">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">TempDir</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">prefix</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>TempDir在目录dir中创建一个以前缀开头的名称的新临时目录，并返回新目录的路径。如果dir是空字符串，则TempDir使用默认目录存储临时文件（请参见os.TempDir）。同时调用TempDir的多个程序将不会选择同一目录。不再需要该目录时，调用方有责任删除它。</p>
<h4 id="func-afero-tempfile">func (Afero) TempFile<a hidden class="anchor" aria-hidden="true" href="#func-afero-tempfile">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">TempFile</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">pattern</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">File</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>TempFile在目录dir中创建一个新的临时文件，打开该文件以进行读取和写入，然后返回生成的<code>*os.File</code>。通过采用模式并在末尾添加随机字符串来生成文件名。如果pattern包含“<em>”，则随机字符串将替换最后的“</em>”。如果dir是空字符串，则TempFile使用默认目录存储临时文件（请参见os.TempDir）。同时调用TempFile的多个程序将不会选择同一文件。调用者可以使用f.Name()查找文件的路径名。不再需要该文件时，调用方有责任删除它。</p>
<h4 id="func-afero-walk">func (Afero) Walk<a hidden class="anchor" aria-hidden="true" href="#func-afero-walk">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">Walk</span><span class="p">(</span><span class="nx">root</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">walkFn</span> <span class="nx">filepath</span><span class="p">.</span><span class="nx">WalkFunc</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-afero-writefile">func (Afero) WriteFile<a hidden class="anchor" aria-hidden="true" href="#func-afero-writefile">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">WriteFile</span><span class="p">(</span><span class="nx">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">data</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><p>WriteFile将数据写入以文件名命名的文件。如果该文件不存在，则WriteFile使用权限perm创建它；否则WriteFile会在写入之前将其截断。</p>
<h4 id="func-afero-writereader">func (Afero) WriteReader<a hidden class="anchor" aria-hidden="true" href="#func-afero-writereader">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">a</span> <span class="nx">Afero</span><span class="p">)</span> <span class="nf">WriteReader</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">r</span> <span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>采取读者和路径并撰写内容</p>
<h3 id="type-basepathfile">type BasePathFile<a hidden class="anchor" aria-hidden="true" href="#type-basepathfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">BasePathFile</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">File</span>
	<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfile-name">func (*BasePathFile) Name<a hidden class="anchor" aria-hidden="true" href="#func-basepathfile-name">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">BasePathFile</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-basepathfs">type BasePathFs<a hidden class="anchor" aria-hidden="true" href="#type-basepathfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">BasePathFs</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>BasePathFs将所有操作限制为Fs中的给定路径。在调用基本F之前，此F上的操作给定的文件名将带有基本路径。该基本路径之外的任何文件名（在filepath.Clean()之后）将被视为不存在的文件。</p>
<p>请注意，它不会清除返回时的错误消息，因此您可能会揭示错误的真实路径。</p>
<h4 id="func-basepathfs-chmod">func (*BasePathFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-chmod">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">FUNC度</span><span class="err">（</span><span class="nx">b</span><span class="o">*</span> <span class="nx">BasePathFs</span><span class="err">）</span><span class="nx">CHMOD</span><span class="err">（</span><span class="nx">名称字符串</span><span class="err">，</span><span class="nx">模式OS</span><span class="err">。</span><span class="nx">的FileMode</span><span class="err">）（</span><span class="nx">ERR</span> <span class="nx">出错</span><span class="err">）</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-chtimes">func (*BasePathFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-chtimes">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-create">func (*BasePathFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-create">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">File</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-lstatifpossible">func (*BasePathFs) LstatIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-lstatifpossible">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">LstatIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-mkdir">func (*BasePathFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-mkdir">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-mkdirall">func (*BasePathFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-mkdirall">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-name">func (*BasePathFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-name">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-open">func (*BasePathFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-open">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">File</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="func-basepathfs-openfile">func (*BasePathFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-openfile">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">File</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-basepathfs-readlinkifpossible">func (*BasePathFs) ReadlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-readlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">ReadlinkIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-basepathfs-realpath">func (*BasePathFs) RealPath<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-realpath">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">RealPath</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>在基本路径之外的文件上，它返回给定的文件名和错误，否则给定的文件带有基本路径</p>
<h3 id="func-basepathfs-remove">func (*BasePathFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-basepathfs-removeall">func (*BasePathFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-basepathfs-rename">func (*BasePathFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-basepathfs-stat">func (*BasePathFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">fi</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-basepathfs-symlinkifpossible">func (*BasePathFs) SymlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-basepathfs-symlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">b</span> <span class="o">*</span><span class="nx">BasePathFs</span><span class="p">)</span> <span class="nf">SymlinkIfPossible</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-cacheonreadfs">type CacheOnReadFs<a hidden class="anchor" aria-hidden="true" href="#type-cacheonreadfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">CacheOnReadFs</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>如果缓存持续时间为0，则缓存时间将不受限制，即，一旦文件位于层中，就永远不会再为该文件读取基址。</p>
<p>对于大于0的缓存时间，将检查文件的修改时间。请注意，许多文件系统实现只为时间戳允许分辨率为一秒&hellip;或作为os.Chtimes()的godoc声明：“底层文件系统可能会截断值或将值舍入为不太精确的时间单位。”</p>
<p>此缓存联合将首先将所有写调用也转发到基本文件系统。为了防止写入基本Fs，请将其包装在只读过滤器中-注意：这还将使叠加层为只读，要在叠加层中写入文件，请直接使用叠加层Fs，而不是通过并集Fs。</p>
<h3 id="func-cacheonreadfs-chmod">func (*CacheOnReadFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-chmod">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-chtimes">func (*CacheOnReadFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-chtimes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-create">func (*CacheOnReadFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-create">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-mkdir">func (*CacheOnReadFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-mkdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-mkdirall">func (*CacheOnReadFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-mkdirall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-name">func (*CacheOnReadFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-open">func (*CacheOnReadFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-open">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-openfile">func (*CacheOnReadFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-openfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-remove">func (*CacheOnReadFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-removeall">func (*CacheOnReadFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-rename">func (*CacheOnReadFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-cacheonreadfs-stat">func (*CacheOnReadFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-cacheonreadfs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CacheOnReadFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-copyonwritefs">type CopyOnWriteFs<a hidden class="anchor" aria-hidden="true" href="#type-copyonwritefs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">CopyOnWriteFs</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>CopyOnWriteFs是联合文件系统：只读的基本文件系统，其顶部可能是可写层。只能在叠加层中对文件系统进行更改：更改基本层中不存在于叠加层中的现有文件会将文件复制到叠加层中（“更改”还包括对例如Chtimes()和Chmod()）。</p>
<p>当前仅通过Open()而不是OpenFile()支持读取目录。</p>
<h3 id="func-copyonwritefs-chmod">func (*CopyOnWriteFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-chmod">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-chtimes">func (*CopyOnWriteFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-chtimes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-create">func (*CopyOnWriteFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-create">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-lstatifpossible">func (*CopyOnWriteFs) LstatIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-lstatifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">LstatIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-mkdir">func (*CopyOnWriteFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-mkdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-mkdirall">func (*CopyOnWriteFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-mkdirall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-name">func (*CopyOnWriteFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-open">func (*CopyOnWriteFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-open">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>此功能处理由联合引起的9种不同可能性，这些可能性是以下原因的交集&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">layer</span><span class="o">:</span> <span class="n">doesn</span><span class="s">&#39;t exist, exists as a file, and exists as a directory
</span><span class="s">base:  doesn&#39;</span><span class="n">t</span> <span class="n">exist</span><span class="p">,</span> <span class="n">exists</span> <span class="n">as</span> <span class="n">a</span> <span class="n">file</span><span class="p">,</span> <span class="n">and</span> <span class="n">exists</span> <span class="n">as</span> <span class="n">a</span> <span class="n">directory</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-openfile">func (*CopyOnWriteFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-openfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-readlinkifpossible">func (*CopyOnWriteFs) ReadlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-readlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">ReadlinkIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span>
<span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-remove">func (*CopyOnWriteFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><p>不允许删除仅存在于基础层中的文件。如果基础层和覆盖中存在文件，则仅覆盖将被删除。</p>
<h3 id="func-copyonwritefs-removeall">func (*CopyOnWriteFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-rename">func (*CopyOnWriteFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><p>重命名仅存在于基础层中的文件是不允许的</p>
<h3 id="func-copyonwritefs-stat">func (*CopyOnWriteFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-copyonwritefs-symlinkifpossible">func (*CopyOnWriteFs) SymlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-copyonwritefs-symlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">CopyOnWriteFs</span><span class="p">)</span> <span class="nf">SymlinkIfPossible</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span>
<span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-dirsmerger">type DirsMerger<a hidden class="anchor" aria-hidden="true" href="#type-dirsmerger">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">DirsMerger</span> <span class="kd">func</span><span class="p">(</span><span class="nx">lofi</span><span class="p">,</span> <span class="nx">bofi</span> <span class="p">[]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">)</span> <span class="p">([]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>DirsMerger是UnionFile将两个目录编织在一起的方式。它从图层和基础中获取FileInfo切片，并返回单个视图。</p>
<h3 id="type-file">type File<a hidden class="anchor" aria-hidden="true" href="#type-file">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">File</span> <span class="kd">interface</span> <span class="p">{</span>
	<span class="nx">io</span><span class="p">.</span><span class="nx">Closer</span>
	<span class="nx">io</span><span class="p">.</span><span class="nx">Reader</span>
	<span class="nx">io</span><span class="p">.</span><span class="nx">ReaderAt</span>
	<span class="nx">io</span><span class="p">.</span><span class="nx">Seeker</span>
	<span class="nx">io</span><span class="p">.</span><span class="nx">Writer</span>
	<span class="nx">io</span><span class="p">.</span><span class="nx">WriterAt</span>

	<span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
	<span class="nf">Readdir</span><span class="p">(</span><span class="nx">count</span> <span class="kt">int</span><span class="p">)</span> <span class="p">([]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
	<span class="nf">Readdirnames</span><span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">)</span> <span class="p">([]</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
	<span class="nf">Stat</span><span class="p">()</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
	<span class="nf">Sync</span><span class="p">()</span> <span class="kt">error</span>
	<span class="nf">Truncate</span><span class="p">(</span><span class="nx">size</span> <span class="kt">int64</span><span class="p">)</span> <span class="kt">error</span>
	<span class="nf">WriteString</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">ret</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>文件表示文件系统中的文件。</p>
<h3 id="func-tempfile">func TempFile<a hidden class="anchor" aria-hidden="true" href="#func-tempfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">TempFile</span><span class="p">(</span><span class="nx">fs</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">dir</span><span class="p">,</span> <span class="nx">pattern</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">File</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-fs">type Fs<a hidden class="anchor" aria-hidden="true" href="#type-fs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Fs</span> <span class="kd">interface</span> <span class="p">{</span>
<span class="c1">// Create creates a file in the filesystem, returning the file and an
</span><span class="c1"></span>	<span class="c1">// error, if any happens.
</span><span class="c1"></span>	<span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>

	<span class="c1">// Mkdir creates a directory in the filesystem, return an error if any
</span><span class="c1"></span>	<span class="c1">// happens.
</span><span class="c1"></span>	<span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>

	<span class="c1">// MkdirAll creates a directory path and all parents that does not exist
</span><span class="c1"></span>	<span class="c1">// yet.
</span><span class="c1"></span>	<span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>

	<span class="c1">// Open opens a file, returning it or an error, if any happens.
</span><span class="c1"></span>	<span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>

	<span class="c1">// OpenFile opens a file using the given flags and the given mode.
</span><span class="c1"></span>	<span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>

	<span class="c1">// Remove removes a file identified by name, returning an error, if any
</span><span class="c1"></span>	<span class="c1">// happens.
</span><span class="c1"></span>	<span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>

	<span class="c1">// RemoveAll removes a directory path and any children it contains. It
</span><span class="c1"></span>	<span class="c1">// does not fail if the path does not exist (return nil).
</span><span class="c1"></span>	<span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>

	<span class="c1">// Rename renames a file.
</span><span class="c1"></span>	<span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>

	<span class="c1">// Stat returns a FileInfo describing the named file, or an error, if any
</span><span class="c1"></span>	<span class="c1">// happens.
</span><span class="c1"></span>	<span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>

	<span class="c1">// The name of this FileSystem
</span><span class="c1"></span>	<span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>

	<span class="c1">//Chmod changes the mode of the named file to mode.
</span><span class="c1"></span>	<span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>

	<span class="c1">//Chtimes changes the access and modification times of the named file
</span><span class="c1"></span>	<span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="kt">error</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Fs是文件系统接口。</p>
<p>任何模拟或真实文件系统都应实现此接口。</p>
<h3 id="func-newbasepathfs">func NewBasePathFs<a hidden class="anchor" aria-hidden="true" href="#func-newbasepathfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewBasePathFs</span><span class="p">(</span><span class="nx">source</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">Fs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-newcacheonreadfs">func NewCacheOnReadFs<a hidden class="anchor" aria-hidden="true" href="#func-newcacheonreadfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewCacheOnReadFs</span><span class="p">(</span><span class="nx">base</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">layer</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">cacheTime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="p">)</span> <span class="nx">Fs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-newcopyonwritefs">func NewCopyOnWriteFs<a hidden class="anchor" aria-hidden="true" href="#func-newcopyonwritefs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewCopyOnWriteFs</span><span class="p">(</span><span class="nx">base</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">layer</span> <span class="nx">Fs</span><span class="p">)</span> <span class="nx">Fs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-newmemmapfs">func NewMemMapFs<a hidden class="anchor" aria-hidden="true" href="#func-newmemmapfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewMemMapFs</span><span class="p">()</span> <span class="nx">Fs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-newosfs">func NewOsFs<a hidden class="anchor" aria-hidden="true" href="#func-newosfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewOsFs</span><span class="p">()</span> <span class="nx">Fs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-newreadonlyfs">func NewReadOnlyFs<a hidden class="anchor" aria-hidden="true" href="#func-newreadonlyfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewReadOnlyFs</span><span class="p">(</span><span class="nx">source</span> <span class="nx">Fs</span><span class="p">)</span> <span class="nx">Fs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-newregexpfs">func NewRegexpFs<a hidden class="anchor" aria-hidden="true" href="#func-newregexpfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewRegexpFs</span><span class="p">(</span><span class="nx">source</span> <span class="nx">Fs</span><span class="p">,</span> <span class="nx">re</span> <span class="o">*</span><span class="nx">regexp</span><span class="p">.</span><span class="nx">Regexp</span><span class="p">)</span> <span class="nx">Fs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-httpfs">type HttpFs<a hidden class="anchor" aria-hidden="true" href="#type-httpfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">HttpFs</span> <span class="kd">struct</span> <span class="p">{</span>

<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-newhttpfs">func NewHttpFs<a hidden class="anchor" aria-hidden="true" href="#func-newhttpfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nf">NewHttpFs</span><span class="p">(</span><span class="nx">source</span> <span class="nx">Fs</span><span class="p">)</span> <span class="o">*</span><span class="nx">HttpFs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-chmod">func (HttpFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-chmod">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-chtimes">func (HttpFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-chtimes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span>
<span class="nx">Time</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-create">func (HttpFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-create">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-dir">func (HttpFs) Dir<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-dir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Dir</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="o">*</span><span class="nx">httpDir</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-mkdir">func (HttpFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-mkdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-mkdirall">func (HttpFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-mkdirall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-name">func (HttpFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-open">func (HttpFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-open">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-openfile">func (HttpFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-openfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span>
<span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-remove">func (HttpFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-removeall">func (HttpFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-rename">func (HttpFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-httpfs-stat">func (HttpFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-httpfs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">HttpFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-linkreader">type LinkReader<a hidden class="anchor" aria-hidden="true" href="#type-linkreader">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">LinkReader</span> <span class="kd">interface</span> <span class="p">{</span>
	<span class="nf">ReadlinkIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>LinkReader是Afero中的可选接口。只能通过文件系统来实现。</p>
<h3 id="type-linker">type Linker<a hidden class="anchor" aria-hidden="true" href="#type-linker">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Linker</span> <span class="kd">interface</span> <span class="p">{</span>
	<span class="nf">SymlinkIfPossible</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>链接器是Afero中的可选接口。只能通过文件系统来实现。如果文件系统本身是os文件系统或委托给os文件系统，或者文件系统另外支持Symlink的文件系统，它将调用Symlink。</p>
<h3 id="type-lstater">type Lstater<a hidden class="anchor" aria-hidden="true" href="#type-lstater">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Lstater</span> <span class="kd">interface</span> <span class="p">{</span>
	<span class="nf">LstatIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Lstater是Afero中的可选接口。只能通过文件系统来实现。如果文件系统iself是或委托给os文件系统，它将调用Lstat。除了FileInfo之外，它还将返回一个布尔值，告知是否调用了Lstat。</p>
<h3 id="type-memmapfs">type MemMapFs<a hidden class="anchor" aria-hidden="true" href="#type-memmapfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">MemMapFs</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-chmod">func (*MemMapFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-chmod">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-chtimes">func (*MemMapFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-chtimes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span>
<span class="nx">Time</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-create">func (*MemMapFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-create">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-list">func (*MemMapFs) List<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-list">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">List</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-mkdir">func (*MemMapFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-mkdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-mkdirall">func (*MemMapFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-mkdirall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-name">func (*MemMapFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-open">func (*MemMapFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-open">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-openfile">func (*MemMapFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-openfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span>
<span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-remove">func (*MemMapFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-removeall">func (*MemMapFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-rename">func (*MemMapFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-memmapfs-stat">func (*MemMapFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-memmapfs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="o">*</span><span class="nx">MemMapFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-osfs">type OsFs<a hidden class="anchor" aria-hidden="true" href="#type-osfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">OsFs</span> <span class="kd">struct</span><span class="p">{}</span>
</code></pre></td></tr></table>
</div>
</div><p>OsFs是使用os软件包提供的功能的Fs实现。</p>
<p>有关任何方法的详细信息，请检查os软件包的文档（<a href="http://golang.org/pkg/os/">http://golang.org/pkg/os/</a>）。</p>
<h3 id="func-osfs-chmod">func (OsFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-osfs-chmod">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-chtimes">func (OsFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-osfs-chtimes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">atime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">,</span> <span class="nx">mtime</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span>
<span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-create">func (OsFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-osfs-create">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-lstatifpossible">func (OsFs) LstatIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-osfs-lstatifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">LstatIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-mkdir">func (OsFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-osfs-mkdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-mkdirall">func (OsFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-osfs-mkdirall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-name">func (OsFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-osfs-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-open">func (OsFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-osfs-open">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-openfile">func (OsFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-osfs-openfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span>
<span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-readlinkifpossible">func (OsFs) ReadlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-osfs-readlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">ReadlinkIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-remove">func (OsFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-osfs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-removeall">func (OsFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-osfs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-rename">func (OsFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-osfs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-stat">func (OsFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-osfs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-osfs-symlinkifpossible">func (OsFs) SymlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-osfs-symlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">OsFs</span><span class="p">)</span> <span class="nf">SymlinkIfPossible</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-readonlyfs">type ReadOnlyFs<a hidden class="anchor" aria-hidden="true" href="#type-readonlyfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">ReadOnlyFs</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-chmod">func (*ReadOnlyFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-chmod">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Chmod</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">m</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-chtimes">func (*ReadOnlyFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-chtimes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">m</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-create">func (*ReadOnlyFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-create">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-lstatifpossible">func (*ReadOnlyFs) LstatIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-lstatifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">LstatIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span>
<span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-mkdir">func (*ReadOnlyFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-mkdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">p</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-mkdirall">func (*ReadOnlyFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-mkdirall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">p</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-name">func (*ReadOnlyFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-open">func (*ReadOnlyFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-open">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-openfile">func (*ReadOnlyFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-openfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span>
<span class="nx">FileMode</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-readdir">func (*ReadOnlyFs) ReadDir<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-readdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">ReadDir</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">([]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-readlinkifpossible">func (*ReadOnlyFs) ReadlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-readlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">ReadlinkIfPossible</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-remove">func (*ReadOnlyFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-removeall">func (*ReadOnlyFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">p</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-rename">func (*ReadOnlyFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">n</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-stat">func (*ReadOnlyFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-readonlyfs-symlinkifpossible">func (*ReadOnlyFs) SymlinkIfPossible<a hidden class="anchor" aria-hidden="true" href="#func-readonlyfs-symlinkifpossible">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">ReadOnlyFs</span><span class="p">)</span> <span class="nf">SymlinkIfPossible</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-regexpfile">type RegexpFile<a hidden class="anchor" aria-hidden="true" href="#type-regexpfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">RegexpFile</span> <span class="kd">struct</span> <span class="p">{</span>
</code></pre></td></tr></table>
</div>
</div><p>// contains filtered or unexported fields
}</p>
<h3 id="func-regexpfile-close">func (*RegexpFile) Close<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-close">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Close</span><span class="p">()</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-name">func (*RegexpFile) Name<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-read">func (*RegexpFile) Read<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-read">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Read</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-readat">func (*RegexpFile) ReadAt<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-readat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">ReadAt</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">o</span> <span class="kt">int64</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-readdir">func (*RegexpFile) Readdir<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-readdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Readdir</span><span class="p">(</span><span class="nx">c</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">fi</span> <span class="p">[]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-readdirnames">func (*RegexpFile) Readdirnames<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-readdirnames">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Readdirnames</span><span class="p">(</span><span class="nx">c</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-seek">func (*RegexpFile) Seek<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-seek">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Seek</span><span class="p">(</span><span class="nx">o</span> <span class="kt">int64</span><span class="p">,</span> <span class="nx">w</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="kt">int64</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-stat">func (*RegexpFile) Stat<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">()</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-sync">func (*RegexpFile) Sync<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-sync">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Sync</span><span class="p">()</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-truncate">func (*RegexpFile) Truncate<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-truncate">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Truncate</span><span class="p">(</span><span class="nx">s</span> <span class="kt">int64</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-write">func (*RegexpFile) Write<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-write">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">Write</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-writeat">func (*RegexpFile) WriteAt<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-writeat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">WriteAt</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">o</span> <span class="kt">int64</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfile-writestring">func (*RegexpFile) WriteString<a hidden class="anchor" aria-hidden="true" href="#func-regexpfile-writestring">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">RegexpFile</span><span class="p">)</span> <span class="nf">WriteString</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-regexpfs">type RegexpFs<a hidden class="anchor" aria-hidden="true" href="#type-regexpfs">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">RegexpFs</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>RegexpFs按正则表达式过滤文件（而不是目录）。只允许与给定的regexp匹配的文件，所有其他文件都会得到一个enent错误（“没有这样的文件或目录”）。</p>
<h3 id="func-regexpfs-chmod">func (*RegexpFs) Chmod<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-chmod">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Chmod</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">mode</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-chtimes">func (*RegexpFs) Chtimes<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-chtimes">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Chtimes</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">m</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-create">func (*RegexpFs) Create<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-create">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Create</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-mkdir">func (*RegexpFs) Mkdir<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-mkdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Mkdir</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">p</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-mkdirall">func (*RegexpFs) MkdirAll<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-mkdirall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">MkdirAll</span><span class="p">(</span><span class="nx">n</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">p</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-name">func (*RegexpFs) Name<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-open">func (*RegexpFs) Open<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-open">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Open</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-openfile">func (*RegexpFs) OpenFile<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-openfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">OpenFile</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">flag</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">perm</span> <span class="nx">os</span><span class="p">.</span><span class="nx">FileMode</span><span class="p">)</span>
<span class="p">(</span><span class="nx">File</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-remove">func (*RegexpFs) Remove<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-remove">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-removeall">func (*RegexpFs) RemoveAll<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-removeall">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">RemoveAll</span><span class="p">(</span><span class="nx">p</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-rename">func (*RegexpFs) Rename<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-rename">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Rename</span><span class="p">(</span><span class="nx">oldname</span><span class="p">,</span> <span class="nx">newname</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-regexpfs-stat">func (*RegexpFs) Stat<a hidden class="anchor" aria-hidden="true" href="#func-regexpfs-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">r</span> <span class="o">*</span><span class="nx">RegexpFs</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-symlinker">type Symlinker<a hidden class="anchor" aria-hidden="true" href="#type-symlinker">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">Symlinker</span> <span class="kd">interface</span> <span class="p">{</span>
	<span class="nx">Lstater</span>
	<span class="nx">Linker</span>
	<span class="nx">LinkReader</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>符号链接器是Afero中的一个可选接口。它只由文件系统来实现。它表示支持实现操作系统方法行为的3个符号链接相关接口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="o">-</span> <span class="n">Lstat</span>
<span class="o">-</span> <span class="n">Symlink</span><span class="p">,</span> <span class="n">and</span>
<span class="o">-</span> <span class="n">Readlink</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="type-unionfile">type UnionFile<a hidden class="anchor" aria-hidden="true" href="#type-unionfile">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">UnionFile</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">Base</span>   <span class="nx">File</span>
	<span class="nx">Layer</span>  <span class="nx">File</span>
	<span class="nx">Merger</span> <span class="nx">DirsMerger</span>
	<span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>UnionFile实现阿费罗文件接口，并将在读取至少存在于覆盖中的目录或打开文件进行写入时返回。</p>
<p>对Readdir()和Readdirnames() 的调用将合并文件操作系统文件信息/来自基础和覆盖层的名称-对于存在于两个层中的文件，将仅使用来自覆盖层的文件。</p>
<p>当打开文件进行写入时（Create() / OpenFile()，使用正确的标志），操作将在两个层中完成，从覆盖开始。覆盖层中的成功读取将使光标在基础层中的位置按读取的字节数移动。</p>
<h3 id="func-unionfile-close">func (*UnionFile) Close<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-close">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Close</span><span class="p">()</span> <span class="kt">error</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-name">func (*UnionFile) Name<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-name">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Name</span><span class="p">()</span> <span class="kt">string</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-read">func (*UnionFile) Read<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-read">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Read</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-readat">func (*UnionFile) ReadAt<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-readat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">ReadAt</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">o</span> <span class="kt">int64</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-readdir">func (*UnionFile) Readdir<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-readdir">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Readdir</span><span class="p">(</span><span class="nx">c</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">ofi</span> <span class="p">[]</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Readdir将把两个目录编织在一起，并返回重叠目录的单一视图。在目录视图的末尾，错误是io.EOF如果c&gt;0。</p>
<h3 id="func-unionfile-readdirnames">func (*UnionFile) Readdirnames<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-readdirnames">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Readdirnames</span><span class="p">(</span><span class="nx">c</span> <span class="kt">int</span><span class="p">)</span> <span class="p">([]</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-seek">func (*UnionFile) Seek<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-seek">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Seek</span><span class="p">(</span><span class="nx">o</span> <span class="kt">int64</span><span class="p">,</span> <span class="nx">w</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">pos</span> <span class="kt">int64</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-stat">func (*UnionFile) Stat<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-stat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Stat</span><span class="p">()</span> <span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">FileInfo</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-sync">func (*UnionFile) Sync<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-sync">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Sync</span><span class="p">()</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-truncate">func (*UnionFile) Truncate<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-truncate">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Truncate</span><span class="p">(</span><span class="nx">s</span> <span class="kt">int64</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-write">func (*UnionFile) Write<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-write">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">Write</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-writeat">func (*UnionFile) WriteAt<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-writeat">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">WriteAt</span><span class="p">(</span><span class="nx">s</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">o</span> <span class="kt">int64</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="func-unionfile-writestring">func (*UnionFile) WriteString<a hidden class="anchor" aria-hidden="true" href="#func-unionfile-writestring">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">UnionFile</span><span class="p">)</span> <span class="nf">WriteString</span><span class="p">(</span><span class="nx">s</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/go/">Go</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
