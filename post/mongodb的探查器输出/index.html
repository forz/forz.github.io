<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MongoDB的数据库探查器输出 | Forz Blog</title>
<meta name="keywords" content="MongoDB" />
<meta name="description" content="示例system.profile文档 下面显示了在system.profile集合中找到的一些示例文档，这些文档可 用于独立运行： 以下文档sys">
<meta name="author" content="">
<link rel="canonical" href="/post/mongodb%E7%9A%84%E6%8E%A2%E6%9F%A5%E5%99%A8%E8%BE%93%E5%87%BA/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="MongoDB的数据库探查器输出" />
<meta property="og:description" content="示例system.profile文档 下面显示了在system.profile集合中找到的一些示例文档，这些文档可 用于独立运行： 以下文档sys" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/mongodb%E7%9A%84%E6%8E%A2%E6%9F%A5%E5%99%A8%E8%BE%93%E5%87%BA/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-06-09T15:11:50&#43;00:00" />
<meta property="article:modified_time" content="2020-06-09T15:11:50&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MongoDB的数据库探查器输出"/>
<meta name="twitter:description" content="示例system.profile文档 下面显示了在system.profile集合中找到的一些示例文档，这些文档可 用于独立运行： 以下文档sys"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "MongoDB的数据库探查器输出",
      "item": "/post/mongodb%E7%9A%84%E6%8E%A2%E6%9F%A5%E5%99%A8%E8%BE%93%E5%87%BA/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MongoDB的数据库探查器输出",
  "name": "MongoDB的数据库探查器输出",
  "description": "示例system.profile文档 下面显示了在system.profile集合中找到的一些示例文档，这些文档可 用于独立运行： 以下文档sys",
  "keywords": [
    "MongoDB"
  ],
  "articleBody": "示例system.profile文档 下面显示了在system.profile集合中找到的一些示例文档，这些文档可 用于独立运行：\n以下文档system.profile反映了查找操作：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73  { \"op\" : \"query\", \"ns\" : \"test.report\", \"command\" : { \"find\" : \"report\", \"filter\" : { \"a\" : { \"$lte\" : 500 } }, \"lsid\" : { \"id\" : UUID(\"5ccd5b81-b023-41f3-8959-bf99ed696ce9\") }, \"$db\" : \"test\" }, \"cursorid\" : 33629063128, \"keysExamined\" : 101, \"docsExamined\" : 101, \"fromMultiPlanner\" : true, \"numYield\" : 2, \"nreturned\" : 101, \"queryHash\" : \"811451DD\", \"planCacheKey\" : \"759981BA\", \"locks\" : { \"Global\" : { \"acquireCount\" : { \"r\" : NumberLong(3), \"w\" : NumberLong(3) } }, \"Database\" : { \"acquireCount\" : { \"r\" : NumberLong(3) }, \"acquireWaitCount\" : { \"r\" : NumberLong(1) }, \"timeAcquiringMicros\" : { \"r\" : NumberLong(69130694) } }, \"Collection\" : { \"acquireCount\" : { \"r\" : NumberLong(3) } } }, \"storage\" : { \"data\" : { \"bytesRead\" : NumberLong(14736), \"timeReadingMicros\" : NumberLong(17) } }, \"responseLength\" : 1305014, \"protocol\" : \"op_msg\", \"millis\" : 69132, \"planSummary\" : \"IXSCAN { a: 1, _id: -1 }\", \"execStats\" : { \"stage\" : \"FETCH\", \"nReturned\" : 101, \"executionTimeMillisEstimate\" : 0, \"works\" : 101, \"advanced\" : 101, \"needTime\" : 0, \"needYield\" : 0, \"saveState\" : 3, \"restoreState\" : 2, \"isEOF\" : 0, \"docsExamined\" : 101, \"alreadyHasObj\" : 0, \"inputStage\" : { ... } }, \"ts\" : ISODate(\"2019-01-14T16:57:33.450Z\"), \"client\" : \"127.0.0.1\", \"appName\" : \"MongoDB Shell\", \"allUsers\" : [ { \"user\" : \"someuser\", \"db\" : \"admin\" } ], \"user\" : \"someuser@admin\" }   以下示例反映了对名为report的集合的更新操作。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82  { \"op\" : \"update\", \"ns\" : \"test.report\", \"command\" : { \"q\" : { }, \"u\" : { \"$rename\" : { \"a\" : \"b\" } }, \"multi\" : true, \"upsert\" : false }, \"keysExamined\" : 0, \"docsExamined\" : 25000, \"nMatched\" : 25000, \"nModified\" : 25000, \"keysInserted\" : 25000, \"keysDeleted\" : 25000000, \"numYield\" : 6985, \"locks\" : { \"Global\" : { \"acquireCount\" : { \"r\" : NumberLong(6986), \"w\" : NumberLong(13972) } }, \"Database\" : { \"acquireCount\" : { \"w\" : NumberLong(6986) }, \"acquireWaitCount\" : { \"w\" : NumberLong(1) }, \"timeAcquiringMicros\" : { \"w\" : NumberLong(60899375) } }, \"Collection\" : { \"acquireCount\" : { \"w\" : NumberLong(6986) } }, \"Mutex\" : { \"acquireCount\" : { \"r\" : NumberLong(25000) } } }, \"storage\" : { \"data\" : { \"bytesRead\" : NumberLong(126344060), \"bytesWritten\" : NumberLong(281834762), \"timeReadingMicros\" : NumberLong(94549), \"timeWritingMicros\" : NumberLong(139361) } }, \"millis\" : 164687, \"planSummary\" : \"COLLSCAN\", \"execStats\" : { \"stage\" : \"UPDATE\", \"nReturned\" : 0, \"executionTimeMillisEstimate\" : 103771, \"works\" : 25003, \"advanced\" : 0, \"needTime\" : 25002, \"needYield\" : 0, \"saveState\" : 6985, \"restoreState\" : 6985, \"isEOF\" : 1, \"nMatched\" : 25000, \"nWouldModify\" : 25000, \"wouldInsert\" : false, \"inputStage\" : { \"stage\" : \"COLLSCAN\", \"nReturned\" : 25000, \"executionTimeMillisEstimate\" : 0, \"works\" : 25002, \"advanced\" : 25000, \"needTime\" : 1, \"needYield\" : 0, \"saveState\" : 31985, \"restoreState\" : 31985, \"isEOF\" : 1, \"direction\" : \"forward\", \"docsExamined\" : 25000 } }, \"ts\" : ISODate(\"2019-01-14T23:33:01.806Z\"), \"client\" : \"127.0.0.1\", \"appName\" : \"MongoDB Shell\", \"allUsers\" : [ { \"user\" : \"someuser\", \"db\" : \"admin\" } ], \"user\" : \"someuser@admin\" }   输出参考 对于任何单个操作，数据库探查器创建的文档将包括以下字段的子集。这些文档中字段的准确选择取决于操作的类型。\n从MongoDB 4.2（和4.0.9）开始，为了进行慢速操作，探查器条目和诊断日志消息包括storage信息。\nsystem.profile.op 操作类型。可能的值为：\n command count distinct geoNear getMore group insert mapReduce query remove update  system.profile.ns 操作目标的名称空间。 MongoDB中的命名空间采用数据库的形式，后跟一个点（。），然后是集合的名称。\nsystem.profile.command 在版本3.6中更改。\n包含与此操作关联的完整命令对象的文档。\n例如，以下输出包含对名为test的数据库中名为items的集合的find操作的命令对象：\n1 2 3 4 5 6 7 8  \"command\" : { \"find\" : \"items\", \"filter\" : { \"sku\" : 1403978 }, ... \"$db\" : \"test\" }   以下示例输出包含getMore操作的命令对象，该对象由光标ID为19234103609的命令在名为test的数据库中的名为items的集合上生成：\n1 2 3 4 5 6 7  \"command\" : { \"getMore\" : NumberLong(\"19234103609\"), \"collection\" : \"items\", \"batchSize\" : 10, ... \"$db\" : \"test\" },   如果命令文档超过50 KB，则该文档具有以下格式：\n1 2 3 4  \"command\" : { \"$truncated\": string, \"comment\": string }   $ truncated字段包含文档的字符串摘要，不包括文档的注释字段（如果存在）。如果摘要仍超过50 KB，则会被进一步截断，并在字符串末尾用省略号（…）表示。\n如果将注释comment传递给操作，则该字段存在。\nsystem.profile.originatingCommand 在版本3.6中更改。\n对于从光标检索下一批结果的“getmore”操作，originatingCommand字段包含最初创建该光标的完整命令对象（例如，find或aggregate）。\nsystem.profile.cursorid 通过query和getmore 操作访问的游标的ID 。\nsystem.profile.keysExamined 在版本3.2.0中进行了更改。\n从system.profile.nscanned重命名。 MongoDB扫描以执行操作的索引键的数量。\n通常，如果keysExamined大于nreturned，则数据库正在扫描许多索引键以查找结果文档。考虑创建或调整索引以提高查询性能。\n在版本3.4中更改。\nkeysExamined 可用于以下命令和操作：\n aggregate find（OP_QUERY和 command） findAndModify count distinct getMore（OP_GET_MORE和 command） mapReduce delete update  system.profile.docsExamined 在3.2.0版中进行了更改：从重新命名system.profile.nscannedObjects。\nMongoDB扫描以执行操作的集合中的文档数。\n在版本3.4中更改。\ndocsExamined 可用于以下命令和操作：\n aggregate find（OP_QUERY和 command） findAndModify count distinct getMore（OP_GET_MORE和 command） mapReduce delete update  system.profile.hasSortStage 在3.2.0版中进行了更改：从system.profile.scanAndOrder重新命名。\nhasSortStage是一个布尔值，表示true 查询无法使用索引中的排序来返回请求的排序结果；也就是说，MongoDB在从游标接收文档后必须对文档进行排序。该字段仅在值为true时出现。\n在版本3.4中更改。\nhasSortStage 可用于以下命令和操作：\n find（OP_QUERY和 command） getMore（OP_GET_MORE和 command） findAndModify mapReduce aggregate  system.profile.usedDisk 4.2版中的新功能。\n一个布尔值，指示由于内存限制，任何聚合阶段是否将数据写入临时文件。\n仅在usedDisk为true时出现。\nsystem.profile.ndeleted 操作删除的文档数。\nsystem.profile.ninserted 操作插入的文档数。\nsystem.profile.nMatched 符合system.profile.query 更新操作条件的文档数。\nsystem.profile.nModified 通过更新操作修改的文档数。\nsystem.profile.upsert 指示更新操作的upsert选项值的布尔值。仅在upsert为true时出现。\nsystem.profile.fromMultiPlanner 3.2.5版中的新功能。\n一个布尔值，指示查询计划者在选择查询的获胜执行计划之前是否评估了多个计划。\n仅在值为时存在true。\nsystem.profile.replanned 3.2.5版中的新功能。\n一个布尔值，指示查询系统是否收回了缓存的计划并重新评估了所有候选计划。\n仅在值为时存在true。\nsystem.profile.replanReason 版本4.2.6中的新功能。\n一个字符串，指示退出缓存的计划的特定原因 。\n因为只有当存在replanned为true时出现。\nsystem.profile.keysInserted 为给定的写操作插入的索引键的数量。\nsystem.profile.keysDeleted 在3.4中删除。\n在操作中更新更改的索引键的数量。更改索引键会降低性能成本，因为数据库必须删除旧键并将新键插入B树索引。\nsystem.profile.writeConflicts 写操作期间遇到的冲突数；例如，一个update操作试图与另一个update操作修改同一文档。另请参见写冲突。\nsystem.profile.numYield 操作产生的允许其他操作完成的次数。通常，操作在需要访问MongoDB尚未完全读入内存的数据时产生。这样，在MongoDB读取数据以进行yield操作时，可以完成内存中具有数据的其他操作。有关更多信息，请参见有关何时产生操作的常见问题解答。\nsystem.profile.queryHash 一个十六进制字符串，表示查询形状的哈希，并且仅取决于查询形状。queryHash可以帮助识别具有相同查询形状的慢查询（包括写操作的查询过滤器）。\n注意\n与任何哈希函数一样，两个不同的查询形状可能会导致相同的哈希值。但是，不同查询形状之间不会发生哈希冲突。\n有关详细信息queryHash，并planCacheKey请参阅 queryHash和planCacheKey。\n4.2版中的新功能。\nsystem.profile.planCacheKey 与查询关联的计划缓存条目的键的哈希值。\n与不同的是queryHash， planCacheKey是查询形状和该形状当前可用索引的函数。即，如果添加/删除了可以支持查询形状的索引，则该planCacheKey值可能会更改，而该queryHash值不会更改。\n有关详细信息queryHash，并planCacheKey请参阅 queryHash和planCacheKey。\n4.2版中的新功能。\nsystem.profile.locks 在system.profile.locks提供各种信息 的锁类型和锁模式运行期间举行。\n可能的锁定类型为：\n  ParallelBatchWriterMode\t:表示并行批处理写入器模式的锁。在早期版本中，PBWM信息被报告为Global锁定信息的一部分。4.2版中的新功能。\n  ReplicationStateTransition:表示为副本集成员状态转换使用的锁定。4.2版中的新功能。\n  Global:代表全局锁定。\n  Database\t表示数据库锁定。\n  Collection\t表示收集锁。\n  Mutex\t代表互斥体。\n  Metadata\t表示元数据锁定。\n  oplog\t表示锁定oplog。\n  锁定类型的可能锁定模式如下：\n   锁定模式 描述     R 表示共享（S）锁。   W 表示排他（X）锁。   r 表示意图共享（IS）锁。   w 表示Intent Exclusive（IX）锁。    返回的各种锁类型的锁信息包括：\nsystem.profile.locks.acquireCount 操作在指定模式下获得锁定的次数。\nsystem.profile.locks.acquireWaitCount acquireCount由于锁处于冲突模式下，操作必须等待锁获取的次数 。 acquireWaitCount小于或等于acquireCount。\nsystem.profile.locks.timeAcquiringMicros 操作必须等待以获取锁的累积时间（以微秒为单位）。\ntimeAcquiringMicros除以 acquireWaitCount给出特定锁定模式的近似平均等待时间。\nsystem.profile.locks.deadlockCount 操作在等待锁获取时遇到死锁的次数。\n有关锁定模式的更多信息，请参阅 MongoDB使用哪种锁定类型？。\nsystem.profile.storage 在新版本4.2： （在4.0.9也可启动）\n该system.profile.storage信息提供有关存储引擎数据和操作等待时间的指标。\n仅当值大于零时，才返回特定的存储指标。\nsystem.profile.storage.data.bytesRead 在新版本4.2： （在4.0.9也可启动）\n该操作从磁盘读取到高速缓存的字节数。\nsystem.profile.storage.data.timeReadingMicros 在新版本4.2： （在4.0.9也可启动）\n从磁盘读取操作必须花费的时间（以微秒为单位）。\nsystem.profile.storage.data.bytesWritten 在新版本4.2： （在4.0.9也可启动）\n该操作从缓存写入磁盘的字节数。\nsystem.profile.storage.data.timeWritingMicros 在新版本4.2： （在4.0.9也可启动）\n操作写入磁盘所花费的时间（以微秒为单位）。\nsystem.profile.storage.timeWaitingMicros.cache 在新版本4.2： （在4.0.9也可启动）\n操作必须等待缓存中的空间的时间（以微秒为单位）。\nsystem.profile.storage.timeWaitingMicros.schemaLock 在新版本4.2： （在4.0.9也可启动）\n操作（如果修改架构）必须等待以获取架构锁的时间（以微秒为单位）。\nsystem.profile.storage.timeWaitingMicros.handleLock 在新版本4.2： （在4.0.9也可启动）\n操作必须等待以获取所需数据句柄上的锁的时间（以微秒为单位）。\nsystem.profile.nreturned 操作返回的文档数。\nsystem.profile.responseLength 运算结果文档的字节长度。很大会 responseLength影响性能。要限制查询操作的结果文档的大小，可以使用以下任一方法：\n投影 The limit() method The batchSize() method 注意\n当MongoDB将查询配置文件信息写入日志时，该responseLength值位于名为的字段中reslen。\nsystem.profile.protocol 的MongoDB的有线协议请求消息的格式。\nsystem.profile.millis 从mongod操作开始到操作结束的时间，以毫秒为单位 。\nsystem.profile.planSummary 3.4版的新功能。\n执行计划摘要。\nsystem.profile.execStats 包含查询操作执行统计信息的文档。对于其他操作，该值为空文档。\nsystem.profile.execStats 以树的形式显示统计信息；每个节点提供在查询操作的该阶段执行的操作的统计信息。\n注意\n以下字段列表execStats 并不意味着要详尽无遗，因为返回的字段在每个阶段都有所不同。\nsystem.profile.execStats.stage 作为查询执行的一部分执行的操作的描述性名称；例如\n COLLSCAN 用于集合扫描 IXSCAN 用于扫描索引键 FETCH 用于检索文件  system.profile.execStats.inputStages 一个数组，其中包含作为当前阶段的输入阶段的操作的统计信息。\nsystem.profile.ts 操作的时间戳。\nsystem.profile.client 操作起源的客户端连接的IP地址或主机名。\nsystem.profile.appName 3.4版的新功能。\n运行该操作的客户端应用程序的标识符。使用appName连接字符串选项可以为appName字段设置自定义值。\nsystem.profile.allUsers 会话的经过身份验证的用户信息（用户名和数据库）的数组。另请参阅用户。\nsystem.profile.user 运行该操作的已认证用户。如果该操作不是由经过身份验证的用户运行的，则此字段的值为空字符串。\n",
  "wordCount" : "4452",
  "inLanguage": "zh-cn",
  "datePublished": "2020-06-09T15:11:50Z",
  "dateModified": "2020-06-09T15:11:50Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/mongodb%E7%9A%84%E6%8E%A2%E6%9F%A5%E5%99%A8%E8%BE%93%E5%87%BA/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      MongoDB的数据库探查器输出
    </h1>
    <div class="post-meta">June 9, 2020
</div>
  </header> 
  <div class="post-content"><h1 id="示例systemprofile文档">示例system.profile文档<a hidden class="anchor" aria-hidden="true" href="#示例systemprofile文档">#</a></h1>
<p>下面显示了在system.profile集合中找到的一些示例文档，这些文档可 用于独立运行：</p>
<p>以下文档system.profile反映了查找操作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;op&#34;</span> <span class="p">:</span> <span class="s2">&#34;query&#34;</span><span class="p">,</span>
   <span class="nt">&#34;ns&#34;</span> <span class="p">:</span> <span class="s2">&#34;test.report&#34;</span><span class="p">,</span>
   <span class="nt">&#34;command&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;find&#34;</span> <span class="p">:</span> <span class="s2">&#34;report&#34;</span><span class="p">,</span>
      <span class="nt">&#34;filter&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;a&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$lte&#34;</span> <span class="p">:</span> <span class="mi">500</span> <span class="p">}</span> <span class="p">},</span>
      <span class="nt">&#34;lsid&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;id&#34;</span> <span class="p">:</span> <span class="err">UUID(</span><span class="s2">&#34;5ccd5b81-b023-41f3-8959-bf99ed696ce9&#34;</span><span class="err">)</span>
      <span class="p">},</span>
      <span class="nt">&#34;$db&#34;</span> <span class="p">:</span> <span class="s2">&#34;test&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;cursorid&#34;</span> <span class="p">:</span> <span class="mi">33629063128</span><span class="p">,</span>
   <span class="nt">&#34;keysExamined&#34;</span> <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
   <span class="nt">&#34;docsExamined&#34;</span> <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
   <span class="nt">&#34;fromMultiPlanner&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="nt">&#34;numYield&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="nt">&#34;nreturned&#34;</span> <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
   <span class="nt">&#34;queryHash&#34;</span> <span class="p">:</span> <span class="s2">&#34;811451DD&#34;</span><span class="p">,</span>
   <span class="nt">&#34;planCacheKey&#34;</span> <span class="p">:</span> <span class="s2">&#34;759981BA&#34;</span><span class="p">,</span>
   <span class="nt">&#34;locks&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;Global&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;acquireCount&#34;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="nt">&#34;r&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">3</span><span class="err">)</span><span class="p">,</span>
            <span class="nt">&#34;w&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">3</span><span class="err">)</span>
         <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&#34;Database&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;acquireCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;r&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">3</span><span class="err">)</span> <span class="p">},</span>
         <span class="nt">&#34;acquireWaitCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;r&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">1</span><span class="err">)</span> <span class="p">},</span>
         <span class="nt">&#34;timeAcquiringMicros&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;r&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">69130694</span><span class="err">)</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&#34;Collection&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;acquireCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;r&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">3</span><span class="err">)</span> <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="nt">&#34;storage&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;data&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;bytesRead&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">14736</span><span class="err">)</span><span class="p">,</span>
         <span class="nt">&#34;timeReadingMicros&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">17</span><span class="err">)</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="nt">&#34;responseLength&#34;</span> <span class="p">:</span> <span class="mi">1305014</span><span class="p">,</span>
   <span class="nt">&#34;protocol&#34;</span> <span class="p">:</span> <span class="s2">&#34;op_msg&#34;</span><span class="p">,</span>
   <span class="nt">&#34;millis&#34;</span> <span class="p">:</span> <span class="mi">69132</span><span class="p">,</span>
   <span class="nt">&#34;planSummary&#34;</span> <span class="p">:</span> <span class="s2">&#34;IXSCAN { a: 1, _id: -1 }&#34;</span><span class="p">,</span>
   <span class="nt">&#34;execStats&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;stage&#34;</span> <span class="p">:</span> <span class="s2">&#34;FETCH&#34;</span><span class="p">,</span>
      <span class="nt">&#34;nReturned&#34;</span> <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
      <span class="nt">&#34;executionTimeMillisEstimate&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;works&#34;</span> <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
      <span class="nt">&#34;advanced&#34;</span> <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
      <span class="nt">&#34;needTime&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;needYield&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;saveState&#34;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="nt">&#34;restoreState&#34;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="nt">&#34;isEOF&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;docsExamined&#34;</span> <span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
      <span class="nt">&#34;alreadyHasObj&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;inputStage&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="err">...</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="nt">&#34;ts&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2019-01-14T16:57:33.450Z&#34;</span><span class="err">)</span><span class="p">,</span>
   <span class="nt">&#34;client&#34;</span> <span class="p">:</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
   <span class="nt">&#34;appName&#34;</span> <span class="p">:</span> <span class="s2">&#34;MongoDB Shell&#34;</span><span class="p">,</span>
   <span class="nt">&#34;allUsers&#34;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
         <span class="nt">&#34;user&#34;</span> <span class="p">:</span> <span class="s2">&#34;someuser&#34;</span><span class="p">,</span>
         <span class="nt">&#34;db&#34;</span> <span class="p">:</span> <span class="s2">&#34;admin&#34;</span>
      <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;user&#34;</span> <span class="p">:</span> <span class="s2">&#34;someuser@admin&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下示例反映了对名为report的集合的更新操作。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;op&#34;</span> <span class="p">:</span> <span class="s2">&#34;update&#34;</span><span class="p">,</span>
   <span class="nt">&#34;ns&#34;</span> <span class="p">:</span> <span class="s2">&#34;test.report&#34;</span><span class="p">,</span>
   <span class="nt">&#34;command&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;q&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="p">},</span>
      <span class="nt">&#34;u&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;$rename&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;a&#34;</span> <span class="p">:</span> <span class="s2">&#34;b&#34;</span> <span class="p">}</span> <span class="p">},</span>
      <span class="nt">&#34;multi&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nt">&#34;upsert&#34;</span> <span class="p">:</span> <span class="kc">false</span>
   <span class="p">},</span>
   <span class="nt">&#34;keysExamined&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
   <span class="nt">&#34;docsExamined&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
   <span class="nt">&#34;nMatched&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
   <span class="nt">&#34;nModified&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
   <span class="nt">&#34;keysInserted&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
   <span class="nt">&#34;keysDeleted&#34;</span> <span class="p">:</span> <span class="mi">25000000</span><span class="p">,</span>
   <span class="nt">&#34;numYield&#34;</span> <span class="p">:</span> <span class="mi">6985</span><span class="p">,</span>
   <span class="nt">&#34;locks&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;Global&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;acquireCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;r&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">6986</span><span class="err">)</span><span class="p">,</span> <span class="nt">&#34;w&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">13972</span><span class="err">)</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&#34;Database&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;acquireCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;w&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">6986</span><span class="err">)</span> <span class="p">},</span>
         <span class="nt">&#34;acquireWaitCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;w&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">1</span><span class="err">)</span> <span class="p">},</span>
         <span class="nt">&#34;timeAcquiringMicros&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;w&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">60899375</span><span class="err">)</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&#34;Collection&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;acquireCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;w&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">6986</span><span class="err">)</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="nt">&#34;Mutex&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;acquireCount&#34;</span> <span class="p">:</span> <span class="p">{</span> <span class="nt">&#34;r&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">25000</span><span class="err">)</span> <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="nt">&#34;storage&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;data&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;bytesRead&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">126344060</span><span class="err">)</span><span class="p">,</span>
         <span class="nt">&#34;bytesWritten&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">281834762</span><span class="err">)</span><span class="p">,</span>
         <span class="nt">&#34;timeReadingMicros&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">94549</span><span class="err">)</span><span class="p">,</span>
         <span class="nt">&#34;timeWritingMicros&#34;</span> <span class="p">:</span> <span class="err">NumberLong(</span><span class="mi">139361</span><span class="err">)</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="nt">&#34;millis&#34;</span> <span class="p">:</span> <span class="mi">164687</span><span class="p">,</span>
   <span class="nt">&#34;planSummary&#34;</span> <span class="p">:</span> <span class="s2">&#34;COLLSCAN&#34;</span><span class="p">,</span>
   <span class="nt">&#34;execStats&#34;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;stage&#34;</span> <span class="p">:</span> <span class="s2">&#34;UPDATE&#34;</span><span class="p">,</span>
      <span class="nt">&#34;nReturned&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;executionTimeMillisEstimate&#34;</span> <span class="p">:</span> <span class="mi">103771</span><span class="p">,</span>
      <span class="nt">&#34;works&#34;</span> <span class="p">:</span> <span class="mi">25003</span><span class="p">,</span>
      <span class="nt">&#34;advanced&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;needTime&#34;</span> <span class="p">:</span> <span class="mi">25002</span><span class="p">,</span>
      <span class="nt">&#34;needYield&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&#34;saveState&#34;</span> <span class="p">:</span> <span class="mi">6985</span><span class="p">,</span>
      <span class="nt">&#34;restoreState&#34;</span> <span class="p">:</span> <span class="mi">6985</span><span class="p">,</span>
      <span class="nt">&#34;isEOF&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nt">&#34;nMatched&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
      <span class="nt">&#34;nWouldModify&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
      <span class="nt">&#34;wouldInsert&#34;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nt">&#34;inputStage&#34;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&#34;stage&#34;</span> <span class="p">:</span> <span class="s2">&#34;COLLSCAN&#34;</span><span class="p">,</span>
         <span class="nt">&#34;nReturned&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
         <span class="nt">&#34;executionTimeMillisEstimate&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
         <span class="nt">&#34;works&#34;</span> <span class="p">:</span> <span class="mi">25002</span><span class="p">,</span>
         <span class="nt">&#34;advanced&#34;</span> <span class="p">:</span> <span class="mi">25000</span><span class="p">,</span>
         <span class="nt">&#34;needTime&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="nt">&#34;needYield&#34;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
         <span class="nt">&#34;saveState&#34;</span> <span class="p">:</span> <span class="mi">31985</span><span class="p">,</span>
         <span class="nt">&#34;restoreState&#34;</span> <span class="p">:</span> <span class="mi">31985</span><span class="p">,</span>
         <span class="nt">&#34;isEOF&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="nt">&#34;direction&#34;</span> <span class="p">:</span> <span class="s2">&#34;forward&#34;</span><span class="p">,</span>
         <span class="nt">&#34;docsExamined&#34;</span> <span class="p">:</span> <span class="mi">25000</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="nt">&#34;ts&#34;</span> <span class="p">:</span> <span class="err">ISODate(</span><span class="s2">&#34;2019-01-14T23:33:01.806Z&#34;</span><span class="err">)</span><span class="p">,</span>
   <span class="nt">&#34;client&#34;</span> <span class="p">:</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
   <span class="nt">&#34;appName&#34;</span> <span class="p">:</span> <span class="s2">&#34;MongoDB Shell&#34;</span><span class="p">,</span>
   <span class="nt">&#34;allUsers&#34;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
         <span class="nt">&#34;user&#34;</span> <span class="p">:</span> <span class="s2">&#34;someuser&#34;</span><span class="p">,</span>
         <span class="nt">&#34;db&#34;</span> <span class="p">:</span> <span class="s2">&#34;admin&#34;</span>
      <span class="p">}</span>
   <span class="p">],</span>
   <span class="nt">&#34;user&#34;</span> <span class="p">:</span> <span class="s2">&#34;someuser@admin&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="输出参考">输出参考<a hidden class="anchor" aria-hidden="true" href="#输出参考">#</a></h1>
<p>对于任何单个操作，数据库探查器创建的文档将包括以下字段的子集。这些文档中字段的准确选择取决于操作的类型。</p>
<p>从MongoDB 4.2（和4.0.9）开始，为了进行慢速操作，探查器条目和诊断日志消息包括storage信息。</p>
<h2 id="systemprofileop">system.profile.op<a hidden class="anchor" aria-hidden="true" href="#systemprofileop">#</a></h2>
<p>操作类型。可能的值为：</p>
<ul>
<li>command</li>
<li>count</li>
<li>distinct</li>
<li>geoNear</li>
<li>getMore</li>
<li>group</li>
<li>insert</li>
<li>mapReduce</li>
<li>query</li>
<li>remove</li>
<li>update</li>
</ul>
<h2 id="systemprofilens">system.profile.ns<a hidden class="anchor" aria-hidden="true" href="#systemprofilens">#</a></h2>
<p>操作目标的名称空间。 MongoDB中的命名空间采用数据库的形式，后跟一个点（。），然后是集合的名称。</p>
<h2 id="systemprofilecommand">system.profile.command<a hidden class="anchor" aria-hidden="true" href="#systemprofilecommand">#</a></h2>
<p>在版本3.6中更改。</p>
<p>包含与此操作关联的完整命令对象的文档。</p>
<p>例如，以下输出包含对名为test的数据库中名为items的集合的find操作的命令对象：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="s">&#34;command&#34;</span> <span class="o">:</span> <span class="p">{</span>
  <span class="s">&#34;find&#34;</span> <span class="o">:</span> <span class="s">&#34;items&#34;</span><span class="p">,</span>
  <span class="s">&#34;filter&#34;</span> <span class="o">:</span> <span class="p">{</span>
    <span class="s">&#34;sku&#34;</span> <span class="o">:</span> <span class="m">1403978</span>
  <span class="p">},</span>
  <span class="kc">...</span>
  <span class="s">&#34;$db&#34;</span> <span class="o">:</span> <span class="s">&#34;test&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以下示例输出包含getMore操作的命令对象，该对象由光标ID为19234103609的命令在名为test的数据库中的名为items的集合上生成：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="s">&#34;command&#34;</span> <span class="o">:</span> <span class="p">{</span>
    <span class="s">&#34;getMore&#34;</span> <span class="o">:</span> <span class="nf">NumberLong</span><span class="p">(</span><span class="s">&#34;19234103609&#34;</span><span class="p">),</span>
    <span class="s">&#34;collection&#34;</span> <span class="o">:</span> <span class="s">&#34;items&#34;</span><span class="p">,</span>
    <span class="s">&#34;batchSize&#34;</span> <span class="o">:</span> <span class="m">10</span><span class="p">,</span>
    <span class="kc">...</span>
    <span class="s">&#34;$db&#34;</span> <span class="o">:</span> <span class="s">&#34;test&#34;</span>
<span class="p">},</span>
</code></pre></td></tr></table>
</div>
</div><p>如果命令文档超过50 KB，则该文档具有以下格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="s">&#34;command&#34;</span> <span class="o">:</span> <span class="p">{</span>
  <span class="s">&#34;$truncated&#34;</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="s">&#34;comment&#34;</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>$ truncated字段包含文档的字符串摘要，不包括文档的注释字段（如果存在）。如果摘要仍超过50 KB，则会被进一步截断，并在字符串末尾用省略号（&hellip;）表示。</p>
<p>如果将注释comment传递给操作，则该字段存在。</p>
<h2 id="systemprofileoriginatingcommand">system.profile.originatingCommand<a hidden class="anchor" aria-hidden="true" href="#systemprofileoriginatingcommand">#</a></h2>
<p>在版本3.6中更改。</p>
<p>对于从光标检索下一批结果的“getmore”操作，originatingCommand字段包含最初创建该光标的完整命令对象（例如，find或aggregate）。</p>
<h2 id="systemprofilecursorid">system.profile.cursorid<a hidden class="anchor" aria-hidden="true" href="#systemprofilecursorid">#</a></h2>
<p>通过query和getmore 操作访问的游标的ID 。</p>
<h2 id="systemprofilekeysexamined">system.profile.keysExamined<a hidden class="anchor" aria-hidden="true" href="#systemprofilekeysexamined">#</a></h2>
<p>在版本3.2.0中进行了更改。</p>
<p>从system.profile.nscanned重命名。 MongoDB扫描以执行操作的索引键的数量。</p>
<p>通常，如果keysExamined大于nreturned，则数据库正在扫描许多索引键以查找结果文档。考虑创建或调整索引以提高查询性能。</p>
<p>在版本3.4中更改。</p>
<p>keysExamined 可用于以下命令和操作：</p>
<ul>
<li>aggregate</li>
<li>find（OP_QUERY和 command）</li>
<li>findAndModify</li>
<li>count</li>
<li>distinct</li>
<li>getMore（OP_GET_MORE和 command）</li>
<li>mapReduce</li>
<li>delete</li>
<li>update</li>
</ul>
<h2 id="systemprofiledocsexamined">system.profile.docsExamined<a hidden class="anchor" aria-hidden="true" href="#systemprofiledocsexamined">#</a></h2>
<p>在3.2.0版中进行了更改：从重新命名system.profile.nscannedObjects。</p>
<p>MongoDB扫描以执行操作的集合中的文档数。</p>
<p>在版本3.4中更改。</p>
<p>docsExamined 可用于以下命令和操作：</p>
<ul>
<li>aggregate</li>
<li>find（OP_QUERY和 command）</li>
<li>findAndModify</li>
<li>count</li>
<li>distinct</li>
<li>getMore（OP_GET_MORE和 command）</li>
<li>mapReduce</li>
<li>delete</li>
<li>update</li>
</ul>
<h2 id="systemprofilehassortstage">system.profile.hasSortStage<a hidden class="anchor" aria-hidden="true" href="#systemprofilehassortstage">#</a></h2>
<p>在3.2.0版中进行了更改：从system.profile.scanAndOrder重新命名。</p>
<p>hasSortStage是一个布尔值，表示true 查询无法使用索引中的排序来返回请求的排序结果；也就是说，MongoDB在从游标接收文档后必须对文档进行排序。该字段仅在值为true时出现。</p>
<p>在版本3.4中更改。</p>
<p>hasSortStage 可用于以下命令和操作：</p>
<ul>
<li>find（OP_QUERY和 command）</li>
<li>getMore（OP_GET_MORE和 command）</li>
<li>findAndModify</li>
<li>mapReduce</li>
<li>aggregate</li>
</ul>
<h2 id="systemprofileuseddisk">system.profile.usedDisk<a hidden class="anchor" aria-hidden="true" href="#systemprofileuseddisk">#</a></h2>
<p>4.2版中的新功能。</p>
<p>一个布尔值，指示由于内存限制，任何聚合阶段是否将数据写入临时文件。</p>
<p>仅在usedDisk为true时出现。</p>
<h2 id="systemprofilendeleted">system.profile.ndeleted<a hidden class="anchor" aria-hidden="true" href="#systemprofilendeleted">#</a></h2>
<p>操作删除的文档数。</p>
<h2 id="systemprofileninserted">system.profile.ninserted<a hidden class="anchor" aria-hidden="true" href="#systemprofileninserted">#</a></h2>
<p>操作插入的文档数。</p>
<h2 id="systemprofilenmatched">system.profile.nMatched<a hidden class="anchor" aria-hidden="true" href="#systemprofilenmatched">#</a></h2>
<p>符合system.profile.query 更新操作条件的文档数。</p>
<h2 id="systemprofilenmodified">system.profile.nModified<a hidden class="anchor" aria-hidden="true" href="#systemprofilenmodified">#</a></h2>
<p>通过更新操作修改的文档数。</p>
<h2 id="systemprofileupsert">system.profile.upsert<a hidden class="anchor" aria-hidden="true" href="#systemprofileupsert">#</a></h2>
<p>指示更新操作的upsert选项值的布尔值。仅在upsert为true时出现。</p>
<h2 id="systemprofilefrommultiplanner">system.profile.fromMultiPlanner<a hidden class="anchor" aria-hidden="true" href="#systemprofilefrommultiplanner">#</a></h2>
<p>3.2.5版中的新功能。</p>
<p>一个布尔值，指示查询计划者在选择查询的获胜执行计划之前是否评估了多个计划。</p>
<p>仅在值为时存在true。</p>
<h2 id="systemprofilereplanned">system.profile.replanned<a hidden class="anchor" aria-hidden="true" href="#systemprofilereplanned">#</a></h2>
<p>3.2.5版中的新功能。</p>
<p>一个布尔值，指示查询系统是否收回了缓存的计划并重新评估了所有候选计划。</p>
<p>仅在值为时存在true。</p>
<h2 id="systemprofilereplanreason">system.profile.replanReason<a hidden class="anchor" aria-hidden="true" href="#systemprofilereplanreason">#</a></h2>
<p>版本4.2.6中的新功能。</p>
<p>一个字符串，指示退出缓存的计划的特定原因 。</p>
<p>因为只有当存在replanned为true时出现。</p>
<h2 id="systemprofilekeysinserted">system.profile.keysInserted<a hidden class="anchor" aria-hidden="true" href="#systemprofilekeysinserted">#</a></h2>
<p>为给定的写操作插入的索引键的数量。</p>
<h2 id="systemprofilekeysdeleted">system.profile.keysDeleted<a hidden class="anchor" aria-hidden="true" href="#systemprofilekeysdeleted">#</a></h2>
<p>在3.4中删除。</p>
<p>在操作中更新更改的索引键的数量。更改索引键会降低性能成本，因为数据库必须删除旧键并将新键插入B树索引。</p>
<h2 id="systemprofilewriteconflicts">system.profile.writeConflicts<a hidden class="anchor" aria-hidden="true" href="#systemprofilewriteconflicts">#</a></h2>
<p>写操作期间遇到的冲突数；例如，一个update操作试图与另一个update操作修改同一文档。另请参见写冲突。</p>
<h2 id="systemprofilenumyield">system.profile.numYield<a hidden class="anchor" aria-hidden="true" href="#systemprofilenumyield">#</a></h2>
<p>操作产生的允许其他操作完成的次数。通常，操作在需要访问MongoDB尚未完全读入内存的数据时产生。这样，在MongoDB读取数据以进行yield操作时，可以完成内存中具有数据的其他操作。有关更多信息，请参见有关何时产生操作的常见问题解答。</p>
<h2 id="systemprofilequeryhash">system.profile.queryHash<a hidden class="anchor" aria-hidden="true" href="#systemprofilequeryhash">#</a></h2>
<p>一个十六进制字符串，表示查询形状的哈希，并且仅取决于查询形状。queryHash可以帮助识别具有相同查询形状的慢查询（包括写操作的查询过滤器）。</p>
<p>注意</p>
<p>与任何哈希函数一样，两个不同的查询形状可能会导致相同的哈希值。但是，不同查询形状之间不会发生哈希冲突。</p>
<p>有关详细信息queryHash，并planCacheKey请参阅 <a href="https://docs.mongodb.com/manual/core/query-plans/#query-hash-plan-cache-key">queryHash和planCacheKey</a>。</p>
<p>4.2版中的新功能。</p>
<h2 id="systemprofileplancachekey">system.profile.planCacheKey<a hidden class="anchor" aria-hidden="true" href="#systemprofileplancachekey">#</a></h2>
<p>与查询关联的计划缓存条目的键的哈希值。</p>
<p>与不同的是queryHash， planCacheKey是查询形状和该形状当前可用索引的函数。即，如果添加/删除了可以支持查询形状的索引，则该planCacheKey值可能会更改，而该queryHash值不会更改。</p>
<p>有关详细信息queryHash，并planCacheKey请参阅 queryHash和planCacheKey。</p>
<p>4.2版中的新功能。</p>
<h2 id="systemprofilelocks">system.profile.locks<a hidden class="anchor" aria-hidden="true" href="#systemprofilelocks">#</a></h2>
<p>在system.profile.locks提供各种信息 的锁类型和锁模式运行期间举行。</p>
<p>可能的锁定类型为：</p>
<ul>
<li>
<p>ParallelBatchWriterMode	:表示并行批处理写入器模式的锁。在早期版本中，PBWM信息被报告为Global锁定信息的一部分。4.2版中的新功能。</p>
</li>
<li>
<p>ReplicationStateTransition:表示为副本集成员状态转换使用的锁定。4.2版中的新功能。</p>
</li>
<li>
<p>Global:代表全局锁定。</p>
</li>
<li>
<p>Database	表示数据库锁定。</p>
</li>
<li>
<p>Collection	表示收集锁。</p>
</li>
<li>
<p>Mutex	代表互斥体。</p>
</li>
<li>
<p>Metadata	表示元数据锁定。</p>
</li>
<li>
<p>oplog	表示锁定oplog。</p>
</li>
</ul>
<p>锁定类型的可能锁定模式如下：</p>
<table>
<thead>
<tr>
<th>锁定模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>R</td>
<td>表示共享（S）锁。</td>
</tr>
<tr>
<td>W</td>
<td>表示排他（X）锁。</td>
</tr>
<tr>
<td>r</td>
<td>表示意图共享（IS）锁。</td>
</tr>
<tr>
<td>w</td>
<td>表示Intent Exclusive（IX）锁。</td>
</tr>
</tbody>
</table>
<p>返回的各种锁类型的锁信息包括：</p>
<h3 id="systemprofilelocksacquirecount">system.profile.locks.acquireCount<a hidden class="anchor" aria-hidden="true" href="#systemprofilelocksacquirecount">#</a></h3>
<p>操作在指定模式下获得锁定的次数。</p>
<h3 id="systemprofilelocksacquirewaitcount">system.profile.locks.acquireWaitCount<a hidden class="anchor" aria-hidden="true" href="#systemprofilelocksacquirewaitcount">#</a></h3>
<p>acquireCount由于锁处于冲突模式下，操作必须等待锁获取的次数 。 acquireWaitCount小于或等于acquireCount。</p>
<h3 id="systemprofilelockstimeacquiringmicros">system.profile.locks.timeAcquiringMicros<a hidden class="anchor" aria-hidden="true" href="#systemprofilelockstimeacquiringmicros">#</a></h3>
<p>操作必须等待以获取锁的累积时间（以微秒为单位）。</p>
<p>timeAcquiringMicros除以 acquireWaitCount给出特定锁定模式的近似平均等待时间。</p>
<h3 id="systemprofilelocksdeadlockcount">system.profile.locks.deadlockCount<a hidden class="anchor" aria-hidden="true" href="#systemprofilelocksdeadlockcount">#</a></h3>
<p>操作在等待锁获取时遇到死锁的次数。</p>
<p>有关锁定模式的更多信息，请参阅 MongoDB使用哪种锁定类型？。</p>
<h2 id="systemprofilestorage">system.profile.storage<a hidden class="anchor" aria-hidden="true" href="#systemprofilestorage">#</a></h2>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>该system.profile.storage信息提供有关存储引擎数据和操作等待时间的指标。</p>
<p>仅当值大于零时，才返回特定的存储指标。</p>
<h3 id="systemprofilestoragedatabytesread">system.profile.storage.data.bytesRead<a hidden class="anchor" aria-hidden="true" href="#systemprofilestoragedatabytesread">#</a></h3>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>该操作从磁盘读取到高速缓存的字节数。</p>
<h3 id="systemprofilestoragedatatimereadingmicros">system.profile.storage.data.timeReadingMicros<a hidden class="anchor" aria-hidden="true" href="#systemprofilestoragedatatimereadingmicros">#</a></h3>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>从磁盘读取操作必须花费的时间（以微秒为单位）。</p>
<h3 id="systemprofilestoragedatabyteswritten">system.profile.storage.data.bytesWritten<a hidden class="anchor" aria-hidden="true" href="#systemprofilestoragedatabyteswritten">#</a></h3>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>该操作从缓存写入磁盘的字节数。</p>
<h3 id="systemprofilestoragedatatimewritingmicros">system.profile.storage.data.timeWritingMicros<a hidden class="anchor" aria-hidden="true" href="#systemprofilestoragedatatimewritingmicros">#</a></h3>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>操作写入磁盘所花费的时间（以微秒为单位）。</p>
<h3 id="systemprofilestoragetimewaitingmicroscache">system.profile.storage.timeWaitingMicros.cache<a hidden class="anchor" aria-hidden="true" href="#systemprofilestoragetimewaitingmicroscache">#</a></h3>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>操作必须等待缓存中的空间的时间（以微秒为单位）。</p>
<h3 id="systemprofilestoragetimewaitingmicrosschemalock">system.profile.storage.timeWaitingMicros.schemaLock<a hidden class="anchor" aria-hidden="true" href="#systemprofilestoragetimewaitingmicrosschemalock">#</a></h3>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>操作（如果修改架构）必须等待以获取架构锁的时间（以微秒为单位）。</p>
<h3 id="systemprofilestoragetimewaitingmicroshandlelock">system.profile.storage.timeWaitingMicros.handleLock<a hidden class="anchor" aria-hidden="true" href="#systemprofilestoragetimewaitingmicroshandlelock">#</a></h3>
<p>在新版本4.2： （在4.0.9也可启动）</p>
<p>操作必须等待以获取所需数据句柄上的锁的时间（以微秒为单位）。</p>
<h2 id="systemprofilenreturned">system.profile.nreturned<a hidden class="anchor" aria-hidden="true" href="#systemprofilenreturned">#</a></h2>
<p>操作返回的文档数。</p>
<h2 id="systemprofileresponselength">system.profile.responseLength<a hidden class="anchor" aria-hidden="true" href="#systemprofileresponselength">#</a></h2>
<p>运算结果文档的字节长度。很大会 responseLength影响性能。要限制查询操作的结果文档的大小，可以使用以下任一方法：</p>
<p>投影
The limit() method
The batchSize() method
注意</p>
<p>当MongoDB将查询配置文件信息写入日志时，该responseLength值位于名为的字段中reslen。</p>
<h2 id="systemprofileprotocol">system.profile.protocol<a hidden class="anchor" aria-hidden="true" href="#systemprofileprotocol">#</a></h2>
<p>的MongoDB的有线协议请求消息的格式。</p>
<h2 id="systemprofilemillis">system.profile.millis<a hidden class="anchor" aria-hidden="true" href="#systemprofilemillis">#</a></h2>
<p>从mongod操作开始到操作结束的时间，以毫秒为单位 。</p>
<h2 id="systemprofileplansummary">system.profile.planSummary<a hidden class="anchor" aria-hidden="true" href="#systemprofileplansummary">#</a></h2>
<p>3.4版的新功能。</p>
<p>执行计划摘要。</p>
<h2 id="systemprofileexecstats">system.profile.execStats<a hidden class="anchor" aria-hidden="true" href="#systemprofileexecstats">#</a></h2>
<p>包含查询操作执行统计信息的文档。对于其他操作，该值为空文档。</p>
<h2 id="systemprofileexecstats-1">system.profile.execStats<a hidden class="anchor" aria-hidden="true" href="#systemprofileexecstats-1">#</a></h2>
<p>以树的形式显示统计信息；每个节点提供在查询操作的该阶段执行的操作的统计信息。</p>
<p>注意</p>
<p>以下字段列表execStats 并不意味着要详尽无遗，因为返回的字段在每个阶段都有所不同。</p>
<h2 id="systemprofileexecstatsstage">system.profile.execStats.stage<a hidden class="anchor" aria-hidden="true" href="#systemprofileexecstatsstage">#</a></h2>
<p>作为查询执行的一部分执行的操作的描述性名称；例如</p>
<ul>
<li>COLLSCAN 用于集合扫描</li>
<li>IXSCAN 用于扫描索引键</li>
<li>FETCH 用于检索文件</li>
</ul>
<h2 id="systemprofileexecstatsinputstages">system.profile.execStats.inputStages<a hidden class="anchor" aria-hidden="true" href="#systemprofileexecstatsinputstages">#</a></h2>
<p>一个数组，其中包含作为当前阶段的输入阶段的操作的统计信息。</p>
<h2 id="systemprofilets">system.profile.ts<a hidden class="anchor" aria-hidden="true" href="#systemprofilets">#</a></h2>
<p>操作的时间戳。</p>
<h2 id="systemprofileclient">system.profile.client<a hidden class="anchor" aria-hidden="true" href="#systemprofileclient">#</a></h2>
<p>操作起源的客户端连接的IP地址或主机名。</p>
<h2 id="systemprofileappname">system.profile.appName<a hidden class="anchor" aria-hidden="true" href="#systemprofileappname">#</a></h2>
<p>3.4版的新功能。</p>
<p>运行该操作的客户端应用程序的标识符。使用appName连接字符串选项可以为appName字段设置自定义值。</p>
<h2 id="systemprofileallusers">system.profile.allUsers<a hidden class="anchor" aria-hidden="true" href="#systemprofileallusers">#</a></h2>
<p>会话的经过身份验证的用户信息（用户名和数据库）的数组。另请参阅用户。</p>
<h2 id="systemprofileuser">system.profile.user<a hidden class="anchor" aria-hidden="true" href="#systemprofileuser">#</a></h2>
<p>运行该操作的已认证用户。如果该操作不是由经过身份验证的用户运行的，则此字段的值为空字符串。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/mongodb/">MongoDB</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
