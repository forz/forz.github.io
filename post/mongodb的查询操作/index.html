<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MongoDB的查询操作 | Forz Blog</title>
<meta name="keywords" content="MongoDB" />
<meta name="description" content="示例集合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 docs := []interface{}{ bson.D{ {&#34;item&#34;, &#34;journal&#34;}, {&#34;qty&#34;, 25}, {&#34;size&#34;, bson.D{ {&#34;h&#34;, 14},">
<meta name="author" content="">
<link rel="canonical" href="/post/mongodb%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.00d5d4fc479b1575183ee8d86b4fb372ba9d9b1904e96fa8e4c40ff7debe2b94.css" integrity="sha256-ANXU/EebFXUYPujYa0&#43;zcrqdmxkE6W&#43;o5MQP996&#43;K5Q=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.87.0" />
<meta property="og:title" content="MongoDB的查询操作" />
<meta property="og:description" content="示例集合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 docs := []interface{}{ bson.D{ {&#34;item&#34;, &#34;journal&#34;}, {&#34;qty&#34;, 25}, {&#34;size&#34;, bson.D{ {&#34;h&#34;, 14}," />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/mongodb%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-05-10T22:50:11&#43;00:00" />
<meta property="article:modified_time" content="2020-05-10T22:50:11&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MongoDB的查询操作"/>
<meta name="twitter:description" content="示例集合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 docs := []interface{}{ bson.D{ {&#34;item&#34;, &#34;journal&#34;}, {&#34;qty&#34;, 25}, {&#34;size&#34;, bson.D{ {&#34;h&#34;, 14},"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/post/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "MongoDB的查询操作",
      "item": "/post/mongodb%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MongoDB的查询操作",
  "name": "MongoDB的查询操作",
  "description": "示例集合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 docs := []interface{}{ bson.D{ {\u0026#34;item\u0026#34;, \u0026#34;journal\u0026#34;}, {\u0026#34;qty\u0026#34;, 25}, {\u0026#34;size\u0026#34;, bson.D{ {\u0026#34;h\u0026#34;, 14},",
  "keywords": [
    "MongoDB"
  ],
  "articleBody": "示例集合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  docs := []interface{}{ bson.D{ {\"item\", \"journal\"}, {\"qty\", 25}, {\"size\", bson.D{ {\"h\", 14}, {\"w\", 21}, {\"uom\", \"cm\"}, }}, {\"status\", \"A\"}, }, bson.D{ {\"item\", \"notebook\"}, {\"qty\", 50}, {\"size\", bson.D{ {\"h\", 8.5}, {\"w\", 11}, {\"uom\", \"in\"}, }}, {\"status\", \"A\"}, }, bson.D{ {\"item\", \"paper\"}, {\"qty\", 100}, {\"size\", bson.D{ {\"h\", 8.5}, {\"w\", 11}, {\"uom\", \"in\"}, }}, {\"status\", \"D\"}, }, bson.D{ {\"item\", \"planner\"}, {\"qty\", 75}, {\"size\", bson.D{ {\"h\", 22.85}, {\"w\", 30}, {\"uom\", \"cm\"}, }}, {\"status\", \"D\"}, }, bson.D{ {\"item\", \"postcard\"}, {\"qty\", 45}, {\"size\", bson.D{ {\"h\", 10}, {\"w\", 15.25}, {\"uom\", \"cm\"}, }}, {\"status\", \"A\"}, }, } result, err := coll.InsertMany(context.Background(), docs)   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  docs := []interface{}{ bson.D{ {\"item\", \"journal\"}, {\"qty\", 25}, {\"tags\", bson.A{\"blank\", \"red\"}}, {\"dim_cm\", bson.A{14, 21}}, }, bson.D{ {\"item\", \"notebook\"}, {\"qty\", 50}, {\"tags\", bson.A{\"red\", \"blank\"}}, {\"dim_cm\", bson.A{14, 21}}, }, bson.D{ {\"item\", \"paper\"}, {\"qty\", 100}, {\"tags\", bson.A{\"red\", \"blank\", \"plain\"}}, {\"dim_cm\", bson.A{14, 21}}, }, bson.D{ {\"item\", \"planner\"}, {\"qty\", 75}, {\"tags\", bson.A{\"blank\", \"red\"}}, {\"dim_cm\", bson.A{22.85, 30}}, }, bson.D{ {\"item\", \"postcard\"}, {\"qty\", 45}, {\"tags\", bson.A{\"blue\"}}, {\"dim_cm\", bson.A{10, 15.25}}, }, } result, err := coll.InsertMany(context.Background(), docs)   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65  docs := []interface{}{ bson.D{ {\"item\", \"journal\"}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"A\"}, {\"qty\", 5}, }, bson.D{ {\"warehouse\", \"C\"}, {\"qty\", 15}, }, }}, }, bson.D{ {\"item\", \"notebook\"}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"C\"}, {\"qty\", 5}, }, }}, }, bson.D{ {\"item\", \"paper\"}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"A\"}, {\"qty\", 60}, }, bson.D{ {\"warehouse\", \"B\"}, {\"qty\", 15}, }, }}, }, bson.D{ {\"item\", \"planner\"}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"A\"}, {\"qty\", 40}, }, bson.D{ {\"warehouse\", \"B\"}, {\"qty\", 5}, }, }}, }, bson.D{ {\"item\", \"postcard\"}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"B\"}, {\"qty\", 15}, }, bson.D{ {\"warehouse\", \"C\"}, {\"qty\", 35}, }, }}, }, } result, err := coll.InsertMany(context.Background(), docs)   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  docs := []interface{}{ bson.D{ {\"item\", \"journal\"}, {\"status\", \"A\"}, {\"size\", bson.D{ {\"h\", 14}, {\"w\", 21}, {\"uom\", \"cm\"}, }}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"A\"}, {\"qty\", 5}, }, }}, }, bson.D{ {\"item\", \"notebook\"}, {\"status\", \"A\"}, {\"size\", bson.D{ {\"h\", 8.5}, {\"w\", 11}, {\"uom\", \"in\"}, }}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"EC\"}, {\"qty\", 5}, }, }}, }, bson.D{ {\"item\", \"paper\"}, {\"status\", \"D\"}, {\"size\", bson.D{ {\"h\", 8.5}, {\"w\", 11}, {\"uom\", \"in\"}, }}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"A\"}, {\"qty\", 60}, }, }}, }, bson.D{ {\"item\", \"planner\"}, {\"status\", \"D\"}, {\"size\", bson.D{ {\"h\", 22.85}, {\"w\", 30}, {\"uom\", \"cm\"}, }}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"A\"}, {\"qty\", 40}, }, }}, }, bson.D{ {\"item\", \"postcard\"}, {\"status\", \"A\"}, {\"size\", bson.D{ {\"h\", 10}, {\"w\", 15.25}, {\"uom\", \"cm\"}, }}, {\"instock\", bson.A{ bson.D{ {\"warehouse\", \"B\"}, {\"qty\", 15}, }, bson.D{ {\"warehouse\", \"EC\"}, {\"qty\", 35}, }, }}, }, } result, err := coll.InsertMany(context.Background(), docs)   1 2 3 4 5 6 7 8 9 10 11  docs := []interface{}{ bson.D{ {\"_id\", 1}, {\"item\", nil}, }, bson.D{ {\"_id\", 2}, }, } result, err := coll.InsertMany(context.Background(), docs)   选择集合中的所有文档 要选择集合中的所有文档，请将空文档作为查询过滤器参数传递给find方法。查询过滤器参数确定选择条件：\n1 2 3 4  cursor, err := coll.Find( context.Background(), bson.D{}, )   此操作对应于以下SQL语句：\n1  SELECT*FROMinventory  指定相等条件 以下示例从inventory集合中选择status等于\"D\"的所有文档：\n1 2 3 4  cursor, err := coll.Find( context.Background(), bson.D{{\"status\", \"D\"}}, )   此操作对应于以下SQL语句：\n1  SELECT*FROMinventoryWHEREstatus=\"D\"  查询运算符 以下示例从inventory 集合中检索status等于\"A\"或\"D\"的所有文档：\n1 2 3  cursor, err := coll.Find( context.Background(), bson.D{{\"status\", bson.D{{\"$in\", bson.A{\"A\", \"D\"}}}}})   注意\n尽管可以使用$or运算符表示此查询，但是在同一字段上执行相等性检查时，请使用$in运算符而不是$or运算符。\n该操作对应于以下SQL语句：\n1  SELECT * FROM inventory WHERE status in (\"A\", \"D\")   有关MongoDB查询运算符的完整列表，请参阅查询和投影运算符文档。\n指定AND条件 复合查询可以为集合文档中的多个字段指定条件。AND将复合查询的子句连接起来，以便查询选择集合中符合所有条件的文档。\n以下示例检索inventory集合中status等于\"A\" 且qty小于（$lt）30的所有文档：\n1 2 3 4 5 6  cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, {\"qty\", bson.D{{\"$lt\", 30}}}, })   该操作对应于以下SQL语句：\n1  SELECT*FROMinventoryWHEREstatus=\"A\"ANDqty30  有关其他MongoDB比较运算符，请参阅比较运算符。\n指定OR条件 使用$or运算符，您可以指定一个复合查询，该查询将每个子句与一个逻辑连接符连接在一起，OR以便该查询选择集合中至少匹配一个条件的文档。\n以下示例检索集合中status等于\"A\"或qty小于（$lt）30的所有文档：\n1 2 3 4 5 6 7 8 9  cursor, err := coll.Find( context.Background(), bson.D{ {\"$or\", bson.A{ bson.D{{\"status\", \"A\"}}, bson.D{{\"qty\", bson.D{{\"$lt\", 30}}}}, }}, })   该操作对应于以下SQL语句：\n1  SELECT*FROMinventoryWHEREstatus=\"A\"ORqty30  注意\n使用比较运算符的查询 需进行类型包围。\n指定AND和OR条件 在下面的例子中，复合查询中选择该集合中的所有文档，其中status等于\"A\"和任一qty小于（$lt）30或item开始于字符p：\n1 2 3 4 5 6 7 8 9  cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, {\"$or\", bson.A{ bson.D{{\"qty\", bson.D{{\"$lt\", 30}}}}, bson.D{{\"item\", primitive.Regex{Pattern: \"^p\", Options: \"\"}}}, }}, })   该操作对应于以下SQL语句：\n1  SELECT*FROMinventoryWHEREstatus=\"A\"AND(qty30ORitemLIKE\"p%\")  注意\nMongoDB支持正则表达式$regex查询以执行字符串模式匹配。\n特性 游标 该Collection.Find 函数返回一个指针到匹配的文件。有关 更多信息，请参见Cursor文档。\n读取隔离 3.2版中的新功能。\n对于对副本集和副本集分片的读取，读取关注使客户端可以为其读取选择隔离级别。有关更多信息，请参见读关注的内容。\n查询嵌入/嵌套文档 匹配嵌入/嵌套文档 例如，以下查询选择字段size等于文档的所有 文档：{ h: 14, w: 21, uom: \"cm\" }\n1 2 3 4 5 6 7 8 9  cursor, err := coll.Find( context.Background(), bson.D{ {\"size\", bson.D{ {\"h\", 14}, {\"w\", 21}, {\"uom\", \"cm\"}, }}, })   整个嵌入式文档上的相等匹配要求与指定文档（包括字段顺序）完全匹配。例如，以下查询与inventory集合中的任何文档都不匹配 ：\n1 2 3 4 5 6 7 8 9  cursor, err := coll.Find( context.Background(), bson.D{ {\"size\", bson.D{ {\"w\", 21}, {\"h\", 14}, {\"uom\", \"cm\"}, }}, })   在嵌套字段上查询 要在嵌入/嵌套文档中的字段上指定查询条件，请使用点符号（“field.nestedField”）。\n注意\n使用点符号查询时，该字段和嵌套字段必须在引号内。\n在嵌套字段上指定相等匹配 下面的示例选择嵌套在size中的uom字段等于\"in\"的所有文档：\n1 2 3 4  cursor, err := coll.Find( context.Background(), bson.D{{\"size.uom\", \"in\"}}, )   使用查询运算符指定匹配项 以下查询$lt在字段中h嵌入的size字段上使用小于运算符（）：\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"size.h\", bson.D{ {\"$lt\", 15}, }}, })   指定AND条件 以下查询选择嵌套字段h小于15，嵌套字段uom等于\"in\"和status字段等于\"D\"的所有文档：\n1 2 3 4 5 6 7 8 9  cursor, err := coll.Find( context.Background(), bson.D{ {\"size.h\", bson.D{ {\"$lt\", 15}, }}, {\"size.uom\", \"in\"}, {\"status\", \"D\"}, })   查询数组 匹配一个数组 下面的示例查询所有文档，其中字段标签值是按指定顺序恰好具有两个元素（“red”和“ blank”）的数组：\n1 2 3 4  cursor, err := coll.Find( context.Background(), bson.D{{\"tags\", bson.A{\"red\", \"blank\"}}}, )   相反，如果您希望找到一个同时包含元素\"red\"和的数组 “blank”，而不考虑该数组中的顺序或其他元素，请使用$all运算符：\n1 2 3 4 5  cursor, err := coll.Find( context.Background(), bson.D{ {\"tags\", bson.D{{\"$all\", bson.A{\"red\", \"blank\"}}}}, })   在数组中查询元素 以下示例查询所有文档，其中tags是一个包含字符串\"red\"作为其元素之一的数组：\n1 2 3 4 5  cursor, err := coll.Find( context.Background(), bson.D{ {\"tags\", \"red\"}, })   例如，以下操作查询数组dim_cm包含至少一个值大于25的元素的所有文档。\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"dim_cm\", bson.D{ {\"$gt\", 25}, }}, })   指定数组元素多重条件 在数组元素上指定复合条件时，可以指定查询，以使单个数组元素满足这些条件，或者数组元素的任何组合均满足条件。\n使用数组元素上的复合过滤条件查询数组 下面的示例查询文档，其中dim_cm数组包含某种组合满足查询条件的元素；例如，一个元素可以满足大于15 条件，而另一个元素可以满足小于20条件，或者一个元素可以满足以下两个条件：\n1 2 3 4 5 6 7 8  cursor, err := coll.Find( context.Background(), bson.D{ {\"dim_cm\", bson.D{ {\"$gt\", 15}, {\"$lt\", 20}, }}, })   查询满足多个条件的数组元素 使用$elemMatch运算符在数组的元素上指定多个条件，以使至少一个数组元素满足所有指定的条件。\n以下示例查询文档，其中dim_cm数组包含至少一个同时大于（$gt）22和小于（$lt）30的元素：\n1 2 3 4 5 6 7 8 9 10  cursor, err := coll.Find( context.Background(), bson.D{ {\"dim_cm\", bson.D{ {\"$elemMatch\", bson.D{ {\"$gt\", 22}, {\"$lt\", 30}, }}, }}, })   查询数组某个索引位置的元素 使用点表示法，您可以为数组的特定索引或位置处的元素指定查询条件。该数组使用基于零的索引。\n注意\n使用点符号查询时，该字段和嵌套字段必须在引号内。\n以下示例查询数组中第二个元素dim_cm大于的所有文档25：\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"dim_cm.1\", bson.D{ {\"$gt\", 25}, }}, })   通过长度数组查询数组 使用$size运算符可按元素数量查询数组。例如，以下选择数组tags具有3个元素的文档 。\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"tags\", bson.D{ {\"$size\", 3}, }}, })   查询嵌入式文档数组 查询嵌套在数组中的文档 下面的示例选择instock数组中的元素 与指定文档匹配的所有文档：\n1 2 3 4 5 6 7 8  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock\", bson.D{ {\"warehouse\", \"A\"}, {\"qty\", 5}, }}, })   整个嵌入式/嵌套文档上的相等匹配要求 与指定文档（包括字段顺序）完全匹配。例如，以下查询与inventory集合中的任何文档都不匹配 ：\n1 2 3 4 5 6 7 8  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock\", bson.D{ {\"qty\", 5}, {\"warehouse\", \"A\"}, }}, })   在文档数组中的字段上指定查询条件 在嵌入文档数组中的字段上指定查询条件 如果您不知道嵌套在数组中的文档的索引位置，请使用点（.）和嵌套文档中的字段名称来连接数组字段的名称。\n下面的示例选择instock数组包含至少一个嵌入式文档的所有文档，其中嵌入式文档包含qty值小于或等于20的字段：\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock.qty\", bson.D{ {\"$lte\", 20}, }}, })   使用数组索引来查询一个字段中嵌入文档 使用点表示法，可以为文档中特定索引或数组位置的字段指定查询条件。该数组使用基于零的索引。\n注意\n使用点符号查询时，字段和索引必须在引号内。\n下面的示例选择instock数组包含qty,其值小于或等于20的字段作为其文档的第一个元素的所有文档：\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock.0.qty\", bson.D{ {\"$lte\", 20}, }}, })   指定文件的数组建立多个条件 在嵌套在文档数组中的多个字段上指定条件时，可以指定查询，以使单个文档满足这些条件，或者数组中文档的任何组合（包括单个文档）都满足条件。\n单个嵌套文档在嵌套字段上满足多个查询条件 使用$elemMatch运算符可以在一组嵌入式文档上指定多个条件，以使至少一个嵌入式文档满足所有指定条件。\n下面的示例查询文档，其中instock数组具有至少一个嵌入式文档，该文档同时包含qty等于5的字段和warehouse等于A的字段：\n1 2 3 4 5 6 7 8 9 10  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock\", bson.D{ {\"$elemMatch\", bson.D{ {\"qty\", 5}, {\"warehouse\", \"A\"}, }}, }}, })   下面的示例查询文档，其中instock数组具有至少一个嵌入式文档，该嵌入式文档包含qty大于10和小于或等于的字段20：\n1 2 3 4 5 6 7 8 9 10 11 12  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock\", bson.D{ {\"$elemMatch\", bson.D{ {\"qty\", bson.D{ {\"$gt\", 10}, {\"$lte\", 20}, }}, }}, }}, })   元素组合满足标准 如果数组字段上的复合查询条件未使用$elemMatch运算符，则查询将选择其数组包含满足条件的元素组合的那些文档。\n例如，以下查询匹配文档，其中嵌套在instock数组中的任何文档的qty字段大于10，而数组中的任何文档（但不一定是相同的嵌入式文档）的qty字段小于或等于20：\n1 2 3 4 5 6 7 8  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock.qty\", bson.D{ {\"$gt\", 10}, {\"$lte\", 20}, }}, })   下列示例查询instock数组具有至少一个嵌入的文档包含该字段qty等于5和至少一个嵌入的文档（但不一定是相同的嵌入的文档）包含该字段warehouse等于A：\n1 2 3 4 5 6  cursor, err := coll.Find( context.Background(), bson.D{ {\"instock.qty\", 5}, {\"instock.warehouse\", \"A\"}, })   投影查询返回的字段 默认情况下，MongoDB中的查询返回匹配文档中的所有字段。要限制MongoDB发送给应用程序的数据量，可以包含一个投影文档以指定或限制要返回的字段。\n返回所有字段中匹配的文档 下面的示例返回inventory集合中status等于的所有文档的所有字段 “A”：\n1 2 3 4  cursor, err := coll.Find( context.Background(), bson.D{{\"status\", \"A\"}}, )   该操作对应于以下SQL语句：\n1  SELECT*frominventoryWHEREstatus=\"A\"  返回指定字段和仅_id字段 通过在投影文档中将设置为，投影可以明确包含多个字段。以下操作返回与查询匹配的所有文档。在结果集中，只有item，status以及默认情况下，_id字段会在匹配的文档中返回。\n1 2 3 4 5 6 7 8 9 10 11 12  projection := bson.D{ {\"item\", 1}, {\"status\", 1}, } cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, }, options.Find().SetProjection(projection), )   该操作对应于以下SQL语句：\n1  SELECT_id,item,statusfrominventoryWHEREstatus=\"A\"  禁止_id返回 您可以_id通过将其设置0为投影中的结果来从结果中删除该字段 ，如以下示例所示：\n1 2 3 4 5 6 7 8 9 10 11 12 13  projection := bson.D{ {\"item\", 1}, {\"status\", 1}, {\"_id\", 0}, } cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, }, options.Find().SetProjection(projection), )   该操作对应于以下SQL语句：\n1  SELECTitem,statusfrominventoryWHEREstatus=\"A\"  注意\n除该_id字段外，您无法在投影文档中合并包含和排除语句。\n返回所有但排除某些字段 无需列出要在匹配文档中返回的字段，而是可以使用投影排除特定字段。以下示例返回匹配文档中的status和字段以外的所有字段instock：\n1 2 3 4 5 6 7 8 9 10 11 12  projection := bson.D{ {\"status\", 0}, {\"instock\", 0}, } cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, }, options.Find().SetProjection(projection), )   注意\n除该_id字段外，您无法在投影文档中合并包含和排除语句。\n返回内嵌文档的特定字段 您可以返回嵌入式文档中的特定字段。使用点表示法引用嵌入字段并在投影文档中将其设置为1。\n以下示例返回：\n _id（默认情况下返回） item， status， size中的uom字段。  该uom字段将保留在size文档中。\n1 2 3 4 5 6 7 8 9 10 11 12 13  projection := bson.D{ {\"item\", 1}, {\"status\", 1}, {\"size.uom\", 1}, } cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, }, options.Find().SetProjection(projection), )   禁止内嵌文档特定的字段 您可以隐藏嵌入式文档中的特定字段。使用点表示法引用投影文档中的嵌入字段并将其设置为0。\n下面的示例指定一个排除文档uom 内部字段的投影size。所有其他字段均在匹配的文档中返回：\n1 2 3 4 5 6 7 8 9 10 11  projection := bson.D{ {\"size.uom\", 0}, } cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, }, options.Find().SetProjection(projection), )   在数组中的嵌入式文档上投影 使用点符号可将嵌入数组的文档中的特定字段投影。\n以下示例指定要返回的投影：\n _id（默认情况下返回） item， status， qty文档中的字段嵌入在instock数组中。  1 2 3 4 5 6 7 8 9 10 11 12 13  projection := bson.D{ {\"item\", 1}, {\"status\", 1}, {\"instock.qty\", 1}, } cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, }, options.Find().SetProjection(projection), )   投影返回数组中的特定数组元素 对于包含数组的字段，MongoDB的提供了如下的投影算子用来操作数组：$elemMatch， $slice，和$。\n以下示例使用$slice投影运算符返回instock数组中的最后一个元素：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  projection := bson.D{ {\"item\", 1}, {\"status\", 1}, {\"instock\", bson.D{ {\"$slice\", -1}, }}, } cursor, err := coll.Find( context.Background(), bson.D{ {\"status\", \"A\"}, }, options.Find().SetProjection(projection), )   $elemMatch， $slice，和$是投影特定元素以包含在返回数组中的唯一方法。例如，您不能使用数组索引来投影特定的数组元素。例如include(\"instock.0\")不会将数组与第一个元素一起投影。\n查询空字段或缺少字段 MongoDB中的不同查询运算符对待null值的方式有所不同。\n重要\nnil与MongoDB Go驱动程序一起使用以查询null或缺少MongoDB中的字段。\n相等过滤器 item = nil查询匹配包含值等于nil或不包含该字段的文档。\n1 2 3 4 5  cursor, err := coll.Find( context.Background(), bson.D{ {\"item\", nil}, })   该查询返回集合中的两个文档。\n类型检查 以下查询仅匹配 包含item其值为BSON类型 Null（类型编号10）的字段的 文档：\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"item\", bson.D{ {\"$type\", 10}, }}, })   该查询仅返回该item字段值为的文档null。\n存在检查 以下示例查询不包含字段的文档。\n1 2 3 4 5 6 7  cursor, err := coll.Find( context.Background(), bson.D{ {\"item\", bson.D{ {\"$exists\", false}, }}, })   该查询仅返回不包含该item字段的文档。\n在mongoShell中迭代游标 db.collection.find()方法返回一个游标。要访问文档，您需要迭代游标。但是，在 mongoshell中，如果未使用var关键字将返回的光标分配给变量，则光标将自动迭代多达20次，以打印结果中的前20个文档。\n以下示例描述了手动迭代游标以访问文档或使用迭代器索引的方法。\n手动迭代游标 在mongoshell中，当您find()使用var关键字将方法返回的游标分配给变量时，游标不会自动进行迭代。\n您可以在shell中调用cursor变量以进行多达20次迭代 [1]并打印匹配的文档，如以下示例所示：\n1 2 3  var myCursor = db.users.find( { type: 2 } ); myCursor   您还可以使用cursor方法next()访问文档，如以下示例所示：\n1 2 3 4 5  var myCursor = db.users.find( { type: 2 } ); while (myCursor.hasNext()) { print(tojson(myCursor.next())); }   作为替代的打印操作，请考虑使用printjson()方法来替换print(tojson())：\n1 2 3 4 5  var myCursor = db.users.find( { type: 2 } ); while (myCursor.hasNext()) { printjson(myCursor.next()); }   您可以使用cursor方法forEach()来迭代光标并访问文档，如以下示例所示：\n1 2 3  var myCursor = db.users.find( { type: 2 } ); myCursor.forEach(printjson);   有关游标方法的更多信息，请参见JavaScript游标方法和驱动程序文档。\n迭代指针 在mongo外壳程序中，可以使用 toArray()方法来迭代游标并以数组形式返回文档，如下所示：\n1 2 3  var myCursor = db.inventory.find( { type: 2 } ); var documentArray = myCursor.toArray(); var myDocument = documentArray[3];   toArray()方法将游标返回的所有文档加载到RAM中。该toArray() 方法耗尽游标。\n此外，某些驱动程序通过使用光标（即cursor[index]）上的索引来提供对文档的访问 。这是首先调用该toArray()方法然后在结果数组上使用索引的快捷方式。\n考虑以下示例：\n1 2  var myCursor = db.users.find( { type: 2 } ); var myDocument = myCursor[1];   myCursor[1]等效于下面的例子：\n1  myCursor.toArray() [1];   游标特性 关闭非活动游标 默认情况下，服务器将在闲置10分钟或客户端用尽光标后自动关闭光标。要在mongoshell程序中覆盖此特性，可以使用以下cursor.noCursorTimeout()方法：\n1  var myCursor = db.users.find().noCursorTimeout();   设置该noCursorTimeout选项后，必须使用cursor.close()或通过用尽光标的结果来关闭光标。\n光标隔离 当游标返回文档时，其他操作可能会与查询交错。\n光标批次 MongoDB服务器批量返回查询结果。批处理中的数据量将不超过BSON文档的最大大小。要覆盖批次的默认大小，请参见batchSize()和 limit()。\n在新版本3.4：find()， aggregate()， listIndexes，和 listCollections最大的每批16MB返回。batchSize()可以强制执行一个较小的限制，但不能执行较大的限制。\nfind()并且aggregate()操作的初始批处理大小默认为101个文档。getMore 针对结果游标发出的后续操作没有默认的批处理大小，因此它们仅受16MB消息大小的限制。\n对于包含不带索引的排序操作的查询，服务器必须在返回任何结果之前将所有文档加载到内存中以执行排序。\n当您遍历游标并到达返回批次的末尾时，如果还有更多结果，cursor.next()将执行来检索下一个批次。若要查看在迭代游标时批处理中剩余多少文档，可以使用方法，如以下示例所示：getMore operationobjsLeftInBatch()\n1 2 3 4 5  var myCursor = db.inventory.find(); var myFirstDocument = myCursor.hasNext() ? myCursor.next() : null; myCursor.objsLeftInBatch();   游标信息 db.serverStatus()方法返回包含metrics字段的文档。该 metrics字段包含metrics.cursor具有以下信息的 字段：\n 自上次服务器重新启动以来超时的游标数 DBQuery.Option.noTimeout设置了选项以防止一段时间不活动后超时的打开游标的数量 “固定”打开游标的数量 打开的游标总数  考虑以下示例，该示例调用 db.serverStatus()方法并metrics从结果中访问字段，然后从cursor字段中访问metrics 字段：\n1  db.serverStatus().metrics.cursor   结果是以下文档：\n1 2 3 4 5 6 7 8  { \"timedOut\" : number \"open\" : { \"noTimeout\" : number, \"pinned\" : number, \"total\" : number } }   ",
  "wordCount" : "7280",
  "inLanguage": "zh-cn",
  "datePublished": "2020-05-10T22:50:11Z",
  "dateModified": "2020-05-10T22:50:11Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/mongodb%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Forz Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Forz Blog (Alt + H)">Forz Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      MongoDB的查询操作
    </h1>
    <div class="post-meta">May 10, 2020
</div>
  </header> 
  <div class="post-content"><h1 id="示例集合">示例集合<a hidden class="anchor" aria-hidden="true" href="#示例集合">#</a></h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">docs</span> <span class="o">:=</span> <span class="p">[]</span><span class="kd">interface</span><span class="p">{}{</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;journal&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">25</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mi">14</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">21</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;notebook&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">50</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;in&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;paper&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">100</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;in&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;planner&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">75</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mf">22.85</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">30</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;postcard&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">45</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mf">15.25</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
<span class="p">}</span>

<span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">InsertMany</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span> <span class="nx">docs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">docs</span> <span class="o">:=</span> <span class="p">[]</span><span class="kd">interface</span><span class="p">{}{</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;journal&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">25</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;blank&#34;</span><span class="p">,</span> <span class="s">&#34;red&#34;</span><span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;notebook&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">50</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="s">&#34;blank&#34;</span><span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;paper&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">100</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="s">&#34;blank&#34;</span><span class="p">,</span> <span class="s">&#34;plain&#34;</span><span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;planner&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">75</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;blank&#34;</span><span class="p">,</span> <span class="s">&#34;red&#34;</span><span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="mf">22.85</span><span class="p">,</span> <span class="mi">30</span><span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;postcard&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">45</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;blue&#34;</span><span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="mf">15.25</span><span class="p">}},</span>
	<span class="p">},</span>
<span class="p">}</span>

<span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">InsertMany</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span> <span class="nx">docs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">docs</span> <span class="o">:=</span> <span class="p">[]</span><span class="kd">interface</span><span class="p">{}{</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;journal&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
			<span class="p">},</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;C&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;notebook&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;C&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;paper&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">60</span><span class="p">},</span>
			<span class="p">},</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;B&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;planner&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">40</span><span class="p">},</span>
			<span class="p">},</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;B&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;postcard&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;B&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
			<span class="p">},</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;C&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">35</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
<span class="p">}</span>

<span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">InsertMany</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span> <span class="nx">docs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">docs</span> <span class="o">:=</span> <span class="p">[]</span><span class="kd">interface</span><span class="p">{}{</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;journal&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mi">14</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">21</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;notebook&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;in&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;EC&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;paper&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">11</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;in&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">60</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;planner&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mf">22.85</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">30</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">40</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="s">&#34;postcard&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mf">15.25</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;B&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
			<span class="p">},</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;EC&#34;</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">35</span><span class="p">},</span>
			<span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">},</span>
<span class="p">}</span>

<span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">InsertMany</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span> <span class="nx">docs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">docs</span> <span class="o">:=</span> <span class="p">[]</span><span class="kd">interface</span><span class="p">{}{</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;_id&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;_id&#34;</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span>
	<span class="p">},</span>
<span class="p">}</span>

<span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">InsertMany</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span> <span class="nx">docs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="选择集合中的所有文档">选择集合中的所有文档<a hidden class="anchor" aria-hidden="true" href="#选择集合中的所有文档">#</a></h1>
<p>要选择集合中的所有文档，请将空文档作为查询过滤器参数传递给find方法。查询过滤器参数确定选择条件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{},</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>此操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h1 id="指定相等条件">指定相等条件<a hidden class="anchor" aria-hidden="true" href="#指定相等条件">#</a></h1>
<p>以下示例从inventory集合中选择status等于&quot;D&quot;的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">}},</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>此操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;D&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h1 id="查询运算符">查询运算符<a hidden class="anchor" aria-hidden="true" href="#查询运算符">#</a></h1>
<p>以下示例从inventory 集合中检索status等于&quot;A&quot;或&quot;D&quot;的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;$in&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;A&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">}}}}})</span>
</code></pre></td></tr></table>
</div>
</div><p>注意</p>
<p>尽管可以使用<code>$or</code>运算符表示此查询，但是在同一字段上执行相等性检查时，请使用<code>$in</code>运算符而不是<code>$or</code>运算符。</p>
<p>该操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">SELECT</span> <span class="o">*</span> <span class="nx">FROM</span> <span class="nx">inventory</span> <span class="nx">WHERE</span> <span class="nx">status</span> <span class="nf">in</span> <span class="p">(</span><span class="s">&#34;A&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>有关MongoDB查询运算符的完整列表，请参阅<a href="https://docs.mongodb.com/manual/reference/operator/query/">查询和投影运算符文档</a>。</p>
<h1 id="指定and条件">指定AND条件<a hidden class="anchor" aria-hidden="true" href="#指定and条件">#</a></h1>
<p>复合查询可以为集合文档中的多个字段指定条件。AND将复合查询的子句连接起来，以便查询选择集合中符合所有条件的文档。</p>
<p>以下示例检索inventory集合中status等于&quot;A&quot; 且qty小于（$lt）30的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;$lt&#34;</span><span class="p">,</span> <span class="mi">30</span><span class="p">}}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>该操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;A&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>有关其他MongoDB比较运算符，请参阅<a href="https://docs.mongodb.com/manual/reference/operator/query-comparison/#query-selectors-comparison">比较运算符</a>。</p>
<h1 id="指定or条件">指定OR条件<a hidden class="anchor" aria-hidden="true" href="#指定or条件">#</a></h1>
<p>使用$or运算符，您可以指定一个复合查询，该查询将每个子句与一个逻辑连接符连接在一起，OR以便该查询选择集合中至少匹配一个条件的文档。</p>
<p>以下示例检索集合中status等于&quot;A&quot;或qty小于（$lt）30的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;$or&#34;</span><span class="p">,</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
				<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">}},</span>
				<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;$lt&#34;</span><span class="p">,</span> <span class="mi">30</span><span class="p">}}}},</span>
			<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>该操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;A&#34;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><strong>注意</strong></p>
<p>使用比较运算符的查询 需进行<a href="https://docs.mongodb.com/manual/reference/method/db.collection.find/#type-bracketing">类型包围</a>。</p>
<h2 id="指定and和or条件">指定AND和OR条件<a hidden class="anchor" aria-hidden="true" href="#指定and和or条件">#</a></h2>
<p>在下面的例子中，复合查询中选择该集合中的所有文档，其中status等于&quot;A&quot;和任一qty小于（$lt）30或item开始于字符p：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;$or&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;$lt&#34;</span><span class="p">,</span> <span class="mi">30</span><span class="p">}}}},</span>
			<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="nx">primitive</span><span class="p">.</span><span class="nx">Regex</span><span class="p">{</span><span class="nx">Pattern</span><span class="p">:</span> <span class="s">&#34;^p&#34;</span><span class="p">,</span> <span class="nx">Options</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">}}},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>该操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;A&#34;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s2">&#34;p%&#34;</span><span class="p">)</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><strong>注意</strong></p>
<p>MongoDB支持正则表达式<a href="https://docs.mongodb.com/manual/reference/operator/query/regex/#op._S_regex">$regex</a>查询以执行字符串模式匹配。</p>
<h1 id="特性">特性<a hidden class="anchor" aria-hidden="true" href="#特性">#</a></h1>
<h2 id="游标">游标<a hidden class="anchor" aria-hidden="true" href="#游标">#</a></h2>
<p>该Collection.Find 函数返回一个指针到匹配的文件。有关 更多信息，请参见<a href="https://godoc.org/github.com/mongodb/mongo-go-driver/mongo#Cursor">Cursor文档</a>。</p>
<h2 id="读取隔离">读取隔离<a hidden class="anchor" aria-hidden="true" href="#读取隔离">#</a></h2>
<p>3.2版中的新功能。</p>
<p>对于对副本集和副本集分片的读取，读取关注使客户端可以为其读取选择隔离级别。有关更多信息，请参见读关注的内容。</p>
<h1 id="查询嵌入嵌套文档">查询嵌入/嵌套文档<a hidden class="anchor" aria-hidden="true" href="#查询嵌入嵌套文档">#</a></h1>
<h2 id="匹配嵌入嵌套文档">匹配嵌入/嵌套文档<a hidden class="anchor" aria-hidden="true" href="#匹配嵌入嵌套文档">#</a></h2>
<p>例如，以下查询选择字段size等于文档的所有 文档：<code>{ h: 14, w: 21, uom: &quot;cm&quot; }</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mi">14</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">21</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>整个嵌入式文档上的相等匹配要求与指定文档（包括字段顺序）完全匹配&lt;value&gt;。例如，以下查询与inventory集合中的任何文档都不匹配 ：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;size&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;w&#34;</span><span class="p">,</span> <span class="mi">21</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;h&#34;</span><span class="p">,</span> <span class="mi">14</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;uom&#34;</span><span class="p">,</span> <span class="s">&#34;cm&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="在嵌套字段上查询">在嵌套字段上查询<a hidden class="anchor" aria-hidden="true" href="#在嵌套字段上查询">#</a></h2>
<p>要在嵌入/嵌套文档中的字段上指定查询条件，请使用点符号（&ldquo;field.nestedField&rdquo;）。</p>
<p><strong>注意</strong></p>
<p>使用点符号查询时，该字段和嵌套字段必须在引号内。</p>
<h3 id="在嵌套字段上指定相等匹配">在嵌套字段上指定相等匹配<a hidden class="anchor" aria-hidden="true" href="#在嵌套字段上指定相等匹配">#</a></h3>
<p>下面的示例选择嵌套在size中的uom字段等于&quot;in&quot;的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;size.uom&#34;</span><span class="p">,</span> <span class="s">&#34;in&#34;</span><span class="p">}},</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="使用查询运算符指定匹配项">使用查询运算符指定匹配项<a hidden class="anchor" aria-hidden="true" href="#使用查询运算符指定匹配项">#</a></h3>
<p>以下查询$lt在字段中h嵌入的size字段上使用小于运算符（）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;size.h&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$lt&#34;</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="指定and条件-1">指定AND条件<a hidden class="anchor" aria-hidden="true" href="#指定and条件-1">#</a></h3>
<p>以下查询选择嵌套字段h小于15，嵌套字段uom等于&quot;in&quot;和status字段等于&quot;D&quot;的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;size.h&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$lt&#34;</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
		<span class="p">}},</span>
		<span class="p">{</span><span class="s">&#34;size.uom&#34;</span><span class="p">,</span> <span class="s">&#34;in&#34;</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;D&#34;</span><span class="p">},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="查询数组">查询数组<a hidden class="anchor" aria-hidden="true" href="#查询数组">#</a></h1>
<h2 id="匹配一个数组">匹配一个数组<a hidden class="anchor" aria-hidden="true" href="#匹配一个数组">#</a></h2>
<p>下面的示例查询所有文档，其中字段标签值是按指定顺序恰好具有两个元素（“red”和“ blank”）的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="s">&#34;blank&#34;</span><span class="p">}}},</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>相反，如果您希望找到一个同时包含元素&quot;red&quot;和的数组 &ldquo;blank&rdquo;，而不考虑该数组中的顺序或其他元素，请使用$all运算符：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;$all&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">A</span><span class="p">{</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="s">&#34;blank&#34;</span><span class="p">}}}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="在数组中查询元素">在数组中查询元素<a hidden class="anchor" aria-hidden="true" href="#在数组中查询元素">#</a></h2>
<p>以下示例查询所有文档，其中tags是一个包含字符串&quot;red&quot;作为其元素之一的数组：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="s">&#34;red&#34;</span><span class="p">},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>例如，以下操作查询数组dim_cm包含至少一个值大于25的元素的所有文档。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$gt&#34;</span><span class="p">,</span> <span class="mi">25</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="指定数组元素多重条件">指定数组元素多重条件<a hidden class="anchor" aria-hidden="true" href="#指定数组元素多重条件">#</a></h2>
<p>在数组元素上指定复合条件时，可以指定查询，以使单个数组元素满足这些条件，或者数组元素的任何组合均满足条件。</p>
<h3 id="使用数组元素上的复合过滤条件查询数组">使用数组元素上的复合过滤条件查询数组<a hidden class="anchor" aria-hidden="true" href="#使用数组元素上的复合过滤条件查询数组">#</a></h3>
<p>下面的示例查询文档，其中dim_cm数组包含某种组合满足查询条件的元素；例如，一个元素可以满足大于15 条件，而另一个元素可以满足小于20条件，或者一个元素可以满足以下两个条件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$gt&#34;</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;$lt&#34;</span><span class="p">,</span> <span class="mi">20</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="查询满足多个条件的数组元素">查询满足多个条件的数组元素<a hidden class="anchor" aria-hidden="true" href="#查询满足多个条件的数组元素">#</a></h3>
<p>使用<code>$elemMatch</code>运算符在数组的元素上指定多个条件，以使至少一个数组元素满足所有指定的条件。</p>
<p>以下示例查询文档，其中dim_cm数组包含至少一个同时大于（$gt）22和小于（$lt）30的元素：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;dim_cm&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$elemMatch&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;$gt&#34;</span><span class="p">,</span> <span class="mi">22</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;$lt&#34;</span><span class="p">,</span> <span class="mi">30</span><span class="p">},</span>
			<span class="p">}},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="查询数组某个索引位置的元素">查询数组某个索引位置的元素<a hidden class="anchor" aria-hidden="true" href="#查询数组某个索引位置的元素">#</a></h3>
<p>使用点表示法，您可以为数组的特定索引或位置处的元素指定查询条件。该数组使用基于零的索引。</p>
<p><strong>注意</strong></p>
<p>使用点符号查询时，该字段和嵌套字段必须在引号内。</p>
<p>以下示例查询数组中第二个元素dim_cm大于的所有文档25：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;dim_cm.1&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$gt&#34;</span><span class="p">,</span> <span class="mi">25</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="通过长度数组查询数组">通过长度数组查询数组<a hidden class="anchor" aria-hidden="true" href="#通过长度数组查询数组">#</a></h3>
<p>使用<code>$size</code>运算符可按元素数量查询数组。例如，以下选择数组tags具有3个元素的文档 。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;tags&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$size&#34;</span><span class="p">,</span> <span class="mi">3</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="查询嵌入式文档数组">查询嵌入式文档数组<a hidden class="anchor" aria-hidden="true" href="#查询嵌入式文档数组">#</a></h1>
<h2 id="查询嵌套在数组中的文档">查询嵌套在数组中的文档<a hidden class="anchor" aria-hidden="true" href="#查询嵌套在数组中的文档">#</a></h2>
<p>下面的示例选择instock数组中的元素 与指定文档匹配的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>整个嵌入式/嵌套文档上的相等匹配要求 与指定文档（包括字段顺序）完全匹配。例如，以下查询与inventory集合中的任何文档都不匹配 ：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="在文档数组中的字段上指定查询条件">在文档数组中的字段上指定查询条件<a hidden class="anchor" aria-hidden="true" href="#在文档数组中的字段上指定查询条件">#</a></h2>
<h3 id="在嵌入文档数组中的字段上指定查询条件">在嵌入文档数组中的字段上指定查询条件<a hidden class="anchor" aria-hidden="true" href="#在嵌入文档数组中的字段上指定查询条件">#</a></h3>
<p>如果您不知道嵌套在数组中的文档的索引位置，请使用点（.）和嵌套文档中的字段名称来连接数组字段的名称。</p>
<p>下面的示例选择instock数组包含至少一个嵌入式文档的所有文档，其中嵌入式文档包含qty值小于或等于20的字段：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock.qty&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$lte&#34;</span><span class="p">,</span> <span class="mi">20</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="使用数组索引来查询一个字段中嵌入文档">使用数组索引来查询一个字段中嵌入文档<a hidden class="anchor" aria-hidden="true" href="#使用数组索引来查询一个字段中嵌入文档">#</a></h3>
<p>使用点表示法，可以为文档中特定索引或数组位置的字段指定查询条件。该数组使用基于零的索引。</p>
<p><strong>注意</strong></p>
<p>使用点符号查询时，字段和索引必须在引号内。</p>
<p>下面的示例选择instock数组包含qty,其值小于或等于20的字段作为其文档的第一个元素的所有文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock.0.qty&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$lte&#34;</span><span class="p">,</span> <span class="mi">20</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="指定文件的数组建立多个条件">指定文件的数组建立多个条件<a hidden class="anchor" aria-hidden="true" href="#指定文件的数组建立多个条件">#</a></h2>
<p>在嵌套在文档数组中的多个字段上指定条件时，可以指定查询，以使单个文档满足这些条件，或者数组中文档的任何组合（包括单个文档）都满足条件。</p>
<h3 id="单个嵌套文档在嵌套字段上满足多个查询条件">单个嵌套文档在嵌套字段上满足多个查询条件<a hidden class="anchor" aria-hidden="true" href="#单个嵌套文档在嵌套字段上满足多个查询条件">#</a></h3>
<p>使用<code>$elemMatch</code>运算符可以在一组嵌入式文档上指定多个条件，以使至少一个嵌入式文档满足所有指定条件。</p>
<p>下面的示例查询文档，其中instock数组具有至少一个嵌入式文档，该文档同时包含qty等于5的字段和warehouse等于A的字段：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$elemMatch&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
				<span class="p">{</span><span class="s">&#34;warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
			<span class="p">}},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>下面的示例查询文档，其中instock数组具有至少一个嵌入式文档，该嵌入式文档包含qty大于10和小于或等于的字段20：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$elemMatch&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
				<span class="p">{</span><span class="s">&#34;qty&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
					<span class="p">{</span><span class="s">&#34;$gt&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span>
					<span class="p">{</span><span class="s">&#34;$lte&#34;</span><span class="p">,</span> <span class="mi">20</span><span class="p">},</span>
				<span class="p">}},</span>
			<span class="p">}},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="元素组合满足标准">元素组合满足标准<a hidden class="anchor" aria-hidden="true" href="#元素组合满足标准">#</a></h3>
<p>如果数组字段上的复合查询条件未使用<code>$elemMatch</code>运算符，则查询将选择其数组包含满足条件的元素组合的那些文档。</p>
<p>例如，以下查询匹配文档，其中嵌套在instock数组中的任何文档的qty字段大于10，而数组中的任何文档（但不一定是相同的嵌入式文档）的qty字段小于或等于20：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock.qty&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$gt&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span>
			<span class="p">{</span><span class="s">&#34;$lte&#34;</span><span class="p">,</span> <span class="mi">20</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>下列示例查询instock数组具有至少一个嵌入的文档包含该字段qty等于5和至少一个嵌入的文档（但不一定是相同的嵌入的文档）包含该字段warehouse等于A：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;instock.qty&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span>
		<span class="p">{</span><span class="s">&#34;instock.warehouse&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="投影查询返回的字段">投影查询返回的字段<a hidden class="anchor" aria-hidden="true" href="#投影查询返回的字段">#</a></h1>
<p>默认情况下，MongoDB中的查询返回匹配文档中的所有字段。要限制MongoDB发送给应用程序的数据量，可以包含一个投影文档以指定或限制要返回的字段。</p>
<h2 id="返回所有字段中匹配的文档">返回所有字段中匹配的文档<a hidden class="anchor" aria-hidden="true" href="#返回所有字段中匹配的文档">#</a></h2>
<p>下面的示例返回inventory集合中status等于的所有文档的所有字段 &ldquo;A&rdquo;：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">}},</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>该操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;A&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h2 id="返回指定字段和仅_id字段">返回指定字段和仅_id字段<a hidden class="anchor" aria-hidden="true" href="#返回指定字段和仅_id字段">#</a></h2>
<p>通过在投影文档中将设置为&lt;field&gt;，投影可以明确包含多个字段。以下操作返回与查询匹配的所有文档。在结果集中，只有item，status以及默认情况下，_id字段会在匹配的文档中返回。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">projection</span> <span class="o">:=</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
	<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">}</span>

<span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">options</span><span class="p">.</span><span class="nf">Find</span><span class="p">().</span><span class="nf">SetProjection</span><span class="p">(</span><span class="nx">projection</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>该操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="n">_id</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;A&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h2 id="禁止_id返回">禁止_id返回<a hidden class="anchor" aria-hidden="true" href="#禁止_id返回">#</a></h2>
<p>您可以_id通过将其设置0为投影中的结果来从结果中删除该字段 ，如以下示例所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">projection</span> <span class="o">:=</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
	<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;_id&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">}</span>

<span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">options</span><span class="p">.</span><span class="nf">Find</span><span class="p">().</span><span class="nf">SetProjection</span><span class="p">(</span><span class="nx">projection</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>该操作对应于以下SQL语句：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;A&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>注意</p>
<p>除该_id字段外，您无法在投影文档中合并包含和排除语句。</p>
<h2 id="返回所有但排除某些字段">返回所有但排除某些字段<a hidden class="anchor" aria-hidden="true" href="#返回所有但排除某些字段">#</a></h2>
<p>无需列出要在匹配文档中返回的字段，而是可以使用投影排除特定字段。以下示例返回匹配文档中的status和字段以外的所有字段instock：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">projection</span> <span class="o">:=</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
	<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">}</span>

<span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">options</span><span class="p">.</span><span class="nf">Find</span><span class="p">().</span><span class="nf">SetProjection</span><span class="p">(</span><span class="nx">projection</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>注意</p>
<p>除该_id字段外，您无法在投影文档中合并包含和排除语句。</p>
<h2 id="返回内嵌文档的特定字段">返回内嵌文档的特定字段<a hidden class="anchor" aria-hidden="true" href="#返回内嵌文档的特定字段">#</a></h2>
<p>您可以返回嵌入式文档中的特定字段。使用点表示法引用嵌入字段并在投影文档中将其设置为1。</p>
<p>以下示例返回：</p>
<ul>
<li>_id（默认情况下返回）</li>
<li>item，</li>
<li>status，</li>
<li>size中的uom字段。</li>
</ul>
<p>该uom字段将保留在size文档中。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">projection</span> <span class="o">:=</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
	<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;size.uom&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">}</span>

<span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">options</span><span class="p">.</span><span class="nf">Find</span><span class="p">().</span><span class="nf">SetProjection</span><span class="p">(</span><span class="nx">projection</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="禁止内嵌文档特定的字段">禁止内嵌文档特定的字段<a hidden class="anchor" aria-hidden="true" href="#禁止内嵌文档特定的字段">#</a></h2>
<p>您可以隐藏嵌入式文档中的特定字段。使用点表示法引用投影文档中的嵌入字段并将其设置为0。</p>
<p>下面的示例指定一个排除文档uom 内部字段的投影size。所有其他字段均在匹配的文档中返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">projection</span> <span class="o">:=</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
	<span class="p">{</span><span class="s">&#34;size.uom&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">}</span>

<span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">options</span><span class="p">.</span><span class="nf">Find</span><span class="p">().</span><span class="nf">SetProjection</span><span class="p">(</span><span class="nx">projection</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="在数组中的嵌入式文档上投影">在数组中的嵌入式文档上投影<a hidden class="anchor" aria-hidden="true" href="#在数组中的嵌入式文档上投影">#</a></h2>
<p>使用点符号可将嵌入数组的文档中的特定字段投影。</p>
<p>以下示例指定要返回的投影：</p>
<ul>
<li>_id（默认情况下返回）</li>
<li>item，</li>
<li>status，</li>
<li>qty文档中的字段嵌入在instock数组中。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">projection</span> <span class="o">:=</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
	<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;instock.qty&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">}</span>

<span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">options</span><span class="p">.</span><span class="nf">Find</span><span class="p">().</span><span class="nf">SetProjection</span><span class="p">(</span><span class="nx">projection</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="投影返回数组中的特定数组元素">投影返回数组中的特定数组元素<a hidden class="anchor" aria-hidden="true" href="#投影返回数组中的特定数组元素">#</a></h2>
<p>对于包含数组的字段，MongoDB的提供了如下的投影算子用来操作数组：<code>$elemMatch</code>， <code>$slice</code>，和<code>$</code>。</p>
<p>以下示例使用<code>$slice</code>投影运算符返回instock数组中的最后一个元素：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">projection</span> <span class="o">:=</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
	<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
	<span class="p">{</span><span class="s">&#34;instock&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;$slice&#34;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span>
	<span class="p">}},</span>
<span class="p">}</span>

<span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;status&#34;</span><span class="p">,</span> <span class="s">&#34;A&#34;</span><span class="p">},</span>
	<span class="p">},</span>
	<span class="nx">options</span><span class="p">.</span><span class="nf">Find</span><span class="p">().</span><span class="nf">SetProjection</span><span class="p">(</span><span class="nx">projection</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>$elemMatch</code>， <code>$slice</code>，和<code>$</code>是投影特定元素以包含在返回数组中的唯一方法。例如，您不能使用数组索引来投影特定的数组元素。例如<code>include(&quot;instock.0&quot;)</code>不会将数组与第一个元素一起投影。</p>
<h1 id="查询空字段或缺少字段">查询空字段或缺少字段<a hidden class="anchor" aria-hidden="true" href="#查询空字段或缺少字段">#</a></h1>
<p>MongoDB中的不同查询运算符对待null值的方式有所不同。</p>
<p>重要</p>
<p>nil与MongoDB Go驱动程序一起使用以查询null或缺少MongoDB中的字段。</p>
<h2 id="相等过滤器">相等过滤器<a hidden class="anchor" aria-hidden="true" href="#相等过滤器">#</a></h2>
<p><code>item =&gt; nil</code>查询匹配包含值等于nil或不包含该字段的文档。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>该查询返回集合中的两个文档。</p>
<h2 id="类型检查">类型检查<a hidden class="anchor" aria-hidden="true" href="#类型检查">#</a></h2>
<p>以下查询仅匹配 包含item其值为<a href="https://docs.mongodb.com/manual/reference/mongodb-extended-json/">BSON类型</a> Null（类型编号10）的字段的 文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$type&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>该查询仅返回该item字段值为的文档null。</p>
<h2 id="存在检查">存在检查<a hidden class="anchor" aria-hidden="true" href="#存在检查">#</a></h2>
<p>以下示例查询不包含字段的文档。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">cursor</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">coll</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span>
	<span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span>
	<span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
		<span class="p">{</span><span class="s">&#34;item&#34;</span><span class="p">,</span> <span class="nx">bson</span><span class="p">.</span><span class="nx">D</span><span class="p">{</span>
			<span class="p">{</span><span class="s">&#34;$exists&#34;</span><span class="p">,</span> <span class="kc">false</span><span class="p">},</span>
		<span class="p">}},</span>
	<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>该查询仅返回不包含该item字段的文档。</p>
<h1 id="在mongoshell中迭代游标">在mongoShell中迭代游标<a hidden class="anchor" aria-hidden="true" href="#在mongoshell中迭代游标">#</a></h1>
<p>db.collection.find()方法返回一个游标。要访问文档，您需要迭代游标。但是，在 mongoshell中，如果未使用var关键字将返回的光标分配给变量，则光标将自动迭代多达20次，以打印结果中的前20个文档。</p>
<p>以下示例描述了手动迭代游标以访问文档或使用迭代器索引的方法。</p>
<h2 id="手动迭代游标">手动迭代游标<a hidden class="anchor" aria-hidden="true" href="#手动迭代游标">#</a></h2>
<p>在mongoshell中，当您find()使用var关键字将方法返回的游标分配给变量时，游标不会自动进行迭代。</p>
<p>您可以在shell中调用cursor变量以进行多达20次迭代 [1]并打印匹配的文档，如以下示例所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">var</span> <span class="n">myCursor</span> <span class="o">=</span> <span class="nf">db.users.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">type</span><span class="o">:</span> <span class="m">2</span> <span class="p">}</span> <span class="p">);</span>

<span class="n">myCursor</span>
</code></pre></td></tr></table>
</div>
</div><p>您还可以使用cursor方法next()访问文档，如以下示例所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">var</span> <span class="n">myCursor</span> <span class="o">=</span> <span class="nf">db.users.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">type</span><span class="o">:</span> <span class="m">2</span> <span class="p">}</span> <span class="p">);</span>

<span class="nf">while </span><span class="p">(</span><span class="nf">myCursor.hasNext</span><span class="p">())</span> <span class="p">{</span>
   <span class="nf">print</span><span class="p">(</span><span class="nf">tojson</span><span class="p">(</span><span class="nf">myCursor.next</span><span class="p">()));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>作为替代的打印操作，请考虑使用printjson()方法来替换print(tojson())：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kd">var</span> <span class="nx">myCursor</span> <span class="p">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span> <span class="p">{</span> <span class="kd">type</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span> <span class="p">);</span>

<span class="nf">while</span> <span class="p">(</span><span class="nx">myCursor</span><span class="p">.</span><span class="nf">hasNext</span><span class="p">())</span> <span class="p">{</span>
   <span class="nf">printjson</span><span class="p">(</span><span class="nx">myCursor</span><span class="p">.</span><span class="nf">next</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>您可以使用cursor方法forEach()来迭代光标并访问文档，如以下示例所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">var</span> <span class="n">myCursor</span> <span class="o">=</span>  <span class="nf">db.users.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">type</span><span class="o">:</span> <span class="m">2</span> <span class="p">}</span> <span class="p">);</span>

<span class="nf">myCursor.forEach</span><span class="p">(</span><span class="n">printjson</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>有关游标方法的更多信息，请参见JavaScript游标方法和驱动程序文档。</p>
<h2 id="迭代指针">迭代指针<a hidden class="anchor" aria-hidden="true" href="#迭代指针">#</a></h2>
<p>在mongo外壳程序中，可以使用 toArray()方法来迭代游标并以数组形式返回文档，如下所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">var</span> <span class="n">myCursor</span> <span class="o">=</span> <span class="nf">db.inventory.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">type</span><span class="o">:</span> <span class="m">2</span> <span class="p">}</span> <span class="p">);</span>
<span class="n">var</span> <span class="n">documentArray</span> <span class="o">=</span> <span class="nf">myCursor.toArray</span><span class="p">();</span>
<span class="n">var</span> <span class="n">myDocument</span> <span class="o">=</span> <span class="n">documentArray[3]</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>toArray()方法将游标返回的所有文档加载到RAM中。该toArray() 方法耗尽游标。</p>
<p>此外，某些驱动程序通过使用光标（即cursor[index]）上的索引来提供对文档的访问 。这是首先调用该toArray()方法然后在结果数组上使用索引的快捷方式。</p>
<p>考虑以下示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">var</span> <span class="n">myCursor</span> <span class="o">=</span> <span class="nf">db.users.find</span><span class="p">(</span> <span class="p">{</span> <span class="n">type</span><span class="o">:</span> <span class="m">2</span> <span class="p">}</span> <span class="p">);</span>
<span class="n">var</span> <span class="n">myDocument</span> <span class="o">=</span> <span class="n">myCursor[1]</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>myCursor[1]</code>等效于下面的例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">myCursor.toArray</span><span class="p">()</span> <span class="n">[1]</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="游标特性">游标特性<a hidden class="anchor" aria-hidden="true" href="#游标特性">#</a></h2>
<h3 id="关闭非活动游标">关闭非活动游标<a hidden class="anchor" aria-hidden="true" href="#关闭非活动游标">#</a></h3>
<p>默认情况下，服务器将在闲置10分钟或客户端用尽光标后自动关闭光标。要在mongoshell程序中覆盖此特性，可以使用以下cursor.noCursorTimeout()方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">var</span> <span class="n">myCursor</span> <span class="o">=</span> <span class="nf">db.users.find</span><span class="p">()</span><span class="nf">.noCursorTimeout</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><p>设置该noCursorTimeout选项后，必须使用cursor.close()或通过用尽光标的结果来关闭光标。</p>
<h3 id="光标隔离">光标隔离<a hidden class="anchor" aria-hidden="true" href="#光标隔离">#</a></h3>
<p>当游标返回文档时，其他操作可能会与查询交错。</p>
<h3 id="光标批次">光标批次<a hidden class="anchor" aria-hidden="true" href="#光标批次">#</a></h3>
<p>MongoDB服务器批量返回查询结果。批处理中的数据量将不超过BSON文档的最大大小。要覆盖批次的默认大小，请参见batchSize()和 limit()。</p>
<p>在新版本3.4：find()， aggregate()， listIndexes，和 listCollections最大的每批16MB返回。batchSize()可以强制执行一个较小的限制，但不能执行较大的限制。</p>
<p>find()并且aggregate()操作的初始批处理大小默认为101个文档。getMore 针对结果游标发出的后续操作没有默认的批处理大小，因此它们仅受16MB消息大小的限制。</p>
<p>对于包含不带索引的排序操作的查询，服务器必须在返回任何结果之前将所有文档加载到内存中以执行排序。</p>
<p>当您遍历游标并到达返回批次的末尾时，如果还有更多结果，cursor.next()将执行来检索下一个批次。若要查看在迭代游标时批处理中剩余多少文档，可以使用方法，如以下示例所示：getMore operationobjsLeftInBatch()</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="n">var</span> <span class="n">myCursor</span> <span class="o">=</span> <span class="nf">db.inventory.find</span><span class="p">();</span>

<span class="n">var</span> <span class="n">myFirstDocument</span> <span class="o">=</span> <span class="nf">myCursor.hasNext</span><span class="p">()</span> <span class="o">?</span> <span class="nf">myCursor.next</span><span class="p">()</span> <span class="o">:</span> <span class="n">null</span><span class="p">;</span>

<span class="nf">myCursor.objsLeftInBatch</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="游标信息">游标信息<a hidden class="anchor" aria-hidden="true" href="#游标信息">#</a></h2>
<p>db.serverStatus()方法返回包含metrics字段的文档。该 metrics字段包含metrics.cursor具有以下信息的 字段：</p>
<ul>
<li>自上次服务器重新启动以来超时的游标数</li>
<li>DBQuery.Option.noTimeout设置了选项以防止一段时间不活动后超时的打开游标的数量</li>
<li>“固定”打开游标的数量</li>
<li>打开的游标总数</li>
</ul>
<p>考虑以下示例，该示例调用 db.serverStatus()方法并metrics从结果中访问字段，然后从cursor字段中访问metrics 字段：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="nf">db.serverStatus</span><span class="p">()</span><span class="n">.metrics.cursor</span>
</code></pre></td></tr></table>
</div>
</div><p>结果是以下文档：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-s" data-lang="s"><span class="p">{</span>
   <span class="s">&#34;timedOut&#34;</span> <span class="o">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span>
   <span class="s">&#34;open&#34;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s">&#34;noTimeout&#34;</span> <span class="o">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
      <span class="s">&#34;pinned&#34;</span> <span class="o">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
      <span class="s">&#34;total&#34;</span> <span class="o">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/mongodb/">MongoDB</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="/">Forz Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
