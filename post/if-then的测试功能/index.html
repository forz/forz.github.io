<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>if-then的测试功能 - Forz Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Forz" /><meta name="description" content="退出状态码 定义 shell中运行的每个命令都使用退出状态码(exit status)告诉shell它已经运行完毕。退出状态 码是一个0~255的整" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.55.6 with theme even" />


<link rel="canonical" href="http://localhost:1313/post/if-then%E7%9A%84%E6%B5%8B%E8%AF%95%E5%8A%9F%E8%83%BD/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="if-then的测试功能" />
<meta property="og:description" content="退出状态码 定义 shell中运行的每个命令都使用退出状态码(exit status)告诉shell它已经运行完毕。退出状态 码是一个0~255的整" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/if-then%E7%9A%84%E6%B5%8B%E8%AF%95%E5%8A%9F%E8%83%BD/" />
<meta property="article:published_time" content="2017-08-09T16:17:02&#43;00:00"/>
<meta property="article:modified_time" content="2017-08-09T16:17:02&#43;00:00"/>

<meta itemprop="name" content="if-then的测试功能">
<meta itemprop="description" content="退出状态码 定义 shell中运行的每个命令都使用退出状态码(exit status)告诉shell它已经运行完毕。退出状态 码是一个0~255的整">


<meta itemprop="datePublished" content="2017-08-09T16:17:02&#43;00:00" />
<meta itemprop="dateModified" content="2017-08-09T16:17:02&#43;00:00" />
<meta itemprop="wordCount" content="3727">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="if-then的测试功能"/>
<meta name="twitter:description" content="退出状态码 定义 shell中运行的每个命令都使用退出状态码(exit status)告诉shell它已经运行完毕。退出状态 码是一个0~255的整"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Forz Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Forz Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">if-then的测试功能</h1>

      <div class="post-meta">
        <span class="post-time"> 2017-08-09 </span>
        <div class="post-category">
            <a href="/categories/shell/"> Shell </a>
            </div>
          <span class="more-meta"> 约 3727 字 </span>
          <span class="more-meta"> 预计阅读 8 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li><a href="#退出状态码">退出状态码</a>
<ul>
<li><a href="#定义">定义</a></li>
<li><a href="#exit命令">exit命令</a></li>
</ul></li>
<li><a href="#if-then基本结构">if-then基本结构</a></li>
<li><a href="#test命令">test命令</a>
<ul>
<li><a href="#数值比较">数值比较</a></li>
<li><a href="#字符串比较">字符串比较</a></li>
<li><a href="#文件比较">文件比较</a></li>
</ul></li>
<li><a href="#复合条件测试">复合条件测试</a></li>
<li><a href="#if-then的高级特性">if-then的高级特性</a>
<ul>
<li><a href="#双括号">双括号</a></li>
<li><a href="#使用双方括号">使用双方括号</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h1 id="退出状态码">退出状态码</h1>

<h2 id="定义">定义</h2>

<p>shell中运行的每个命令都使用退出状态码(exit status)告诉shell它已经运行完毕。退出状态 码是一个0~255的整数值，在命令结束运行时由命令传给shell。可以捕获这个值并在脚本中使用。</p>

<p>Linux提供了一个专门的变量$?来保存上个已执行命令的退出状态码。对于需要进行检查的 命令，必须在其运行完毕后立刻查看或使用$?变量。它的值会变成由shell所执行的最后一条命令的退出状态码。</p>

<p>按照惯例，一个成功结束的命令的退出状态码是0。如果一个命令结束时有错误，退出状态码就是一个正数值。</p>

<p>无效命令会返回一个退出状态码127。</p>

<p><img src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/QQ20170809-163802@2x.png" alt="" /></p>

<h2 id="exit命令">exit命令</h2>

<p>默认情况下，shell脚本会以脚本中的最后一个命令的退出状态码退出。你可以改变这种默认行为，返回自己的退出状态码。exit命令允许你在脚本结束时指定一个退出状态码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ cat test13
<span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="c1"># testing the exit status</span>
<span class="nv">var1</span><span class="o">=</span><span class="m">10</span>
<span class="nv">var2</span><span class="o">=</span><span class="m">30</span>
<span class="nv">var3</span><span class="o">=</span>$<span class="o">[</span><span class="nv">$var1</span> + <span class="nv">$var2</span><span class="o">]</span>
<span class="nb">echo</span> The answer is <span class="nv">$var3</span>
<span class="nb">exit</span> <span class="m">5</span>
$</pre></td></tr></table>
</div>
</div>
<p>当查看脚本的退出码时，你会得到作为参数传给exit命令的值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></pre></td>
<td class="lntd">
<pre class="chroma">$ chmod u+x test13
$ ./test13
The answer is 40
$ echo $?
5 
$</pre></td></tr></table>
</div>
</div>
<p>也可以在exit命令的参数中使用变量。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">exit $var3</pre></td></tr></table>
</div>
</div>
<p>因为退出状态码最大只能是255,退出状态码被缩减到了0~255的区间。shell通过模运算得到这个结果.最终的结果是指定的数值除以256后得到的余数。</p>

<p>例如指定的值是300(返回值)，余数是44，因此这个余数就成了最后的状态退出码。</p>

<h1 id="if-then基本结构">if-then基本结构</h1>

<p>基本结构如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">if command 
then
commands
fi</pre></td></tr></table>
</div>
</div>
<p>bash shell的if语句会运行if后面的那个命令。如果该命令的退出状态码(参见第11章)是0 (该命令成功运行)，位于then部分的命令就会被执行。如果该命令的退出状态码是其他值，then部分的命令就不会被执行，bash shell会继续执行脚本中的下一个命令。fi语句用来表示if-then 语句到此结束。</p>

<p>在if-then语句中，不管命令是否成功执行，你都只有一种选择。如果命令返回一个非零退 出状态码，bash shell会继续执行脚本中的下一条命令。在这种情况下，如果能够执行另一组命令 2 就好了。这正是if-then-else语句的作用。
 if-then-else语句在语句中提供了另外一组命令。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">if command then
commands
else
commands
fi</pre></td></tr></table>
</div>
</div>
<p>有时你需要检查脚本代码中的多种条件。对此，可以使用嵌套的if-then语句.在脚本中使用这种嵌套if-then语句的问题在于代码不易阅读，很难理清逻辑流程。</p>

<p>可以使用else部分的另一种形式:elif。这样就不用再书写多个if-then语句了。elif使 用另一个if-then语句延续else部分。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">if command1 
then
    commands 
elif command2 
then
    more commands 
fi</pre></td></tr></table>
</div>
</div>
<p>你会经常发现自己在尝试计算一个变量的值，在一组可能的值中寻找特定值。在这种情形下，你不得不写出很长的if-then-else语句，</p>

<p>有了case命令，就不需要再写出所有的elif语句来不停地检查同一个变量的值了。case命令会采用列表格式来检查单个变量的多个值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">case variable in
pattern1 | pattern2) commands1;;    
pattern3) commands2;;
*) default commands;;
esac</pre></td></tr></table>
</div>
</div>
<p>case命令会将指定的变量与不同模式进行比较。如果变量和模式是匹配的，那么shell会执行 为该模式指定的命令。可以通过竖线操作符在一行中分隔出多个模式模式。星号会捕获所有与已知模式不匹配的值。这里有个将if-then-else程序转换成用case命令的例子。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ cat test26.sh <span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="c1"># using the case command</span> 
#
<span class="k">case</span> <span class="nv">$USER</span> in
rich <span class="p">|</span> barbara<span class="o">)</span>
       <span class="nb">echo</span> <span class="s2">&#34;Welcome, </span><span class="nv">$USER</span><span class="s2">&#34;</span>
       <span class="nb">echo</span> <span class="s2">&#34;Please enjoy your visit&#34;</span><span class="p">;;</span>
testing<span class="o">)</span>
      <span class="nb">echo</span> <span class="s2">&#34;Special testing account&#34;</span><span class="p">;;</span>
jessica<span class="o">)</span>
       <span class="nb">echo</span> <span class="s2">&#34;Do not forget to log off when you&#39;re done&#34;</span><span class="p">;;</span>
*<span class="o">)</span>
       <span class="nb">echo</span> <span class="s2">&#34;Sorry, you are not allowed here&#34;</span><span class="p">;;</span>
    <span class="k">esac</span>
$
$ ./test26.sh
Welcome, rich
Please enjoy your visit 
$</code></pre></td></tr></table>
</div>
</div>
<p>case命令提供了一个更清晰的方法来为变量每个可能的值指定不同的选项。</p>

<h1 id="test命令">test命令</h1>

<p>test命令提供了在if-then语句中测试不同条件的途径。如果test命令中列出的条件成立，test命令就会退出并返回退出状态码0。</p>

<p>这样if-then语句就与其他编程语言中的if-then语句 以类似的方式工作了。如果条件不成立，test命令就会退出并返回非零的退出状态码，这使得 if-then语句不会再被执行。</p>

<p>test命令的格式非常简单。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">test condition</pre></td></tr></table>
</div>
</div>
<p>condition是test命令要测试的一系列参数和值。当用在if-then语句中时，test命令看起来是这样的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">if test condition then
commands
fi</pre></td></tr></table>
</div>
</div>
<p>如果不写test命令的condition部分，它会以非零的退出状态码退出，并执行else语句块。</p>

<p>bash shell提供了另一种条件测试方法，无需在if-then语句中声明test命令。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">if [ condition ] then
commands
fi</pre></td></tr></table>
</div>
</div>
<p>方括号定义了测试条件。注意，第一个方括号之后和第二个方括号之前必须加上一个空格，否则就会报错。</p>

<p>test命令可以判断三类条件:</p>

<ol>
<li>数值比较</li>
<li>字符串比较</li>
<li>文件比较</li>
</ol>

<h2 id="数值比较">数值比较</h2>

<p>使用test命令最常见的情形是对两个数值进行比较。</p>

<p><img src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/QQ20170809-170736@2x.png" alt="" /></p>

<p>数值条件测试可以用在数字和变量上。</p>

<p>注意bash shell只能处理整数。如果使用浮点值进行test比较,将会报错.</p>

<h2 id="字符串比较">字符串比较</h2>

<p>条件测试还允许比较字符串值。比较字符串比较烦琐.</p>

<p><img src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/QQ20170809-171146@2x.png" alt="" /></p>

<p>当要开始使用测试条件的大于或小于功能时，就会出现两个经常困扰shell程序员的问题:</p>

<ol>
<li><p>大于号和小于号必须转义，否则shell会把它们当作重定向符号，把字符串值当作文件名;</p></li>

<li><p>大于和小于顺序和sort命令所采用的不同</p></li>
</ol>

<p>在编写脚本时，第一条可能会导致一个不易察觉的严重问题。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">val1=baseball
val2=hockey
if [ $val1 &gt; $val2 ]</pre></td></tr></table>
</div>
</div>
<p>这个脚本中只用了大于号，没有出现错误，但结果是错的。脚本把大于号解释成了输出重定向.因此，它创建了一个名为hockey的文件。由于重定向的顺利完成，test命令 返回了退出状态码0，if语句便以为所有命令都成功结束了。</p>

<p>要解决这个问题，就需要正确转义大于号。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">if [ $val1 \&gt; $val2 ]</pre></td></tr></table>
</div>
</div>
<p>第二个问题更细微，除非你经常处理大小写字母，否则几乎遇不到。sort命令处理大写字母的方法刚好跟test命令相反。</p>

<p>在比较测试中，大写字母被认为是小于小写字母的。但sort命令恰好相反。当你将同样的 字符串放进文件中并用sort命令排序时，小写字母会先出现。这是由各个命令使用的排序技术不同造成的。</p>

<p>比较测试中使用的是标准的ASCII顺序，根据每个字符的ASCII数值来决定排序结果。sort 命令使用的是系统的本地化语言设置中定义的排序顺序。对于英语，本地化设置指定了在排序顺 序中小写字母出现在大写字母前。</p>

<p>-n和-z可以检查一个变量是否含有数据。</p>

<h2 id="文件比较">文件比较</h2>

<p>最后一类比较测试很有可能是shell编程中最为强大、也是用得最多的比较形式。它允许你测 试Linux文件系统上文件和目录的状态。</p>

<p><img src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/QQ20170809-173415@2x.png" alt="" /></p>

<p>-d测试会检查指定的目录是否存在于系统中。如果你打算将文件写入目录或是准备切换到某 个目录中，先进行测试总是件好事情。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">if [ -d $jump_directory ]</pre></td></tr></table>
</div>
</div>
<p>-e比较允许你的脚本代码在使用文件或目录前先检查它们是否存在。</p>

<p>-e比较可用于文件和目录。要确定指定对象为文件，必须用-f比较。</p>

<p>在尝试从文件中读取数据之前，最好先测试一下文件是否可读。可以使用-r比较测试。</p>

<p>应该用-s比较来检查文件是否为空，尤其是在不想删除非空文件的时候。要留心的是，当 -s比较成功时，说明文件中有数据。</p>

<p>-w比较会判断你对文件是否有可写权限。</p>

<p>-x比较是判断特定文件是否有执行权限的一个简单方法。</p>

<p>-O比较可以测试出你是否是文件的属主。</p>

<p>-G比较会检查文件的默认组，如果它匹配了用户的默认组，则测试成功。<strong>由于-G比较只会 检查默认组而非用户所属的所有组，这会叫人有点困惑。</strong></p>

<p>-nt比较会判定一个文件是否比另一个文件新。如果文件较新，那意味着它的文件创建日 期更近。-ot比较会判定一个文件是否比另一个文件旧。如果文件较旧，意味着它的创建日期更早。</p>

<h1 id="复合条件测试">复合条件测试</h1>

<p>if-then语句允许你使用布尔逻辑来组合测试。有两种布尔运算符可用:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">[ condition1 ] &amp;&amp; [ condition2 ]
[ condition1 ] || [ condition2 ]</pre></td></tr></table>
</div>
</div>
<p>第一种布尔运算使用AND布尔运算符来组合两个条件。要让then部分的命令执行，两个条件都必须满足。</p>

<h1 id="if-then的高级特性">if-then的高级特性</h1>

<p>bash shell提供了两项可在if-then语句中使用的高级特性:</p>

<ol>
<li>用于数学表达式的双括号</li>
<li>用于高级字符串处理功能的双方括号</li>
</ol>

<h2 id="双括号">双括号</h2>

<p>双括号命令允许你在比较过程中使用高级数学表达式。test命令只能在比较中使用简单的 算术操作。双括号命令提供了更多的数学符号.双括号命令的格式如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">(( expression ))</pre></td></tr></table>
</div>
</div>
<p>expression可以是任意的数学赋值或比较表达式。</p>

<p><img src="https://blog-1257321977.cos.ap-beijing.myqcloud.com/QQ20170809-175451@2x.png" alt="" /></p>

<p>可以在if语句中用双括号命令，也可以在脚本中的普通命令里使用来赋值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">if (( $val1 ** 2 &gt; 90 )) then
   (( val2 = $val1 ** 2 ))
   echo &#34;The square of $val1 is $val2&#34;
fi</pre></td></tr></table>
</div>
</div>
<p>注意，不需要将双括号中表达式里的大于号转义。</p>

<h2 id="使用双方括号">使用双方括号</h2>

<p>双方括号命令提供了针对字符串比较的高级特性。双方括号命令的格式如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">[[ expression ]]</pre></td></tr></table>
</div>
</div>
<p>双方括号里的expression使用了test命令中采用的标准字符串比较。但它提供了test命令未提供的另一个特性——模式匹配(pattern matching)。</p>

<p>在模式匹配中，可以定义一个正则表达式(将在第20章中详细讨论)来匹配字符串值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ cat test24.sh
<span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="c1"># using pattern matching #</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$USER</span> <span class="o">==</span> r* <span class="o">]]</span>
<span class="k">then</span>
	<span class="nb">echo</span> <span class="s2">&#34;Hello </span><span class="nv">$USER</span><span class="s2">&#34;</span>
<span class="k">else</span> 
   <span class="nb">echo</span> <span class="s2">&#34;Sorry, I do not know you&#34;</span>
<span class="k">fi</span>
$ ./test24.sh <span class="m">6</span> Hello rich
$</code></pre></td></tr></table>
</div>
</div>
<p>使用了双等号(==)。双等号将右边的字符串(r*)视为一个模式， 并应用模式匹配规则。双方括号命令$USER环境变量进行匹配，看它是否以字母r开头。如果是的话，比较通过，shell会执行then部分的命令。</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Forz</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2017-08-09
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/%E5%BE%AA%E7%8E%AF%E5%91%BD%E4%BB%A4for%E8%AF%A6%E8%A7%A3/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">循环命令for详解</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E9%80%9A%E8%BF%87shell%E8%BF%9B%E8%A1%8C%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97/">
            <span class="next-text nav-default">通过shell进行数学运算</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="forz/forzblog.talk"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Forz</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
